---

title: Clock frequency divider circuit and clock frequency division method
abstract: A clock frequency divider circuit in accordance with the present invention is capable of generating a clock signal that makes it possible to perform an expected proper communication operation in communication with a circuit operating by a clock having a different frequency, and includes a mask control circuit  and a mask circuit . The mask control circuit  includes a mask timing signal generation circuit  that generates a mask timing signal  used to preferentially mask a clock pulse at a timing other than communication timings among M clock pulses of the input clock signal based on a communication timing signal , and a mask restraint circuit  that carries out a process to restrain masking of a clock pulse at a communication timing. The mask circuit  generates an output clock signal by masking clock pulses of an input clock signal according to a mask signal  generated by the mask control circuit.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08369477&OS=08369477&RS=08369477
owner: NEC Corporation
number: 08369477
owner_city: Tokyo
owner_country: JP
publication_date: 20091202
---
This application is the National Phase of PCT JP2009 006557 filed Dec. 2 2009 which is based upon and claims the benefit of priority from Japanese patent application No. 2008 321129 filed on Dec. 17 2008 the disclosure of which is incorporated herein in its entirety by reference.

The present invention relates to a clock frequency divider circuit and a clock frequency division method in particular to a clock frequency divider circuit and a clock frequency division method in which the frequency of a clock signal is divided by a frequency division ratio of an arbitrary rational number.

In a clock frequency divider circuit that generates a clock signal having a lower frequency from an original clock signal having an arbitrary frequency by dividing the frequency of the original clock signal it is easy to realize a divider circuit whose frequency division ratio i.e. the ratio of the frequency of the generated clock signal to the frequency of the original clock signal is expressed as 1 M M is an integer integer frequency divider circuit by using a counter circuit.

Further divider circuits capable of performing a frequency division even when the frequency division ratio is a rational number expressed as N M N is a positive integer and M is a positive integer greater than N rational number frequency divider circuit have been also proposed see Patent literatures 1 and 2 . According to these related art techniques firstly the value N of the numerator of the frequency division ratio is cumulatively added at each cycle of the input clock signal. Next if the addition result becomes larger than the value M of the denominator of the frequency division ratio the value M is subtracted from the cumulative addition result. By performing these operations and then appropriately masking thinning out clock pulses of the input clock signal by referring to the cumulative addition result the related art technique realizes a rational number frequency division.

A specific example of the problem that occurs in the above described clock frequency divider circuit in the related art is explained with reference to . is an example of semiconductor integrated circuit using a clock frequency divider circuit in the related art. shows the operation of the clock frequency divider circuit in the related art.

As shown in a clock frequency divider circuit in the related art generates a clock B by dividing the frequency of a clock S by a rational number based on input frequency division ratio setting. A circuit A circuit at the other end and a circuit B target circuit communicate with each other through signals Aout and Bout. The signal Aout is output by the circuit A at a timing of a clock A and is received by the circuit B at a timing of a clock B. The signal Bout is output by the circuit B at a timing of the clock B and is received by the circuit A at a timing of the clock A.

In this example assume that the frequency of the clock A is one third of that of the clock S. That is the frequency division ratio of the clock A to the clock S is 1 3 4 12 . Note that the phase relation between the clock A and the clocks B makes a full circle in twelve cycles of the clock S. The timings of the twelve cycles in which the phase relation makes a full circle are represented by T to T .

Assume also that the circuit A and the circuit B communicate with each other at the timings T T T and T which correspond to all the rising edge timings of the clock A. That is the circuit A outputs the signal Aout and receives the signal Bout at the timings T T T and T which are the rising edge timings of the clock A and are the communication timings.

However the above described clock frequency divider circuit in the related art does not give any consideration to the communication with circuits using clocks having different frequencies. Therefore the clock frequency divider circuit in the related art could generate the clock B by masking clock pulses of the clock S at these communication timings. In the case of example shown in the clock frequency divider circuit generates some of the clocks B by masking a clock pulse of the clock S at the timing T T and or T among the communication timings.

Specifically at the timing T the clock pulse is masked for the frequency division ratios 9 12 6 12 and 5 12 . Similarly at the timing T the clock pulse is masked for the frequency division ratio 5 12 . Similarly at the timing T the clock pulse is masked for the frequency division ratios 7 12 6 12 and 5 12 .

If the clock pulse of the clock S is masked at the communication timing to generate the clock B as in the case of the above described example the circuit B operating by the clock B cannot receive a signal output to the signal Aout by the circuit A operating by the clock A at an expected timing. Similarly the circuit B operating by the clock B cannot output a signal to the signal Bout at the timing that is expected by the circuit A operating by the clock A.

Therefore in the above described clock frequency divider circuit in the related art communication with a circuit operating by a clock having a different frequency requires a special clock transfer circuit and or special timing design to realize an expected proper communication operation. As a result there are problems that the communication performance deteriorates and that the power consumption circuit size and design cost increase.

The present invention has been made in view of the above described problems and an object thereof is to provide a clock frequency divider circuit that generates a clock signal that makes it possible to perform an expected proper communication operation in communication with a circuit operating by a clock having a different frequency and a clock frequency division method.

A clock frequency divider circuit in accordance with the present invention is a clock frequency divider circuit that generates an output clock signal obtained by dividing a frequency of an input clock signal into N M N is a positive integer and M is a positive integer greater than N by masking M N clock pulses among M clock pulses of the input clock signal based on a frequency division ratio defined as N M the clock frequency divider circuit including a mask control circuit including a mask timing signal generation circuit that generates a mask timing signal used to preferentially masks a clock pulse at a timing other than a communication timing of data communication performed by a target circuit using the output clock signal among M clock pulses of the input clock signal based on a communication timing signal indicating the communication timing and a mask restraint circuit that generates a mask signal obtained by processing the mask timing signal so that masking of the clock pulse is restrained at the communication timing and a mask circuit that generates the output clock signal by masking a clock pulse of the input clock signal according to the mask signal generated by the mask control circuit.

A clock frequency divider circuit in accordance with the present invention is a clock frequency divider circuit that generates an output clock signal obtained by dividing a frequency of an input clock signal into N M N is a positive integer and M is a positive integer greater than N by masking M N clock pulses among M clock pulses of the input clock signal based on a frequency division ratio defined as N M the clock frequency divider circuit including a counter that generates a count value indicating a relative phase of a communication timing with respect to the input clock signal by counting a clock pulse of the input clock signal and resetting a count value when the count value reaches a denominator M of the frequency division ratio a mask control circuit including a mask timing signal generation circuit that generates a mask timing signal used to preferentially masks a clock pulse at a timing other than a communication timing of data communication performed by a target circuit using the output clock signal among M clock pulses of the input clock signal based on the count value and a communication timing signal indicating the communication timing and an error detection circuit that determines whether or not the count value is a normal value for the communication timing and when the count value is determined to be not a normal value controls the counter so as to reset the count value and a mask circuit that generates the output clock signal by masking a clock pulse of the input clock signal according to the mask timing signal generated by the mask control circuit.

A clock frequency division method in accordance with the present invention is a clock frequency division method for generating an output clock signal obtained by dividing a frequency of an input clock signal into N M N is a positive integer and M is a positive integer greater than N by masking M N clock pulses among M clock pulses of the input clock signal based on a frequency division ratio defined as N M the clock frequency division method including generating a mask timing signal used to preferentially masks a clock pulse at a timing other than a communication timing of data communication performed by a target circuit using the output clock signal among M clock pulses of the input clock signal based on a communication timing signal indicating the communication timing generating a mask signal obtained by processing the mask timing signal so that masking of the clock pulse is restrained at the communication timing and generating the output clock signal by masking a clock pulse of the input clock signal according to the mask signal.

A clock frequency division method in accordance with the present invention is a clock frequency division method for generating an output clock signal obtained by dividing a frequency of an input clock signal into N M N is a positive integer and M is a positive integer greater than N by masking M N clock pulses among M clock pulses of the input clock signal based on a frequency division ratio defined as N M the clock frequency division method including generating a count value indicating a relative phase of a communication timing with respect to the input clock signal by counting a clock pulse of the input clock signal and resetting a count value when the count value reaches a denominator M of the frequency division ratio generating a mask timing signal used to preferentially masks a clock pulse at a timing other than a communication timing of data communication performed by a target circuit using the output clock signal among M clock pulses of the input clock signal based on the count value and a communication timing signal indicating the communication timing determining whether or not the count value is a normal value for the communication timing and when the count value is determined to be not a normal value controlling the counter so as to reset the count value and generating the output clock signal by masking a clock pulse of the input clock signal according to the mask timing signal.

In accordance with the present invention it is possible to provide a clock frequency divider circuit that generates a clock signal that makes it possible to perform an expected proper communication operation in communication with a circuit operating by a clock having a different frequency and a clock frequency division method.

A first exemplary embodiment in accordance with the present invention is explained hereinafter with reference to the drawings.

The clock frequency divider circuit is a circuit that generate a clock B output clock signal that is obtained by performing a rational number frequency division on a clock S input clock signal at a frequency division ratio N M N is a positive integer and M is a positive integer greater than N by masking M N clock pulses among consecutive M clock pulses of the clock S based on a frequency division ratio defined as N M of frequency division ratio setting information .

This clock frequency divider circuit includes as principle circuits a mask circuit and a mask control circuit . The mask circuit has a function of masking clock pulses of the clock S according to an input mask signal and thereby generating and outputting a clock B.

The mask control circuit has a function of generating a mask signal based on the communication timing of data communication between the circuit B using the clock B and the circuit A using the clock A and outputting the generated mask signal to the mask circuit . Note that the mask signal is a signal in which M N mask timings at each of which a clock pulse is masked are assigned to timings other than the communication timings at which the data communication is performed among the consecutive M clock pulse timings of the clock S.

The circuits A and B communicate with each other at the rising edge timings of the clock A by using signals Aout and Bout. In this example the circuit A outputs a signal Aout by driving a flip flop circuit A with the clock A and the circuit B receives the signal Aout by driving a flip flop circuit B with the clock B. Meanwhile the circuit B outputs a signal Bout by driving a flip flop circuit B with the clock B and the circuit A receives the signal Bout by driving a flip flop circuit A with the clock A.

The clock frequency divider circuit receives the clock A indicating the communication timing between the circuit B and the circuit A in addition to the frequency division ratio setting information and generates the clock B by dividing the frequency of the clock S at a rational numbers frequency division ratio N M based on the clock A.

Assume that the clock S the clock A and the frequency division ratio setting information are supplied from a circuit at a higher level not shown .

Assume also that the distribution delays of the clocks A and B are designed by using a clock tree synthesis technique or the like so that they become substantially equal to each other. By doing so the phase of the clock A in the circuit A coincides with the phase of the clock B in the circuit B. That is all of the clock A the clock B and the clock S are in synchronization with each other.

Next an operation of a clock frequency divider circuit in accordance with this exemplary embodiment is explained with reference to . is a timing chart showing an operation of the clock frequency divider circuit in accordance with this exemplary embodiment. An example case where the frequency division ratio denominator M 12 the frequency division ratio numerator N 11 to 4 and the clock B is generated by dividing the frequency of the clock S at 11 12 to 4 12 is explained hereinafter.

The clock S the clock A and the frequency division ratio setting information are input to the clock frequency divider circuit . The frequency division ratio setting information is a signal indicating a frequency division ratio N M of the clock B to the clock S and a frequency division ratio C M of the clock A to the clock S.

The clock S is a signal composed of successive clock pulses having a predetermined frequency. The clock A indicates communication timings between the circuit B and the circuit A. The frequency division ratio setting information is composed of parallel data consisting of several bits indicating the values of the frequency division ratio denominator M the frequency division ratio numerator N and the frequency division ratio numerator C and the values of the frequency division ratio setting information do not change as long as the frequency division ratio is unchanged.

The mask control circuit of the clock frequency divider circuit outputs a mask signal to the mask circuit . In the mask signal M N mask timings at each of which a clock pulse is masked are assigned to timings other than the communication timings at which the data communication is performed between the circuits B and A based on the communication timing indicated by the clock A and the frequency division ratio setting information .

Note that in the case where data communication is performed at the rising edge timings of the clock A as described above the mask control circuit assigns the mask timings at each of which a clock pulse of the clock S is masked to timings other than these communication timings i.e. other than the rising edge timings of the clock A.

The mask control circuit generates a mask signal in which M N mask timings at each of which a clock pulse is masked are assigned to some of the rising edge timings of the clock S other than these communication timings i.e. to some of the timings T T T T T T T and T.

For example a clock B corresponding to a frequency division ratio 11 12 can be generated by assigning a mask timing at a timing other than the timings T T T and T among the twelve clock pulses at timings T to T of the clock S e.g. at a timing T. Further a clock B corresponding to a frequency division ratio 10 12 can be generated by additionally assigning a mask timing at a timing T. Further a clock B corresponding to a frequency division ratio 9 12 can be generated by additionally assigning a mask timing at a timing T. Further a clock B corresponding to a frequency division ratio 8 12 can be generated by additionally assigning a mask timing at a timing T.

Further a clock B corresponding to a frequency division ratio 7 12 can be generated by assigning mask timings at timings T T T T and T among the timings other than the timings T T T and T. Further a clock B corresponding to a frequency division ratio 6 12 can be generated by additionally assigning a mask timing at a timing T. Further a clock B corresponding to a frequency division ratio 5 12 can be generated by additionally assigning a mask timing at a timing T. Further a clock B corresponding to a frequency division ratio 4 12 can be generated by additionally assigning a mask timing at a timing T.

As described above in this exemplary embodiment the mask signal in which M N mask timings at each of which a clock pulse is masked are assigned to timings other than the communication timings at which the data communication is performed between the circuit B target circuit and the circuit A circuit at the other end is generated by the mask control circuit and output to the mask circuit . In this way the clock B is generated by masking M N clock pulses at timings of the clock S other than the communication timings at which the data communication is performed.

As a result no clock pulse of the clock S is masked at the communication timings and therefore a clock pulse is always output at the communication timings in the clock B. Accordingly the circuit B can receive a signal output to the signal Aout by the circuit A at an expected timing. Similarly the circuit B can output a signal to the signal Bout at a timing expected by the circuit A.

Therefore according to a clock frequency divider circuit in accordance with this exemplary embodiment it is possible to generate an output clock signal clock B that makes it possible to perform data communication even with a circuit at the other end circuit A operating by a clock having a different frequency clock A without deteriorating the communication performance.

Further the need for a special clock transfer circuit and or special timing design for communication with a circuit operating by a clock signal having a different frequency is eliminated thus making it possible to perform a rational number frequency division on a clock signal with a low power a small size and a low design cost.

Further in this exemplary embodiment the mask control circuit assigns M N mask timings at each of which a clock pulse is masked to timings other than the communication timings at which the data communication is performed in the circuit at the other end according to the frequency division ratio setting information . Therefore for example even when the frequency division ratio N M is changed to any of the frequency division rations 11 12 to 4 12 it is possible to mask clock pulses of the clock S at timings other than the communication timings of the circuit B i.e. other than the timings T T T and T. Therefore even when the frequency division ratio is changed it is unnecessary to change the clock A or the communication timing of the circuit A thus making it possible to cope with the change in the frequency division ratio in an extremely flexible manner.

Next the mask circuit and the mask control circuit of the clock frequency divider circuit are explained in a more detailed manner with reference to .

In the mask circuit has a function of selecting whether the pulse of the clock S is masked or is output in the clock B without being masked by referring to the input mask signal . In this exemplary embodiment this mask circuit includes a latch circuit and a gate circuit .

The latch circuit has a function of restricting the transition of the mask signal which is input to the gate circuit to the timings at which the value of the clock S is 0 .

The gate circuit has a function of masking the clock S based on the mask signal latched by the latch circuit . When the value of the mask signal is 0 the clock S is masked. When the value of the mask signal is 1 the clock S is not masked.

The provision of the latch circuit can prevent the occurrence of glitches in the clock B. Although the provision of the latch circuit makes the timing design easier the latch circuit can be omitted if the occurrence of glitches is prevented by implementing precise timing design.

Further although an AND circuit is used as the gate circuit to mask the clock S in the present invention is not limited to this configuration. An OR circuit or other circuits having a similar function may be also used.

Further the mask control circuit generates a count value indicating a relative phase of a communication timing in the circuit B with respect to the clock S by counting clock pulses of the clock S based on the communication timing and the frequency division ratio setting information Then it also has a function of generating and outputting a mask signal in which mask timings are assigned based on this count value.

In this exemplary embodiment this mask control circuit includes a counter a table circuit an error detection circuit a communication timing detection circuit and a mask restraint circuit . Further the frequency division ratio setting information is composed of parallel bit data consisting of a plurality of bits including a frequency division ratio denominator M a frequency division ratio numerator N and a frequency division ratio numerator C.

The counter resets its count value to 0 at one of the communication timings. After that the counter counts clock pulses of the clock S and when the count value reaches the frequency division ratio denominator M resets the count value to 0 . In this way it is possible to output the count value from 0 to M 1 indicating the relative phase of the communication timing of the circuit A with respect to the clock S. Therefore the number of cycles in which the phase relation between the clocks A and B makes a full circle is output as the count value from the counter .

The table circuit has a function of holding table data in a table format in advance. In the table data the necessity non necessity of masking is indicated for each combination of the counter value and the frequency division ratio denominator M the frequency division ratio numerator N and the frequency division ratio numerator C i.e. the frequency division ratio setting information . Further the table circuit also has a function of outputting table data according to the combination of these input values as a mask timing signal . In this way the table circuit outputs a mask timing signal that is used to request the mask circuit to mask the clock pulse of the clock S according to the frequency division ratio denominator M the frequency division ratio numerator N the frequency division ratio numerator C and the count value for each clock pulse of the clock S.

Note that the mask timing signal is generated based on the communication timing referring to the count value which is reset based on the communication timing signal. That is the table circuit generates a mask timing signal that is used to preferentially mask a clock pulse at a timing other than the communication timing among the clock pulses of the input clock signal.

The communication timing detection circuit has a function of detecting a communication timing from the rising edge timing of the input clock A by referring to the clock A and outputting the detect timing as a communication timing signal .

The toggle circuit operates by the clock A and generates a toggle signal whose value toggles at each rising edge timing of the clock A. The toggle detection circuit receives the toggle signal and detects its rising edge timing and falling edge timing which are the toggle timings of the toggle signal . Next it generates a communication timing signal that becomes 1 at the rising edge timings of the clock. A and becomes 0 at all the other timings. That is when the communication timing signal is 1 it indicates a communication timing. On the other hand when the communication timing signal is 0 it indicates a non communication timing.

The error detection circuit in has a function of determining whether or not the count value is a normal value for the communication timing by referring to the count value and the communication timing signal . Further the error detection circuit has a function of resetting the counter by using a reset signal when an error indicating that the count value is not a normal value is detected.

A specific example of an operation of the error detection circuit is explained with reference to . is an operation transition diagram showing an operation of the error detection circuit .

The error detection circuit is a control circuit having two states consisting of normal and abnormal . Specifically firstly in the normal state the error detection circuit determines whether or not the communication timing signal is 1 indicating a communication timing at the timing at which the count value becomes 0 which is the reset value of the counter by referring to the input count value and the communication timing signal .

If the communication timing signal is 1 at the timing at which the count value becomes 0 the error detection circuit determines that the count value indicates a normal value and remains in the normal state. In the normal state 0 is output to the reset signal so that the counter is not reset and therefore the counter performs a normal count operation.

On the other hand if the communication timing signal is 0 at the timing at which the count value becomes 0 the error detection circuit determines that the count value indicates an abnormal value and changes to an abnormal state. In the abnormal state 1 is output to the reset signal so that the counter is reset and therefore the counter performs a reset operation. When it is not in the communication timing i.e. when the communication timing signal is 0 the error detection circuit remains in the abnormal state.

On the other hand when the communication timing signal becomes 1 indicating a communication timing the error detection circuit changes to a normal state and the counter restarts the normal count operation.

As explained above the error detection circuit determines whether the count value is a normal value or not by determining whether or not the timing at which the count value becomes the reset value of the counter is simultaneous with the communication timing at which the counter is to be reset.

Further when the count value is determined to be not a normal value the counter is reset at the timing at which the counter is to be reset communication timing . Therefore even if the counter malfunctions and the count value thereby indicates an abnormal value it is autonomously detected and the counter can be restored to the normal operation.

The mask restraint circuit generates a mask signal by referring to the mask timing signal and the communication timing signal . In this process at the communication timing it generates a mask signal that is used to control the mask circuit in such a manner that the clock pulse is never masked regardless of the value of the mask timing signal . On the other hand at the timings other than the communication timing it generates a mask signal that is used to control the necessity non necessity of masking according to the value of the mask timing signal .

Therefore even if the counter or the table circuit malfunctions and the mask timing signal thereby indicates an abnormal value the clock pulse is not masked at least at the communication timing and therefore data communication can be properly performed between the circuits A and B.

As shown in for example the mask circuit can be implemented by using a NOR gate circuit to which the mask timing signal and the communication timing signal are input.

Next an operation of the clock frequency divider circuit in accordance with this exemplary embodiment in a normal state is explained with reference to . is a timing chart showing an operation of the clock frequency divider circuit in accordance with this exemplary embodiment.

A case where a clock B corresponding to a frequency division ratio 9 12 is generated from a clock S is explained hereinafter. Assume that the circuit A and the circuit B perform data communication at all the rising edge timings of the clock A. Further the clock A is in synchronization with the clock B and its frequency division ratio is one third 4 12 of the clock B.

Note that since frequency division ratio N M of the clock B 9 12 and frequency division ratio C M of the clock A 4 12 values 12 9 and 4 are supplied as the frequency division ratio denominator M the frequency division ratio numerator N and the frequency division ratio numerator C respectively which constitute the frequency division ratio setting information .

The communication timing signal becomes 1 at the rising edge timing of the clock A and becomes 0 at the other timings and thereby indicates the communication timing between the circuits A and B.

The counter becomes 0 at one of the communication timings. After that the twelve cycles in which the phase relation between the clocks A and B makes a full circle is repeated and the clock pulses of the clock S is counted. In this way a counter value indicating the relative phase relation between the clocks A and B is output from the counter .

In the timings at which the counter value takes on values 0 to 11 correspond to the timings T to T respectively. That is the counter value becomes 0 at the timing T becomes 1 at the timing T and becomes 11 at the timing T. Then the counter value becomes 0 again at the timing T .

Further the count value becomes 0 which is the reset value at the communication timing at which the counter is to be reset.

In the table data of the table circuit a value 0 is set in advance when the pulse of the clock S is to be masked at the next cycle and a value 1 is set when the pulse is not to be masked at the next cycle for each combination of the counter value and the frequency division ratio denominator M the frequency division ratio numerator N and the frequency division ratio numerator C. Therefore the value of the table data according to the combination of the counter value and the frequency division ratio denominator M the frequency division ratio numerator N and the frequency division ratio numerator C which are input at each timing is output as a mask timing signal .

In the case of the table data in which mask timings are assigned to timings T T and T which are timings other than the communication timings of data communication performed between the circuits A and B among the timings T to T of the consecutive M clock pulses of the clock S is set in advance in the table circuit . Further non mask timings are assigned to the other timings i.e. timings T T T T T T T and T.

In this way when the counter value is 2 5 or 8 for example a value 0 indicating a mask timing is output as the table data from the table circuit as a mask timing signal . Further for all the other cases a value 1 indicating a non mask timing is output as the table data from the table circuit as a mask timing signal .

Since the timings T T and T at which the count value is 2 5 and 8 respectively are not the communication timings T T T and T the mask restraint circuit outputs the value of the mask timing signal as the mask signal without making any alteration. That is at the timings T T and T the mask restraint circuit outputs 0 indicating a mask timing as the mask signal . At the other timings the mask restraint circuit outputs 1 indicating a non mask timing as the mask signal .

The mask circuit refers to this mask signal and thereby masks pulses of the clock S at the timings T T and T. Further the mask circuit outputs pulses of the clock S in the clock B without masking them at the other timings.

Therefore the clock pulses of the clock S are always output as the clock B without being masked at the timings T T T and T among the timings T to T of the consecutive M clock pulses. On the other hand some of the clock pulses at the timings other than the communication timings i.e. clock pulses at timings T T and T in this example are masked and thereby are not output as the clock B.

Although a generation example in a case where the frequency division ratio of the clock B is 9 12 and the frequency of the clock A is one third of the clock S is shown in similar operations may be also performed in other cases. By appropriately setting the value of the table data for each combination of the relative phase relation between the clocks A and B it is possible to realize an arbitrary rational number frequency division by preventing clock pulses located at the communication timings from being masked without fail and masking some of clock pulses located at the timings other then the communication timings.

Further although the frequency division ratio denominator M the frequency division ratio numerator N the frequency division ratio numerator C and the like which are input to the mask control circuit have fixed values in they may be changed as appropriate during the operation within the range in which the table circuit holds the table data corresponding to these values.

Further the timing at which a clock pulse of the clock S is masked can be any timing other than the communication timing.

For example shows another generation example of clocks B generated by dividing the frequency of the clock S at frequency division ratios 11 12 to 4 12 under the same condition as in which the frequency of the clock A is one third of the clock S. Pulses at different timings from those of the generation example in are masked among the pulses at the timings other than the communication timing i.e. the timings T T T T T T T and T.

Meanwhile shows another generation example of clocks B generated by dividing the frequency of the clock S at frequency division ratios 11 12 to 3 12 when the frequency of the clock A is one fourth of the clock S. The frequency of the clock A is different between the generation examples in and as a result the communication timings are also different between . However they are characterized in that clocks B corresponding to the frequency division ratios 11 12 to 6 12 are generated by masking pulses at the same timings in the generation examples in .

Therefore since common table data is used to generate clocks B corresponding to the frequency division ratios 11 12 to 6 12 for both cases where the frequency of the clock A is one third of the clock S and where the frequency of the clock A is one fourth of the clock S there is an advantageous effect that the amount of the hardware for the table circuit can be reduced.

Next an operation of the clock frequency divider circuit in accordance with this exemplary embodiment performed when the clock frequency divider circuit has malfunctioned is explained with reference to . is a timing chart showing an operation of the clock frequency divider circuit in accordance with this exemplary embodiment performed when a malfunction has occurred.

Similarly to a case where a clock B corresponding to a frequency division ratio 9 12 is generated from the clock S is explained hereinafter. Assume that the circuit A and the circuit B perform data communication at all the rising edge timings of the clock A. Further the clock A is in synchronization with the clock B and its frequency division ratio is one third 4 12 of the clock B.

In the normal operation the counter becomes 0 at one of the communication timings. After that the twelve cycles in which the phase relation between the clocks A and B makes a full circle is repeated and the clock pulses of the clock S is counted. In this way a counter value indicating the relative phase relation between the clocks A and B is output from the counter .

In contrast to this in assume that the counter malfunctions due to power supply noises for example at a timing T. Assume also that as a result the count value becomes 6 which is an incorrect value though it should be 4 in the normal operation state. Further the count value continues to count incorrect values after that.

Consequently for example the count value becomes 8 at the timing T which is the communication timing. Therefore it causes an error that the table circuit outputs as the table data a value 0 indicting a mask timing as the mask timing signal . As a result if the mask timing signal is output without being altered as a mask signal and the mask circuit thereby masks the clock pulse it causes an error that data communication cannot be performed properly between the circuits A and B.

In contrast to this the clock frequency divider circuit in accordance with this exemplary embodiment generates a mask signal that is used to control the mask circuit in such a manner that the mask restraint circuit never masks the clock pulse at the communication timing regardless of the value of the mask timing signal . Therefore example even if the mask timing signal is 0 indicating a mask timing at the timing T a value 1 indicating a non mask timing is output as the mask signal .

That is in the clock frequency divider circuit in accordance with this exemplary embodiment since the clock pulse is never masked at the communication timing data communication can be properly performed even when the counter malfunctions and the count value thereby becomes an incorrect value.

Meanwhile the error detection circuit determines whether or not the count value is a normal value for the communication timing. Further when an error that the count value is not a normal value is detected the error detection circuit resets the counter by using the reset signal .

Specifically after a malfunction occurs at the timing T the error detection circuit determines whether the communication timing signal is 1 or not at the timing T at which the count value becomes 0 . At the timing T since the count value is 0 the error detection circuit determines that the count value indicates an abnormal value and thereby changes from the normal state to an abnormal state.

In the abnormal state a value 1 which is used to reset the counter is output in the reset signal and the counter thereby performs a reset operation. The error detection circuit remains in the abnormal state until the timing T which is not a communication timing and at which the communication timing signal is 0 . The next timing T is a communication timing and therefore the communication timing signal becomes 1 . The error detection circuit changes to a normal state. As a result the counter restarts a normal count operation at and after the timing T .

As has been explained above even if the counter malfunctions and the count value thereby indicates an abnormal value the error detection circuit autonomously detects the abnormal state and restores the counter to the normal operation by resetting the counter .

Further even during the malfunction state which begins when a malfunction occurs and continues until the error detection circuit detects the malfunction and it is restored to the normal state the mask restraint circuit generates a mask signal that is used to control the mask circuit in such a manner that the clock pulse is never masked at the communication timing. In this way data communication can be properly performed between the circuits A and B.

Further even if a malfunction occurs in a component other than the counter the mask restraint circuit generates a mask signal that is used to control the mask circuit in such a manner that the clock pulse is never masked at the communication timing and therefore data communication can be performed properly between the circuits A and B.

In this way in this exemplary embodiment in the mask control circuit the counter counts clock pulses of the input clock signal and when the count value reaches the frequency division ratio denominator M the count value is reset. Further a count value indicating a relative phase of the communication timing with respect to the input clock signal is generated and a mask signal in which mask timings are assigned based on this count value is generated. In this way the relative phase of the communication timing with respect to the input clock signal can be derived by using a very simple circuit configuration i.e. by using a counter and therefore it is possible to accurately assign mask timings at timings other than the communication timings.

Further in this exemplary embodiment in the mask control circuit table data indicating the necessity non necessity of masking for each combination of at least the frequency division ratio setting information and the count value is stored in the table circuit. Further table data that is output from the table circuit according to the input combination output as a mask signal. By doing so it is possible to accurately assign desired mask timings at timings other than the communication timings by using a very simple circuit configuration i.e. by using a table circuit.

Further the clock frequency divider circuit in accordance with this exemplary embodiment is entirely composed of digital logic circuits and realizes a rational number frequency division by selecting whether the clock S is masked or not in this way it is possible to lower the power consumption and reduce the layout size. Further since the clock frequency divider circuit does not require any analog circuit and any special design its design testing costs are low.

Further in this exemplary embodiment the mask signal is generated in such a manner that the mask restraint circuit never masks the clock pulse at the communication timing regardless of the value of the mask timing signal . Therefore even if the circuit malfunctions and the mask timing signal thereby indicates an abnormal value data communication can be properly performed between the circuits A and B. As a result it is possible to achieve reliable data communication.

Further in this exemplary embodiment even if the counter malfunctions and the count value thereby indicates an abnormal value the error detection circuit autonomously detects the abnormal state and restores the counter to the normal operation by resetting the counter . As a result reliable data communication can be performed between the circuits A and B.

Next a clock frequency divider circuit in accordance with a second exemplary embodiment is explained with reference to . The clock frequency divider circuit in accordance with this exemplary embodiment shown in has a configuration obtained by removing the error detection circuit from the configuration of the clock frequency divider circuit explained in the first exemplary embodiment. For the clock frequency divider circuit in accordance with this exemplary embodiment duplicated explanation of the components common to those of the first exemplary embodiment is omitted.

The clock frequency divider circuit in accordance with this exemplary embodiment is a clock frequency divider circuit that generates an output clock signal clock B that is obtained by dividing the frequency of an input clock signal clock S at N M N is a positive integer and M is a positive integer greater than N by masking M N clock pulses among M clock pulses of the input clock signal based on a frequency division ratio defined as N M.

The clock frequency divider circuit in accordance with this exemplary embodiment includes a mask control circuit and a mask circuit .

The mask circuit masks clock pulses of an input clock signal clock S according to a mask signal generated by the mask control circuit and thereby generates an output clock signal clock B .

The mask control circuit includes a mask timing signal generation circuit that generates a mask timing signal used to preferentially mask clock pulses at timings other than communication timings among M clock pulses of the input clock signal based on a communication timing signal . Note that the communication timing signal is a signal indicating a communication timing of data communication performed by a target circuit using the output clock signal.

Further the mask control circuit includes a mask restraint circuit. The mask restraint circuit generates a mask signal that is obtained by processing the mask timing signal so that masking of the clock pulse is restrained at the communication timing .

That is the mask restraint circuit generates the mask signal by referring to the mask timing signal and the communication timing signal . In this process at the communication timing it generates a mask signal that is used to control the mask circuit in such a manner that the clock pulse is never masked regardless of the value of the mask timing signal . On the other hand at the timings other than the communication timing it generates a mask signal that is used to control the necessity non necessity of masking according to the value of the mask timing signal .

Therefore even if the counter or the mask timing signal generation circuit malfunctions and the mask timing signal thereby indicates an abnormal value the clock pulse is not masked at least at the communication timing and therefore data communication can be performed properly between the circuits A and B.

As shown in for example the mask restraint circuit can be implemented by using a NOR gate circuit to which the mask timing signal and the communication timing signal are input.

Further a clock frequency division method in accordance with this exemplary embodiment is a clock frequency division method for generating an output clock signal obtained by dividing the frequency of an input clock signal into N M N is a positive integer and M is a positive integer greater than N by masking M N clock pulses among M clock pulses of the input clock signal based on a frequency division ratio defined as N M. The frequency division method includes the following steps.

A step of generating a mask timing signal that is used to preferentially mask clock pulses at timings other than communication timings among M clock pulses of the input clock signal clock S 

a step of generating a mask signal obtained by processing the mask timing signal so that masking of the clock pulse is restrained at the communication timing and

a step of generating an output clock signal clock B by masking clock pulses of the input clock signal according to the mask signal .

Note that the communication timing signal is a signal indicating a communication timing of data communication performed by a target circuit using the output clock signal.

With the invention in accordance with this exemplary embodiment explained above it is possible to provide a clock frequency divider circuit that generates a clock signal that makes it possible to perform an expected proper communication operation in communication with a circuit operating by a clock having a different frequency and a clock frequency division method. Note that it is obvious that for the parts common to those of the first exemplary embodiment of the present invention similar advantageous effects to those of the first exemplary embodiment can be achieved.

Next a clock frequency divider circuit in accordance with a third exemplary embodiment is explained with reference to . The clock frequency divider circuit in accordance with this exemplary embodiment shown in has a configuration obtained by removing the mask restraint circuit from the configuration of the clock frequency divider circuit explained in the first exemplary embodiment. For the clock frequency divider circuit in accordance with this exemplary embodiment duplicated explanation of the components common to those of the first exemplary embodiment is omitted.

The clock frequency divider circuit in accordance with this exemplary embodiment is a clock frequency divider circuit that generates an output clock signal clock B that is obtained by dividing the frequency of an input clock signal clock S at N M N is a positive integer and M is a positive integer greater than N by masking M N clock pulses among M clock pulses of the input clock signal based on a frequency division ratio defined as N M.

The clock frequency divider circuit in accordance with this exemplary embodiment includes a mask control circuit and a mask circuit .

The mask circuit masks clock pulses of an input clock signal clock S according to a mask timing signal generated by the mask control circuit and thereby generates an output clock signal clock B . Note that since there is no mask restraint circuit in this exemplary embodiment the mask timing signal output from the mask timing signal generation circuit is directly input to the mask circuit .

The mask control circuit includes a counter . The counter generates a count value indicating a relative phase of a communication timing with respect to the input clock signal clock S by counting clock pulses of the input clock signal and resetting the count value when the count value reaches the denominator M of the frequency division ratio.

Further the mask control circuit includes a mask timing signal generation circuit that generates a mask timing signal used to preferentially mask clock pulses at timings other than communication timings among M clock pulses of the input clock signal based on the count value and the communication timing signal . Note that the communication timing signal is a signal indicating a communication timing of data communication performed by a target circuit using the output clock signal.

Further the mask control circuit includes an error detection circuit . The error detection circuit determines whether or not the count value is a normal value for the communication timing and when the count value is determined to be not a normal value controls the counter so as to reset the count value.

A specific example of an operation of the error detection circuit is explained with reference to . is an operation transition diagram showing an operation of the error detection circuit .

The error detection circuit is a control circuit having two states consisting of normal and abnormal . Specifically firstly in the normal state the error detection circuit determines whether or not the communication timing signal is 1 indicating a communication timing at the timing at which the count value becomes 0 which is the reset value of the counter by referring to the input count value and the communication timing signal .

If the communication timing signal is 1 at the timing at which the count value becomes 0 the error detection circuit determines that the count value indicates a normal value and remains in the normal state. In the normal state 0 is output to the reset signal so that the counter is not reset and therefore the counter performs a normal count operation.

On the other hand if the communication timing signal is 0 at the timing at which the count value becomes 0 the error detection circuit determines that the count value indicates an abnormal value and changes to an abnormal state. In the abnormal state 1 is output to the reset signal so that the counter is reset and therefore the counter performs a reset operation. When it is not in the communication timing i.e. when the communication timing signal is 0 the error detection circuit remains in the abnormal state.

On the other hand when the communication timing signal becomes 1 indicating a communication timing the error detection circuit changes to a normal state and the counter restarts the normal count operation.

As explained above the error detection circuit determines whether the count value is a normal value or not by determining Whether or not the timing at which the count value becomes the reset value of the counter is simultaneous with the communication timing at which the counter is to be reset.

Further when the count value is determined to be not a normal value the counter is reset at the timing at which the counter is to be reset communication timing . Therefore even if the counter malfunctions and the count value thereby indicates an abnormal value it is autonomously detected and the counter can be restored to the normal operation.

Further a clock frequency division method in accordance with this exemplary embodiment is a clock frequency division method for generating an output clock signal obtained by dividing the frequency of an input clock signal into N M N is a positive integer and M is a positive integer greater than N by masking M N clock pulses among M clock pulses of the input clock signal based on a frequency division ratio defined as N M. The frequency division method includes the following steps.

A step of generating a count value indicating a relative phase of a communication timing with respect to the input clock signal by counting clock pulses of the input clock signal clock S and resetting the count value when the count value reaches the denominator M of the frequency division ratio 

a step of generating a mask timing signal used to preferentially mask clock pulses at timings other than communication timings among M clock pulses of the input clock signal based on the count value and the communication timing signal 

a step of determining whether or not the count value is a normal value for the communication timing and when the count value is determined to be not a normal value controlling the counter so as to reset the count value and

a step of generating an output clock signal clock B by masking clock pulses of the input clock signal clock S according to the mask timing signal .

Note that the communication timing signal is a signal indicating a communication timing of data communication performed by a target circuit using the output clock signal.

With the invention in accordance with this exemplary embodiment explained above it is possible to provide a clock frequency divider circuit that generates a clock signal that makes it possible to perform an expected proper communication operation in communication with a circuit operating by a clock having a different frequency and a clock frequency division method. Note that it is obvious that for the parts common to those of the first exemplary embodiment of the present invention similar advantageous effects to those of the first exemplary embodiment can be achieved.

Next a clock frequency divider circuit in accordance with a fourth exemplary embodiment is explained with reference to . Note that duplicated explanation of the components common to those of the first exemplary embodiment is omitted.

A clock N indicating a communication timing between the circuits A and B as well as frequency division ratio setting information B B used to set the frequency division ratio of the clock B are input to the clock frequency divider circuit B. The clock frequency divider circuit B generates a clock B by dividing the frequency of a clock S by a rational number based on the frequency division ratio setting information B B and the clock N.

Meanwhile the clock N indicating a communication timing between the circuits A and B as well as frequency division ratio setting information A A used to set the frequency division ratio of the clock A are input to the clock frequency divider circuit A. The clock frequency divider circuit A generates a clock A by dividing the frequency of the clock S by a rational number based on the frequency division ratio setting information A A and the clock N.

The circuits A and B communicate with each other at the rising edge timings of the clock N through signals Aout and Bout. In this example the circuit A outputs a signal Aout by driving a flip flop circuit A with the clock A and the circuit B receives the signal Aout by driving a flip flop circuit B with the clock B. Meanwhile the circuit B outputs a signal Bout by driving a flip flop circuit B with the clock B and the circuit A receives the signal Bout by driving a flip flop circuit A with the clock A.

An example of the generation of clocks A and B is explained with reference to . Note that the frequency of the clock N is one fourth 3 12 of the clock S and the clocks A and B are generated by dividing the frequency of the clock S at frequency division ratios 11 12 to 3 12.

Since the frequency division ratio denominators M of the clocks A B and N to the clock S are all twelve the phase relations between the clock A and the clock N and between the clock B and the clock N make a full circle in twelve cycles of the clock S. The timings of the twelve cycles in which the phase relations make a full circle are represented by T to T . The circuit A and the circuit B communicate with each other at the timings T T and T which correspond to all the rising edge timings of the clock N.

The clock frequency divider circuit A and the clock frequency divider circuit B receive the clock N indicating the above mentioned communication timings at the respective mask control circuits . The mask control circuits control the mask circuits in such a manner that clock pulses at the communication timings of the communication between them are never masked and some of the clock pulses at the timings other than the communication timings are masked.

The mask control circuits generate respective mask signals that are used to mask clock pulses at the timings other than the communication timings among the clock pulses of the clock S. That is M N mask timings at each of which a clock pulse is masked are assigned to some of the timings other than the timings T T and T.

For example in a clock A corresponding to a frequency division ratio 11 12 can be generated by assigning a mask timing at a timing other than the timings T T and T among the twelve clock pulses at the timings T to T of the clock S e.g. at a timing T. Further a clock A corresponding to a frequency division ratio 10 12 can be generated by additionally assigning a mask timing at a timing T.

Similarly in a clock B corresponding to a frequency division ratio 11 12 can be generated by assigning a mask timing at a timing other than the timings T T and T among the twelve clock pulses at the timings T to T of the clock S e.g. at a timing T. Further a clock B corresponding to a frequency division ratio 10 12 can be generated by additionally assigning a mask timing at a timing T.

With the invention in accordance with this exemplary embodiment it is also possible to provide a clock frequency divider circuit that generates a clock signal that makes it possible to perform an expected proper communication operation in communication between circuits operating by clocks having different frequencies. Note that it is obvious that for the parts common to those of the other exemplary embodiments of the present invention similar advantageous effects to those of the other exemplary embodiments can be achieved.

Next a clock frequency divider circuit in accordance with a fifth exemplary embodiment is explained with reference to . shows a clock frequency divider circuit in accordance with a fifth exemplary embodiment of the present invention.

In the fourth exemplary embodiment a case where two circuits i.e. the circuit A operating by a clock A and the circuit B operating by a clock B communicate with each other is explained. In the fifth exemplary embodiment a case where there are three or more clocks and circuits is explained. Note that duplicated explanation of the components common to those of the first or fourth exemplary embodiment is omitted.

A clock N indicating a communication timing among the clocks A B and C as well as frequency division ratio setting A used to set the frequency division ratio of the clock A are input to the clock frequency divider circuit A. Further the clock frequency divider circuit A generates a clock A by dividing the frequency of a clock S by a rational number based on these inputs. Similarly the clock frequency divider circuit B receives the clock N indicating the above described communication timing as well as frequency division ratio setting B used to set the frequency division ratio of the clock B and generates a clock B by dividing the frequency of the clock S by a rational number based on these inputs. Similarly the clock frequency divider circuit C receives the clock N indicating the above described communication timing as well as frequency division ratio setting C used to set the frequency division ratio of the clock C and generates a clock C by dividing the frequency of the clock S by a rational number based on these inputs.

The circuits A B and C communicate with one another at communication timings based on the clock N. Among these circuits the circuits A and B communicate with each other through signals Aout and Bout. In the communication the circuit A outputs the signal Aout by driving a flip flop circuit A at a rising edge of the clock A and the circuit B receives the signal Aout by driving a flip flop circuit B at a rising edge of the clock B. Further the circuit B outputs the signal Bout by driving a flip flop circuit B at a rising edge of the clock B and the circuit A receives the signal Bout by driving a flip flop circuit A at a rising edge of the clock A.

Further the circuits A and C communicate with each other through signals Aout and Cout. In the communication the circuit A outputs the signal Aout by driving a flip flop circuit A at a rising edge of the clock A and the circuit C receives the signal Aout by driving a flip flop circuit C at a rising edge of the clock C. Further the circuit C outputs the signal Cout by driving a flip flop circuit C at a rising edge of the clock C and the circuit A receives the signal Cout by driving a flip flop circuit A at a rising edge of the clock A.

Further the circuits B and C communicate with each other through signals Bout and Cout. In the communication the circuit B outputs the signal Bout by driving a flip flop circuit B at a rising edge of the clock B and the circuit C receives the signal Bout by driving a flip flop circuit C at a rising edge of the clock C. Further the circuit C outputs the signal Cout by driving a flip flop circuit C at a rising edge of the clock C and the circuit B receives the signal Cout by driving a flip flop circuit B at a rising edge of the clock B.

In this exemplary embodiment the clock frequency divider circuit A the clock frequency divider circuit B and the clock frequency divider circuit C receive the clock N indicating the above described communication timing. Then the clock frequency divider circuits realize a rational number frequency division by performing control based on the clock N in such a manner that clock pulses at the communication timings are never masked and some of the clock pulses at the timings other than the communication timings are masked.

Specifically the clocks A B and C are generated by preventing the clock pulses from being masked at the timings T T T and T which are the communication timings and masking some of the clock pulses at the timings T T T T T T T and T which are non communication timings.

As described above in this exemplary embodiment a clock pulse exists at the communication timing without fail in the clock generated by the clock frequency divider circuit. Therefore an expected proper communication operation can be realized in communication between circuits using clocks having different frequencies.

Further in communication between circuits using a clock having a different frequency effective communication can be performed without deteriorating the communication performance. Furthermore even when the frequency division ratio is changed it is unnecessary to change the communication timing of the communication with a circuit using a clock having a different frequency according to the change. For example in the example of clock frequency division shown in even when the frequency division ratio of the clocks A B and C is changed to any of the frequency division ratios 11 12 to 4 12 it is unnecessary to change the communication timings T T T and T thus making it possible to cope with the change in a flexible manner.

In the invention in accordance with this exemplary embodiment it is also possible to provide a clock frequency divider circuit that generates a clock signal that makes it possible to perform an expected proper communication operation in communication with a circuit operating by a clock having a different frequency. Note that it is obvious that for the parts common to those of the other exemplary embodiments of the present invention similar advantageous effects to those of the other exemplary embodiments can be achieved.

Although the present invention is explained above with reference to specific exemplary embodiments the present invention is not limited to the above described exemplary embodiments. Various modifications that can be easily understood by those skilled in the art can be made to the configurations and the details of the present invention without departing from the scope of the present invention.

