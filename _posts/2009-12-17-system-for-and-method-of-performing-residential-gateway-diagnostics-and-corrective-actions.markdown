---

title: System for and method of performing residential gateway diagnostics and corrective actions
abstract: A system for and method of system for performing residential gateway diagnostics and corrective actions is presented. In one exemplary embodiment, the method may comprise running one or more diagnostic tests on a residential gateway using a module of the residential gateway, storing a diagnostic test result, analyzing the diagnostic test result, and performing one or more corrective actions in response to the diagnostic test result.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09130766&OS=09130766&RS=09130766
owner: VERIZON PATENT AND LICENSING INC.
number: 09130766
owner_city: Basking Ridge
owner_country: US
publication_date: 20091217
---
Residential gateway devices support a number of interfaces and devices. Configuration maintenance and diagnostics of residential gateway devices is too complex for many users. The inability of users to configure and troubleshoot residential gateway devices results in an increase of requests for technical support. The inability of users to configure and troubleshoot residential gateway devices also results in the return of a number of correctly operating residential gateway devices.

Residential gateways broadband home routers Customer Premise Equipment and other remotely located network access devices provide an increasing level of services and interfaces. The increasing number of services and interfaces enhance the complexity for setup and maintenance. According to an exemplary embodiment a residential gateway a broadband router or other network access device may include one or more of a module an agent or a process for performing one or more diagnostic tests. The module process or agent may be configured to analyze data from the diagnostic test and perform one or more corrective actions in response to the analysis. The state of the network access device may be captured and saved in persistent storage for further analysis. The administration of the agent in terms of activation configuration execution and retrieval of test results may be performed via a network access device management system. For certain network access device error conditions an end user of the device may be prompted with a supporting help user interface e.g. web pages provided or served by the network access device to assist in troubleshooting and fixing the error conditions.

The description below describes network elements computers and or components of a system of and method for performing residential gateway diagnostics and corrective actions that may include one or more modules. As used herein the term module may be understood to refer to computing software firmware hardware and or various combinations thereof. Modules however are not to be interpreted as software which is not implemented on hardware firmware or recorded on a processor readable recordable storage medium i.e. modules are not software per se . It is noted that the modules are exemplary. The modules may be combined integrated separated and or duplicated to support various applications. Also a function described herein as being performed at a particular module may be performed at one or more other modules and or by one or more other devices instead of or in addition to the function performed at the particular module. Further the modules may be implemented across multiple devices and or other components local or remote to one another. Additionally the modules may be moved from one device and added to another device and or may be included in both devices.

Network may be a wireless network a wired network or any combination of wireless network and wired network. For example network may include one or more of a fiber optics network a passive optical network a cable network an Internet network a satellite network e.g. operating in Band C Band Ku or Band Ka a wireless LAN a Global System for Mobile Communication GSM a Personal Communication Service PCS a Personal Area Network PAN D AMPS Wi Fi Fixed Wireless Data IEEE 802.11a 802.11b 802.15.1 802.11n and 802.11g or any other wired or wireless network for transmitting and or receiving a data signal. In addition network may include without limitation telephone line fiber optics IEEE Ethernet 802.3 a Wide Area Network WAN a Local Area Network LAN or a global network such as the Internet. Also network may support an Internet network a wireless communication network a cellular network or the like or any combination thereof. Network may further include one or any number of the exemplary types of networks mentioned above operating as a stand alone network or in cooperation with each other. Network may utilize one or more protocols of one or more network elements to which it is communicatively coupled. Network may translate to or from other protocols to one or more protocols of network devices. Although network is depicted as one network it should be appreciated that according to one or more embodiments network may comprise a plurality of interconnected networks such as for example a service provider network the Internet a broadcaster s network a cable television network corporate networks and home networks.

Network elements and data storage may transmit and receive data to and from network representing residential gateway diagnostic data error correction data and other data. The data may be transmitted and received utilizing a standard telecommunications protocol or a standard networking protocol. For example one embodiment may utilize Session Initiation Protocol SIP . In other embodiments the data may be transmitted and or received utilizing other Voice Over IP VoIP or messaging protocols. For example data may also be transmitted and or received using Wireless Application Protocol WAP Multimedia Messaging Service MMS Enhanced Messaging Service EMS Short Message Service SMS Global System for Mobile Communications GSM based systems Code Division Multiple Access CDMA based systems Transmission Control Protocol Internet TCP IP Protocols or other protocols and systems suitable for transmitting and receiving broadcast or parallel search data. Data may be transmitted and received wirelessly or may utilize cabled network or telecom connections such as an Ethernet RJ45 Category 5 Ethernet connection a fiber connection a traditional phone wireline connection a cable connection or other wired network connection. Network may use standard wireless protocols including IEEE 802.11a 802.11b and 802.11g. Network may also use protocols for a wired connection such as an WEE Ethernet 802.3.

Wireless device may be a wireline phone a cellular phone a mobile phone a satellite phone a Personal Digital Assistants PDA a computer a handheld MP3 player a handheld video player a personal media player a gaming device or other devices capable of communicating with network via network element . According to some embodiments wireless device may be use Voice Over IP VOIP to provide one or more services.

Network client may be a desktop computer a laptop computer a server a personal digital assistant or other computer capable of sending and receiving network signals. Network client may use a wired or wireless connection. Although depicted as connected via a residential gateway in in one or more embodiments network client may connect directly to network or via other network connectivity devices. According to one or more embodiments network client using a wireless connection may authenticate with a network using Wired Equivalent Privacy Wi Fi Protected Access or other wireless network security standards.

Network elements and data storage and network element may include one or more processors not shown for recording transmitting receiving and storing data. Although network elements and data storage are depicted as individual elements it should be appreciated that the contents of one or more of a network element and data storage may be combined into fewer or greater numbers of devices and may be connected to additional devices not depicted in . Furthermore the one or more devices may be local remote or a combination thereof to a first network element and data storage .

Data storage may be network accessible storage and may be local remote or a combination thereof to network elements and . Data storage may utilize a redundant array of inexpensive disks RAID tape disk a storage area network SAN an internet small computer systems interface iSCSI SAN a Fibre Channel SAN a common Internet File System CIFS network attached storage NAS a network file system NFS or other computer accessible storage. In one or more embodiments Data storage may be a database such as an Oracle database a Microsoft SQL Server database a DB2 database a MySQL database a Sybase database an object oriented database a hierarchical database or other database. Data storage may utilize flat file structures for storage of data.

According to some embodiments data storage may be a relational database that may store diagnostic data configuration data and data associated with corrective actions. Data may be aggregated sorted processed and queried to identify memory trends network connectivity problems configuration problems and other issues. Associations may be made between identified issues identified in the diagnostic data and appropriate corrective actions. According to some embodiments data storage may provide one or more APIs or other interfaces which may be used by a web server or other application to distribute present and share information.

Network elements and may be one or more servers or server like devices such as a Session Initiation Protocol SIP server. Network elements and may include one or more processors not shown for recording transmitting receiving and storing data. According to one or more embodiments network elements and may contain SNMP Simple Network Management Protocol Managers and other network management tools. Network elements and may be servers of a service provider the Internet a broadcaster a cable television network or another media provider. According to some embodiments network element may be a Domain Name Server DNS a gateway or other network infrastructure.

According to some embodiments Network element may be a broadband home router management system a Customer Premise Equipment CPE management system or a residential gateway management system. Network element may receive or query diagnostic test results and other data from residential gateways broadband home routers and other Customer Premise Equipment CPE . Network element may store diagnostic test results locally or remotely such as on data storage . Network element may administer an agent process or module on a residential gateway a broadband home router or other Customer Premise Equipment CPE . For example network element may activate module configure module or initiate the execution of one or more diagnostic test results or corrective actions by module . Network element may contain or access configuration information for configuring residential gateways and other network access devices. For example network element may receive data from module indicating that network element has accessed network . Network element may configure network element . Configuration may include configuring module to run one or more diagnostic tests on a periodic schedule. Configuration may also include providing network element with data associating one or more corrective actions with one or more diagnostic test results. Module may be capable of running diagnostic tests and performing corrective actions independently of network element and independent of a status of network connectivity for network element . According to some embodiments network element may be provided to a customer pre configured.

Network elements and may provide Application Programming Interfaces APIs interface tables Remote Procedure Calls RPCs web services Extensible Markup Language XML based interfaces Simple Object Access Protocol SOAP based interfaces Common Object Request Broker Architecture CORBA and other interfaces for sending or receiving media searches preferences or other information. Network elements and may receive data from broadcasters users service providers internet information sources or other media related information sources.

According to one or more embodiments network element may be a residential gateway such as a router or another piece of Customer Premises Equipment CPE providing access to one or more pieces of equipment. For example network element may provide audio video programming content feeds to a set top box such as set top box . Network element may also provide network connectivity for other clients such as network client and wireless device . One or more additional devices may be present. For example network element may be connected to network via an Optical Network Terminal ONT . A gateway may also be present which may provide or deny network element access to network .

According to some embodiments module may perform one or more diagnostic tests may store diagnostic test results analyze one or more diagnostic test results and may perform one or more corrective actions in response to a diagnostic test result. Module may include an agent or a process for performing diagnostic test results or corrective actions. According to some embodiments module may be executable software stored on electronic storage of network element and executed by one or more processors of network element . Tests and corrective actions performed by module may be performed in response to a request such as a request from an equipment management system. Module may also perform tests and corrective actions as a periodic scheduled event. According to some embodiments if a measured parameter on network element meets a specified criteria one or more diagnostic tests or corrective actions may be performed. For example one or more diagnostic tests may be performed or scheduled if a CPU memory or other component of network element exceeds a specified threshold.

Diagnostic tests performed by module may include internal system resource tests WAN tests LAN tests and other tests. Internal system resource tests may include but are not limited to a memory utilization test a CPU utilization test and a software version test. LAN diagnostic tests performed by module may include for example a test to verify that a LAN interface is enabled and active a test to verify that bandwidth for a Multimedia over Coax Alliance MoCA based interface meets a specified threshold a test to verify that errors of a LAN Ethernet port are below a specified threshold e.g. CRC Cyclic Redundancy Check errors framing errors hardware port failures a test to verify that a WiFi signal level meets a specified threshold a test to determine a number of connected and active LAN devices a test to determine whether a connected LAN device has an IP address assigned a test to determine the bandwidth of a LAN interface and a test to verify IP connectivity of a Multimedia over Coax Alliance MoCA based set top box device. WAN diagnostic tests performed by module may include but are not limited to a test to ensure that a connected residential gateway has a single WAN interface active a test to verify that a WAN interface transmission rate meets a specified threshold a test to verify that errors of a WAN Ethernet port are below a specified threshold a WAN IP assignment test a WAN IP connectivity test and a WAN interface bandwidth test.

Module may store one or more diagnostic test results. Diagnostic test results may be stored locally on electronic storage of network element or remote from network element such as in data storage . Diagnostic test results may be stored in one or more formats including but not limited to a log file and as a Technical Report 069 compliant parameter extension TR 069 is a Customer Premise Equipment WAN management protocol published by the Broadband Forum in technical report 069 1.1 Issue 1 Amendment 2 December 2007 and incorporated herein by reference in its entirety . Module may transmit diagnostic test results or provide an interface to diagnostic test results. For example module may transmit diagnostic test results to network element or be queried by network element . According to some embodiments module may transmit diagnostic test data using TR 069 to network element .

Corrective actions performed by module may include resetting a network interface of network access equipment such as a residential gateway or broadband home router. Corrective actions performed by module may also include rebooting a residential gateway and resetting one or more parameters of the residential gateway to a default setting e.g. a factory setting . Corrective actions to execute may be identified based on stored data associating a corrective action with a diagnostic test result. According to one or more embodiments corrective actions for a particular test result may be prioritized indicating a first corrective action to try and one or more subsequent corrective actions to try if a fault or error persists. For example the number of reboots of a piece of network access equipment may be counted. After a specified number of reboots e.g. three parameters of the network access equipment may be reset if the fault or error persists.

According to some embodiments corrective actions may comprise providing a user interface to a user of the network access equipment. For example a user interface may be a web page served by module to wireless device or network client . The user interface may provide results of a diagnostic test such as an error code an error description suggested corrective actions pictures of network equipment identifying features or aspects of the equipment screenshots showing configuration information and support group contact information. For example a broadband home router may be depicted and connections interfaces tags controls and other aspects of the router may be identified. Descriptive text may be included in the user interface explaining configuration and use of the depicted broadband home router. In some embodiments a user interface may include a web page provided via public wireless access e.g. not using WEP Wired Equivalent Privacy . The public wireless access may be limited to configuration instructions troubleshooting instructions support contact information and diagnostic information which does not provide any confidential proprietary or sensitive information. The public wireless access may be disabled automatically after success resolution of a setup or configuration issue. The public wireless access may provide information on how to connect a wired connection to network element e.g. a diagram may show an Ethernet port or other port of network element and provide instructions on how to configure a laptop to connect to network element . More detailed instructions may be provided via a non public wired connection. The user interface may be generated by module regardless of whether network element has network connectivity. Thus a user may be able to receive support prior to establishing connectivity for network element .

The various components of system as shown in may be further duplicated combined and or integrated to support various applications and platforms. Additional elements may also be implemented in the systems described above to support various applications.

Diagnostic module may run one or more diagnostic tests may store diagnostic test results and analyze one or more diagnostic test results. Diagnostic tests performed by diagnostic module may include internal system resource tests WAN tests LAN tests and other tests. Internal system resource tests may include but are not limited to a memory utilization test a CPU utilization test and a software version test. LAN diagnostic tests performed by diagnostic module may include for example a test to verify that a LAN interface is enabled and active a test to verify that bandwidth for a Multimedia over Coax Alliance MoCA based interface meets a specified threshold a test to verify that errors of a LAN Ethernet port are below a specified threshold e.g. CRC Cyclic Redundancy Check errors framing errors hardware port failures a test to verify that a WiFi signal level meets a specified threshold a test to determine a number of connected and active LAN devices a test to determine whether a connected LAN device has an IP address assigned a test to determine the bandwidth of a LAN interface and a test to verify IP connectivity of a Multimedia over Coax Alliance MoCA based set top box device. WAN diagnostic tests performed by diagnostic module may include but are not limited to a test to ensure that a connected residential gateway has a single WAN interface active a test to verify that a WAN interface transmission rate meets a specified threshold a test to verify that errors of a WAN Ethernet port are below a specified threshold a WAN IP assignment test a WAN IP connectivity test and a WAN interface bandwidth test.

Corrective actions module may perform one or more corrective actions. Corrective actions may be performed in response to a received command in response to a diagnostic test result or as a scheduled event. Corrective actions performed by corrective actions module may include resetting a network interface of network access equipment such as a residential gateway or broadband home router. Corrective actions performed by corrective actions module may also include rebooting a residential gateway and resetting one or more parameters of the residential gateway to a default setting e.g. a factory setting . Corrective actions to execute may be identified based on stored data associating a corrective action with a diagnostic test result. According to one or more embodiments corrective actions for a particular test result may be prioritized indicating a first corrective action to try and one or more subsequent corrective actions to try if a fault or error persists. For example the number of reboots of a piece of network access equipment may be counted. After a specified number of reboots e.g. three parameters of the network access equipment may be reset if the fault or error persists.

Schedule module may schedule one or more diagnostic tests corrective actions or other events. Upon the arrival of a scheduled time schedule module may initiate execution of a diagnostic test or corrective action via communication with diagnostic module or corrective actions module respectively.

User interface module may provide a user interface to a user of the network access equipment. For example a user interface may be a web page served by user interface module to wireless device or network client . The user interface may provide results of a diagnostic test such as an error code an error description suggested corrective actions pictures of network equipment identifying features or aspects of the equipment screenshots showing configuration information and support group contact information. For example a broadband home router may be depicted and connections interfaces tags controls and other aspects of the router may be identified. Descriptive text may be included in the user interface explaining configuration and use of the depicted broadband home router. In some embodiments a user interface may include a web page provided via public wireless access e.g. not WEP enabled . The public wireless access may be limited to configuration instructions troubleshooting instructions support contact information and diagnostic information which does not provide any confidential proprietary or sensitive information. The public wireless access may be disabled automatically after success resolution of a setup or configuration issue. The public wireless access may provide information on how to connect a wired connection to network element e.g. a diagram may show an Ethernet port or other port of network element and provide instructions on how to configure a laptop to connect to network element . More detailed instructions may be provided via a non public wired connection. The user interface may be generated by user interface module regardless of whether network element has network connectivity. Thus a user may be able to receive support prior to establishing connectivity for network element .

Error handling and reporting module may handle one or more errors associated with diagnostic tests or corrective actions. Error handling and reporting module may provide alerts or messages to administrators in the event of an error. Error handling and reporting module may produce one or more reports including diagnostic test result reports and corrective action reports. Error handling and reporting module may produce log files TR 069 formatted reports and reports in other formats.

The diagnostic tests of specify an exemplary logging format for results. Upper case words may represent labels while lower case words may be variables representing assigned values. Threshold labels e.g. MEM THRESHOLD may be values defined in a configuration file or as a TR 069 parameter extensions. For interface tests the associated test may be performed if the interface is enabled otherwise the test may be skipped and the returned result may be treated as TRUE. For an interface which is enabled but in a disconnected state the returned result may be treated as TRUE as well.

At block the diagnostics mode may be verified. Diagnostics modes may include periodic and immediate execution of diagnostic tests. If a diagnostic test is scheduled the method may continue at block . If a request for an immediate diagnostic test has been received the method may continue at block .

At block a process agent or module such as module may determine whether the scheduled period has arrived. If the scheduled period has arrived the method may continue at block . If the scheduled period has not arrived the method may wait at block . After a specified wait the method may return to block .

At block one or more diagnostics tests may be performed. The number and type of diagnostics tests may be configurable. The configuration of diagnostic tests may occur prior to providing equipment such as network element to a user. Diagnostic tests may also be configured or scheduled remotely by a network access device management system such as network element . At block one or more internal diagnostic tests may be performed to verify resources of a network access device such as by way of non limiting example memory utilization CPU utilization electronic storage utilization network interface status software version and firmware version. Thresholds of diagnostic tests may be defined using labels which may be specified as TR 069 parameters. As described below labels or threshold levels may be specified as uppercase terms. Actual values may be lower case terms.

According to some embodiments an internal systems resource test may ensure that there are sufficient internal resources in order for a network access device such as a broadband home router to operate optimally. The internal systems resource test may be labeled with a TR 069 parameter of TBHR. A CPU and memory utilization snapshot may be taken at the time during the self diagnostics operation or using a polling interval. The polling interval may be specified with a label of BANDWIDTH POLLING INTERVAL as defined in greater detail below. The memory threshold test for a network access device may a condition labeled CBHR MEM. The memory threshold for a network access device may be tested using a label of MEM THRESHOLD which may be configurable. An exemplary test for a memory threshold may be 

Internal systems resource tests may also test the CPU utilization which may be a condition labeled CBHR CPU. An exemplary test for the CPU utilization may be 

The internal systems resource test labeled TBHR may also capture other device statistics including pc a count of a total number of active processes mu a total percentage of memory utilized fu a total percentage of flash storage utilized cpu a total percentage of CPU utilized nat a total percentage of a NAT Network Address Translation table in use x an integer value indicating a status of one or more LEDs of a network access device where 0 off 1 on and 2 flashing LED state if applicable a listing of processes with corresponding memory utilization in decreasing order or in another order e.g. p mu p mu according to one embodiment only the top 5 processes will be listed and a listing of processes with corresponding CPU utilization in decreasing order or in another order e.g. pp cpu pp cpu according to one embodiment only the top 5 processes will be listed . According to some embodiments output from the an internal systems resource test may be written to a log displayed or stored as 

WMOCALED may indicate a status of an LED associated with a WAN MOCA interface. LANMOCALED may indicate a status of an LED associated with a LAN MOCA interface. LANETHLED may indicate a status of an LED associated with a LAN Ethernet interface. After internal systems resource tests are completed the method may continue at block .

At block one or more WAN interface tests may be performed. A first WAN interface test may verify that only one WAN interface is enabled and active at a time when a device is in a connected state. This WAN Interface Type test may be labeled TWANTYPE. The condition tested may be labeled CWANTYPE. The CWANTYPE condition test may be 

The tr may be a variable for True or False where True enabled and False disabled. ETH may be an abbreviation for an WAN Ethernet interface and MOCA may be an abbreviation for a WAN MOCA interface.

Another WAN interface test performed at block may include a WAN MoCA Interface test which may be labeled TWANMOCA. This test may be performed if the MoCA interface is enabled. It may ensure that the transmission rate for both Tx transmission rate and Rx reception rate is greater than a MoCA threshold level for expected performance. A first condition tested may be for a WAN MOCA port status and the condition may be labeled CWANMOCA PORT. The test may be 

A second condition may test the transmission and reception rate and may be labeled CWANMOCA RATE. The test may be 

If both transmission rate Tx and Rx are greater than MoCA THRESHOLD then return TRUE else return FALSE.

The tr may be a variable for True or False where True good False bad. The xx may represent an integer value for a number of bytes or other unit of data transmission measurement. According to some embodiments output from the test may be written to a log displayed or stored as 

Another WAN test run at block may include a WAN Ethernet Interface test which may be labeled TWANETH. This test may verify that a WAN Ethernet port is operating optimally i.e. no hardware issue excessive framing errors CRC Cyclic Redundancy Check errors or other issues. This test may be run if a WAN Ethernet interface is enabled. A first condition tested may be labeled CWANETH PORT. The test may be 

The tr may be a variable holding xx and yy variables. The xx variable may be True or False where True port enabled False port disabled. The yy may True or False where True device attached and False no device attached.

Still another WAN interface test performed at block may be a WAN IP Assignment test which may be labeled TWANIP. This test may ensures that a network access device has a WAN IP assigned. A first condition tested may be labeled CWANIP. The test may be 

Other WAN interface tests run at block may include a WAN IP Connectivity test which may be labeled TWANIPCON. This test may ensure that a network access device has WAN IP connectivity. The IP connectivity may be validated via ping tests to both a default gateway the first hop network router and a DNS Domain Name Server . Several conditions may be tested. A first condition may test a default gateway and may be labeled CWANIPCON PNGDF. The test may be 

A second condition of WAN IP connectivity which is tested may be labeled CWANIPCON PNGDNS. The test may be 

A third condition of WAN IP connectivity which is tested may be labeled CWANIPCON DNSR. The test may be

 DGIP may be a variable for a default gateway IP. xxx.xxx.xxx.xxx may be an IP address. DNSIP may be a variable for the IP address of a DNS. The variable rt may be an average ping response time in milliseconds. If a ping times out then rt may equal 1. The variable dnsr may equal T or F where T equals DNS resolution passed and F equals DNS resolution failed. 

Still another WAN interface test performed at step may test WAN Bandwidth Statistics and may be labeled TWANBW. This test may ensure that the WAN interface is able to send and receive network traffic based on the delta bytes count. The delta bytes count may be the difference between the current value and the last recorded polled value. The poll interval may be configurable and may be set remotely by a network access device management system. A default value may be every hour. The delta bytes test condition may be labeled CWANBW. The test may be 

If both the delta number of bytes sent and number of bytes received are greater then WANBW THRESHOLD return TRUE else return FALSE

The label TB may signify transmission bandwidth. The label RB may signify reception bandwidth. The variables xx may hold an integer value representing a number of bytes.

In some embodiments no WAN testing may be performed. In other embodiments one or more WAN tests may be performed. After completion of WAN testing the method may begin LAN testing at block . A first test may be a LAN interface types test which may be labeled TLANTYPE. This test may ensure that at least one of the LAN interfaces is enabled and active. A condition associated with this test may be labeled CLANTYPE. The test may be 

If one or more of the LAN interface are enabled i.e. LAN MoCA LAN Ethernet and LAN WiFi then TRUE else FALSE.

The label LMOCA may be an abbreviation for a LAN MOCA interface. The label LETH may an abbreviation for a LAN Ethernet interface. The label LWIFI may be an abbreviation for a LAN WiFi interface. The variables xx may hold a T or F where T true F false .

A second LAN interface test which may be performed at step may be a LAN MoCA Interface test which may be labeled TLANMOCA. This test may be performed if the MoCA interface is enabled and active. It may ensure that the transmission rate for transmitted data Tx and received data Rx meets a specified criteria such as by way of non limiting example 180 Mbps. A first condition of this test may check a LAN MOCA port and may be labeled CLANMOCA PORT. The test may be 

A second condition of this test may check a LAN MOCA data rate and may be labeled CLANMOCA RATE. The test may be 

If both transmission rate Tx and Rx are greater than MoCA THRESHOLD then return TRUE else return FALSE

The variable tr may T or F where T good and F bad. The variables xx may hold an integer value representing a number of bytes.

A third LAN interface test which may be performed at step may be a LAN Ethernet interface test and may be labeled TLANETH. This test may be performed if the LAN Ethernet interface is enabled. It may ensure that one or more the Ethernet ports with devices attached are operating optimally e.g. have no hardware port failures excessive framing or CRC errors. A condition of this test may be labeled CLANETH PORT. The test may be 

If all the LAN Ethernet ports with attached device s are operating optimally no hardware failure etc. then return TRUE else return FALSE

The variable tr may equal xx yy where xx may equal T port enabled or F port disabled and yy may equal T device attached or F no device connected to the port . According to some embodiments output from the test may be written to a log displayed or stored as 

Yet another LAN interface test which may be performed at step may be a LAN WiFi Interface which may be labeled as TLANWIFI. This test may ensure that a WiFi signal level RSSI is acceptable for one or more WiFi device that is visible in an interface. The test may only be performed if a Wifi interface is enabled. A condition of the test may be labeled CLANWIFI PORT. The test may be

If the WiFi interface is operating optimally i.e. not hardware issues or errors then return TRUE else return FALSE.

The variable tr may T or F where T good and F bad. The variable dc may hold an integer value representing a total device count. The variable r may hold an value representing a percentage of a RSSI Received Signal Strength Indication level of an attached WiFi device where 100 may imply a maximum signal. The variable ma may hold an value representing a MAC Media Access Control Address for a first device ma . Other MAC address variables may be present for second and subsequent devices e.g. ma .

Another LAN interface test which may be performed at step may be a LAN Device Visibility test which may be labeled TLANDEV. This test may determine how many LAN devices are currently attached and active on the various LAN interfaces e.g. LAN Ethernet LAN MoCA and LAN WiFi of a network access device. The device count determination may be done at the physical medium level and not at the IP level. A LAN device may be included in the count if it has been attached and active for more than a specified configurable period of time e.g. 30 minutes . The specified period of time may be correlated to a frequency of record updates on a network access device. A first condition of this test may be labeled CLANDEV. The test may be 

The label TLANDEV may signify the total LAN device count. The label DMOCA may signify the count of devices attached via a LAN MOCA interface. The label DETH may signify a count of devices attached via a LAN Ethernet interface. The label DWIFI may signify a count of devices attached via a WiFI interface. The variables xx may hold an integer value representing a number of devices associated with that interface.

Still another LAN interface test which may be performed at step may be a LAN Device IP Address Assignment test which may be labeled TLANIP. This test may ensure that one or more LAN devices that are currently attached and active have an IP address assigned correctly. One of the method to determine if the LAN device is active or inactive may be sending an ARP request from a network access device such as network element . A condition of the test may be labeled CLANIP. The test may be 

The label TLANIP may signify the total LAN IP address assignments. The label IPMOCA may signify the count of addresses assigned to devices attached via a LAN MOCA interface. The label IPETH may signify the count of addresses assigned to devices attached via a LAN Ethernet interface. The label IPWIFI may signify a count of addresses assigned to a device attached via a WiFI interface. The variables may hold an integer value representing a number of devices attached to a particular interface with a valid IP address assignment.

A LAN interface test which may be performed at step may be a LAN Bandwidth Statistics test which may be labeled TLANBW. This test may ensures that at least one or more of the enabled LAN interfaces are able to send or receive network traffic based on a delta bytes count. The delta bytes count is the difference between the current value and the last recorded poll value. The poll interval may be configurable and may be set remotely by a network access device management system. A default value may be every hour. The delta bytes test condition may be labeled as CLANBW. The test may be 

In any LAN interface if both the delta number of bytes sent and number of bytes received are greater then LANBW THRESHOLD return TRUE else return FALSE

The label TLANBW may signify total LAN bandwidth. The label LMOCATB may signify transmission bandwidth for a LAN MOCA interface. The label LMOCARB may signify reception bandwidth for a LAN MOCA interface. The label LETHRB may signify transmission bandwidth for a LAN Ethernet interface. The label LETHRB may signify reception bandwidth for a LAN Ethernet interface. The label LWIFITB may signify transmission bandwidth for a LAN WiFi interface. The label LWIFIRB may signify reception bandwidth for a LAN WiFi interface. The variables xx may hold an integer value representing a number of bytes for a particular interface.

A test performed at step may include a LAN MoCA STB Set Top Box Devices IP Connectivity test which may be labeled TLANIPCONSTB. This test may ensure that one or more STB devices that are attached and active on this LAN interface respond successfully to a PING test operation. Set Top Box devices that failed a PING test may be logged. Set Top Box devices may have associated hostnames such as for example IP STB IP STB etc. Other devices supported in the MoCA network via MoCA adapters which respond to a ping test may also be tested. A condition of the test may be labeled CLANIPCONSTB PNG. The test may be 

According to one or more embodiments output from the test may be written to a log displayed or stored as 

The label TLANIPCONSTB may signify the total set top boxes that passed a LAN IP connectivity test. The variable sc may hold an integer value of a number of devices passed the test. The variable xx may hold an integer value of a number of devices failed the test. The variable yy may provide a list of devices that failed the ping test in the form of MAC address IP address for each device that failed the test.

In some embodiments no LAN testing may be performed. In other embodiments one or more LAN tests may be performed. After completions of LAN testing the method may begin store one or more diagnostic test results at block .

Diagnostic test results stored at block may be stored in one or more formats. According to some embodiments test results may be stored both in a persistent log file on a network access device such as a broadband home router as well as in a TR 069 parameter extension. Test results returned from an agent process may be saved in the persistent log file and in a TR 069 vendor extension parameter. The persistent log file may keep a history of self diagnostics results while the TR 069 vendor extension parameter may keep the latest result instance.

Test start date and time written as mm dd yy HH MM SS SCHKS UPTIME t where mm month dd day yy year HH hour MM min SS second t device uptime .

Test results written as HH MM SS Output Test Log as illustrated in the output examples of the diagnostic tests of blocks and .

At block the method may determine whether one or more corrective actions may be taken. If one or more corrective actions may be taken the method may continue at block . If no corrective actions may be taken the method may end at block .

Whether or not a corrective action may be taken may according to some embodiments be determined by a mapping between a condition and a corrective mappings. Exemplary conditions include the conditions specified as test conditions for blocks and . The following table illustrated default list of exemplary corrective actions. These corrective actions may be re defined using a network access device management system. Redefinition may be based on test results returned e.g. for each condition expression listed the associated corrective action is invoked if the condition expression is FALSE. In addition the list of condition expression may be implicitly joined using the logical OR operation. For example in the exemplary corrective action table below if there are more than one condition expressions returning a FALSE value the corrective action performed may be chosen by identifying the correction action with the highest precedence in the group.

According to an embodiment a definition of corrective actions priority precedence from highest to lowest may be 

Other conditions or rules may be used when applying a corrective action mapping such as the above table. For example if the FactoryReset correction option is enabled the factory reset operation may be applied instead of a reboot operation if and only if the last X number of consecutive self diagnostics operations by the agent resulted in rebooting the network access device as the corrective action. The X number consecutive count may be configurable via a customer premise equipment management system. A default value may be three. If a corrective action is to be performed the method may continue at block .

At block after one or more diagnostics operation are completed the method may determine whether a corrective action is to be performed immediately or scheduled. Scheduled invocation may imply that a corrective procedure is invoked at a pre established time such as defined in a TR 069 parameter configuration for example. Immediate invocation may imply that a corrective procedure may be invoked immediately after the self diagnostics operation has completed. Whether a corrective action is to be performed immediately or scheduled may be specified by one or more parameters a type of corrective action to be performed a user preference or other factors. If a corrective action is scheduled the method may continue at block . If a corrective action is to be performed immediately the method may continue at block .

At block a process agent or module such as module may determine whether the scheduled period has arrived. If the scheduled period has arrived the method may continue at block . If the scheduled period has not arrived the method may wait at block . After a specified wait the method may return to block .

At block the corrective action if enabled via configuration may be invoked. According to some embodiments a corrective action may include providing a user interface as discussed in greater detail with reference to below.

As discussed above in reference to one or more TR 069 Vendor Extension Parameters may be used. Exemplary TR 069 vendor extension parameters which may be used to administer an agent process or module such as module are provided below. Administration of an agent process or module may include activation deactivation scheduling and saving one or more returned results. In the embodiment below X VENDOR may be a generic place holder and may be assigned appropriately by a network access device vendor.

A table of self diagnostic test parameters corrective action parameters and scheduling parameters is provided below according to an embodiment.

Parameter values assigned using a remote network access device management system via a set parameter value operation may be persistent across device reboot operations. These parameter values may revert back to the default values in a factory reset operation. One or more of the test cases may be specified by default to be used by the agent during diagnostics. However a network access device management system may add or remove one or more test case entries as desired.

The parameters defined in the above table may support both active and passive notifications. With passive notification the self diagnostics results upon completion of one or more of the test cases may be sent during the next periodic inform an update from a network access device to a network access device management system . With active notification the self diagnostics results upon completion of one or more of the test cases may be sent immediately via the TR 069 VALUE CHANGE inform method. In addition a GET PARAMETER VALUE operation may be performed by a network access management system to retrieve the results.

According to some embodiments certain errors may have specific logging software objects and parameters associated with them. For example a Video on Demand VOD pixilation issue may have specific TR 069 parameter extensions defined in a module of a network access device. A potential cause may be if a MoCA link transmission or reception rate is below a recommended level. When enabled MoCA network performance may be recorded in a BHR persistence log as well as a TR 069 parameter for troubleshooting analysis when necessary.

According to some embodiments a set of TR 069 vendor extensions LAN MoCA CurrentRate WAN MoCA CurrentRate LAN MoCA THRESHOLD CROSSING WAN MoCA THRESHOLD CROSSING may be implemented to record the MoCA network performance level whenever there is an active Video on Demand session. To better understand the operational behavior of the MoCA network the THRESHOLD CROSSING parameter may record the number of times the MoCA transmission or reception value falls below a recommended THRESHOLD level during a Video on Demand session.

This table below provides an example of an object and associated parameters that may be used to support TR 069 passive notification.

The MoCA network performance level during an active VOD session may be recorded at a maximum rate of 2 entries per hour in the BHR log which may use the following format 

According to some embodiments an agent module or process for diagnostics and corrective actions may be initiated using one or more methods such as for example by internal periodic scheduling or by a support personnel using a network access device management system. In addition a corrective action may be performed by the network access device immediately or at a scheduled time depending on the results returned from the self diagnostics operation. The immediate mode may be initiated via a network access device management system using a set parameter value operation and the assignment of the parameter values Scheduled to False. In this mode the agent may be invoked immediately following the completion of the network access device management system operation. Internal periodic scheduling may imply that the self diagnostics operation may occur repeatedly at a scheduled time e.g. once a day at 2 A.M. .

The agent process or module may be configurable through one or more methods such as for example via a network access device management system or through a configuration file unless additional new test cases are needed. This may allow the flexibility to fine tune the agent s operational behavior while deployed in the field without having to upgrade the network access device firmware.

The self diagnostic agent may run independently of whether a network access device can communicate with a network access device management system. If a diagnostics agent module or process cannot retrieve time from a NTP Network Time Protocol server the agent may perform a self diagnostics test after 5 minutes even if it s using the scheduled mode option. The self diagnostics agent may run independently of whether the network access device can access the NTP server. During the self diagnostics operation the network traffic flow may not be interrupted. During the execution of the self diagnostics operation a vendor defined fault code e.g. 9801 with the description Unable to process request due to self diagnostics test in progress. may be returned for any new incoming TR 069 transaction request. The self diagnostics operation may take less than 30 seconds from start to completion.

The persistent log file may be capable of recording a specified number of consecutive self diagnostics results e.g. 24 . Since the persistent log file may have a static file size the logged entries may be removed using the FIFO first in first out principle.

As illustrated in user interface may contain multiple elements such as error text suggested diagnostic and corrective actions and network access device status . Error text may contain a description of an error associated with a displayed error code. According to some embodiments suggested corrective and diagnostic actions may contain a link button or other user interface control enabling a user to trigger a diagnostic test or a corrective action. For example a link may be provided enabling a user to reboot a network access device. Support contact information such as a phone number an email address or a web address may be provided.

To assist a user a module of a network access device may attempt to self diagnose the issue and present an appropriate help support Web page to assist the customer in the troubleshooting steps i.e. a Web page with the associated Error Code XX if applicable will be displayed to the customer. In addition the Web page may also display a support number if the issue is not resolved by the user and the agent or diagnostic module of the network access device. In the event a user calls the support center the error code may be provided.

Web pages with corresponding error codes may be displayed to the user if the network access device does not receive a response from the ONT Optical Network Terminal Gateway e.g. Juniper ERX or Domain Name Server DNS server. The error codes may be useful to the support agent in the event if the customer calls the support center.

For example an error code display may be Error Code ONT Down . This error code may indicate that a network access device such as a residential gateway has lost physical connection with the ONT. This web page may appear when the user attempts to access a website while there is no physical WAN connection such as for example a WAN Coax or WAN Ethernet connection.

According to one embodiment a network access device may have dual SSIDs Service Set Identifiers a public SSID to provide wireless help and a primary SSID which is secured e.g. using WEP encryption on the network access device . For security reasons devices connected wirelessly via the wireless help SSID may be able only to access local web pages hosted by the network access device for wireless help such as for example the interface displayed in below detailing where to find the primary SSID name and WEP key. As illustrated section may contain a help message such as Important You are connected to the wireless help network and not have full Internet or Router access. Please follow the information below to connect to the main wireless network for full access. Element may provide a picture of a network access device with one or more circles highlights or other indicators showing important features such as the location of a tag containing network access information. Element of may contain an enlarged image of a portion of a wireless network access device showing the detail of that portion e.g. illustrating the location of a WEP KEY and SSID on a tag . Element may contain help information associated with elements and which may explain how to locate default security information and how to reset a network access device to use default security information.

The wireless help option using a public SSID can be disabled or enabled. According to some embodiments wireless help may be disabled or enabled remotely via a TR 069 vendor extension. By default it may be off. An example of a wireless public help parameter is provided below 

According to some embodiments a parameter such as for example a TR 069 vendor extension parameter may be implemented to track the number of times a web page provided by a network access device has been accessed in order to gauge the success of the implementation. This may be retrieved from a remote network access device management system for support analysis.

User troubleshooting web pages may be performed using the HTTP redirect function without having a computer or network access device be rebooted to clear the cached DNS on the computer side. This may be done via the HTTP 302 temporary redirect implementation.

It is further noted that the software described herein may be tangibly embodied in one or more physical media such as but not limited to a compact disc CD a digital versatile disc DVD a floppy disk a hard drive read only memory ROM random access memory RAM as well as other physical media capable of storing software or combinations thereof. Moreover the figures illustrate various components e.g. servers computers etc. separately. The functions described as being performed at various components may be performed at other components and the various components may be combined or separated. Other modifications also may be made.

In the preceding specification various preferred embodiments have been described with references to the accompanying drawings. It will however be evident that various modifications and changes may be made thereto and additional embodiments may be implemented without departing from the broader scope of invention as set forth in the claims that follow. The specification and drawings are accordingly to be regarded in an illustrative rather than restrictive sense.

