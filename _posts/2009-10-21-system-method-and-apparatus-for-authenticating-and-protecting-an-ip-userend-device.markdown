---

title: System, method and apparatus for authenticating and protecting an IP user-end device
abstract: A system, method and apparatus authenticates and protects an Internet Protocol (IP) user-end device by providing a client-based security software resident on the IP user-end device, authenticating the IP user-end device using the client-based security software and a network security node communicably coupled to the IP user-end device, authenticating a user of the IP user-end device whenever a trigger condition occurs using an in-band channel between the client-based security software and the network security node, and protecting the IP user-end device by: (a) screening incoming IP traffic to the IP user-end device using the client-based security software, and (b) detecting an attack or a threat involving the IP user-end device using the network security node.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08503657&OS=08503657&RS=08503657
owner: Avaya Inc.
number: 08503657
owner_city: Basking Ridge
owner_country: US
publication_date: 20091021
---
This patent application is a continuation in part patent application of U.S. patent application Ser. No. 12 028 781 filed on Feb. 8 2008 and entitled System Method and Apparatus for Two Factor Authentication in VoIP Networks which is a non provisional application of U.S. provisional patent application 60 888 765 filed on Feb. 8 2007 and entitled System Method and Apparatus for Two Factor Authentication in VoIP Networks which is hereby incorporated by reference in its entirety.

The present invention relates generally to the field of telecommunications and more particularly to a system method and apparatus for authenticating and protecting an Internet Protocol IP user end device.

The combination of device and user authentication is called Two Factor authentication. Enterprises already have this mechanism in place for remote users connecting through computers. RSA SecurID or similar mechanism is the de facto way of enabling two factor authentication. Two Factor authentication requires a user to key in a special pass phrase or key that is displayed on a Secure Token. This token is typically issued by the company and is carried by the employee all the time. The token is linked back to token authentication server in the company. When the employee wants to login to corporate services he she must supply the pass phrase or key which changes periodically to ensure that only the employee is requesting the service. The supplied input data is validated against the authentication server and if the match occurs the employee is granted the service. RSA tokens and RSA server are widely deployed two factor authentication mechanisms in corporations.

This above mentioned technique works well for computer terminals as there are client applications built to accept the two factor authentication. There is however no client or user interface to allow two factor authentication on Internet Protocol IP user end devices. Unlike traditional phones that are always tied to a physical wire connected to PBX Switch the new breed of IP user end devices are IP enabled and thus provide portability and mobility. For example an employee can carry an IP user end device from his work and plug it into Ethernet connector at home and can access an entity s network. This flexibility enables businesses or other entities to deploy these phones to tele workers road warriors consultants partners and other. On the other hand it makes these entities vulnerable to theft attacks and abuse.

Computers connected to an IP network are open to many forms of attacks and threats such as DoS DDoS floods fuzzing malformed messages reconnaissance attacks spoofing attacks MIM attacks stealth call attacks rogue media anomalous behavior and or SPAM. Similarly IP user end devices are vulnerable to these same types of attacks and threats. As a result there is a need for a system method and apparatus for authenticating and protecting an IP user end device.

The present invention when applied in conjunction with deeper security threat mitigation creates a highly secure telephony that can be provided anywhere outside the corporation. As a result entities can realize business continuity and the benefits of pervasive communications. The two factor authentication must be carried out in a secure channel between the IP user end device and the entity as the IP user end device is typically connected to the Internet. In addition the voice conversation must be encrypted for privacy. With new IP user end device terminals and soft phones this is typically achieved through encrypted transport. The present invention leverages the same control messages and voice prompts used for setting up calls to the phone to provide two factor authentication. Thus an out of band channel is necessary to complete two factor authentication. Moreover the present invention protects the IP user end device by screening incoming IP traffic and detecting attacks or threat involving the IP user end device.

The present invention provides a method for authenticating and protecting an Internet Protocol IP user end device by providing a client based security software resident on the IP user end device authenticating the IP user end device using the client based security software and a network security node communicably coupled to the IP user end device authenticating a user of the IP user end device whenever a trigger condition occurs using an in band channel between the client based security software and the network security node and protecting the IP user end device by a screening incoming IP traffic to the IP user end device using the client based security software and b detecting an attack or a threat involving the IP user end device using the network security node. Note that this process can be implemented using a computer readable medium executed by the processors wherein the steps are executed by one or more code segments.

In addition the present invention provides an apparatus for authenticating and protecting an IP user end device that includes a communications interface a memory and a processor communicably coupled to the communications interface and the memory. The processor is configured to run a client based security software resident on the IP user end device. The client based security software and a network security node communicably coupled to the IP user end device a authenticate the IP user end device and b authenticate a user of the IP user end device whenever a trigger condition occurs using an in band channel between the client based security software and the network security node. The client based security software protects the IP user end device by screening incoming IP traffic to the IP user end device. The network security node protects the IP user end device by detecting an attack or a threat involving the IP user end device.

The present invention also provides a system that includes one or more IP user end devices a network security node and an IP network communicably coupling the one or more IP user end devices to the network security node. Each IP end user device includes a first communications interface a first memory and a first processor communicably coupled to the first communications interface and the first memory wherein the first processor is configured to run a client based security software resident on the IP user end device. The network security node includes a second communications interface a second memory and a second processor communicably coupled to the second communications interface and the second memory. The client based security software and the network security node a authenticate the IP user end device and b authenticate a user of the IP user end device whenever a trigger condition occurs using an in band channel between the client based security software and the network security node. The client based security software protects the IP user end device by screening incoming IP traffic to the IP user end device. The network security node protects the IP user end device by detecting an attack or a threat involving the IP user end device.

While the making and using of various embodiments of the present invention are discussed in detail below it should be appreciated that the present invention provides many applicable inventive concepts that can be embodied in a wide variety of specific contexts. The specific embodiments discussed herein are merely illustrative of specific ways to make and use the invention and do not delimit the scope of the invention. The discussion herein relates primarily to Voice over Internet Protocol IP technology VoIP but it will be understood that the concepts of the present invention are applicable to any Voice over IP application or Unified Communication UC application such as Video calls Presence Instant Messaging or any communication application that runs over IP.

The present invention when applied in conjunction with deeper security threat mitigation creates a highly secure telephony that can be provided anywhere outside the corporation. As a result entities can realize business continuity and the benefits of pervasive communications. The two factor authentication must be carried out in a secure channel between the IP user end device and the entity as the IP user end device is typically connected to the Internet. In addition the voice conversation must be encrypted for privacy. With new IP user end device terminals and soft phones this is typically achieved through encrypted transport. The present invention leverages the same control messages and voice prompts used for setting up calls to the phone to provide two factor authentication. Thus an out of band channel is necessary to complete two factor authentication. Moreover the present invention protects the IP user end device by screening incoming IP traffic and detecting attacks or threat involving the IP user end device.

Now referring to two network configurations in accordance with the present invention are illustrated. represents the present invention in Internet Protocol Communication Security IPCS demilitarized zone DMZ mode . represents the present invention in an IPCS in a tunnel mode . In either case the present invention provides infrastructure and endpoint protection. The two factor authentication for remote users must be provided in the DMZ of enterprise. The security server in the DMZ must be able to handle near end and far end firewall issues. The secrurity server must a provide authentication connectivity to the authentication server not shown e.g. SecurID server or other suitable authentication server b terminate and inspect signaling and media and c be a secure box. The security server IPCS is communicably coupled to various IP user end devices and call servers via an Intranet or other IP based communications network internal private or secure . Note that the security server in is communicably coupled to another security server which is communicably coupled to the call servers to establish a secure tunnel through the Intranet .

The security server can be communicably coupled to various external IP user end devices via the Internet or other IP based communications network external less secure or public . In addition the security server is protected by an internal firewall and an external firewall . Similarly external IP user end devices are protected by a firewall . The security server includes a communications interface a memory and a processor communicably coupled to the communications interface and the memory. The processor is configured to perform the authentication processes described below. The IP user end device can be a dual mode phone a wireless phone a soft phone a web phone a personal data assistant or other IP based telecommunications device that does not run a client based authentication application during the authentication process described herein. Note that IP Private Branch Exchange PBX systems are not built to address the above requirements.

Referring now to a flow chart illustrating a two factor authentication process in accordance with one embodiment of the present invention is shown. The authentication process begins in block . If the IP user end device is authorized as determined in decision block and a trigger condition occurs as determined in decision block the security server initiates a call to the IP user end device in block . A white list or other type of commonly used device authentication can be used to authenticate the IP user end device. The trigger condition can be a time based condition an event based condition or a combination thereof. The time based condition can be a requirement to authenticate the IP user end device daily weekly bi weekly monthly quarterly yearly or some other specified time. The event based condition can be receiving a registration request from the IP user end device a switch over to standby a challenge from an authentication manager a request for a specified service or a request for access to a specified device. If however the IP user end device is not authorized as determined in decision block or the trigger condition is not met as determined in decision block the process ends in block .

After the call is initiated the secure server sends a request for the user s passcode to the IP user end device in block . The request for the passcode may include one or more display prompts one or more voice prompts or a combination thereof. The passcode can be a personal identification code a token code a physical key an electronic key a biometric identifier a magnetic signature an electronic signature one or more numbers one or more symbols one or more alphabet characters one or more keystrokes or a combination thereof. If the passcode is valid as determined in decision block the call is terminated in block and the process ends in block . If however the passcode is not valid the security server sends a message to the IP user end device that will disable the IP user end device in block . Thereafter the call is terminated in block and the process ends in block . After the authentication process is successfully completed the IP user end device will be allowed to access resources or connect to devices protected by the security server . Note that this process can be implemented using a computer readable medium executed by the secure server wherein the steps are executed by one or more code segments.

Now referring to a flow chart illustrating a two factor authentication process in accordance with another embodiment of the present invention is shown. The authentication process begins in block . If the IP user end device is not authorized as determined in decision block a security incidence is generated in block and the process ends in block . A white list or other type of commonly used device authentication can be used to authenticate the IP user end device. If however the IP user end device is authorized but a trigger condition does not occur or is not satisfied as determined in decision block the process ends in block . The trigger condition can be a time based condition an event based condition or a combination thereof. The time based condition can be a requirement to authenticate the IP user end device daily weekly bi weekly monthly quarterly yearly or some other specified time. The event based condition can be receiving a registration request from the IP user end device a switch over to standby a challenge from an authentication manager a request for a specified service or a request for access to a specified device If however the trigger condition is satisfied the security server initiates a call to the IP user end device in block .

After the call is initiated the secure server sends a request for the user s passcode to the IP user end device in block . The request for the passcode may include one or more display prompts one or more voice prompts or a combination thereof. The passcode can be a personal identification code a token code a physical key an electronic key a biometric identifier a magnetic signature an electronic signature one or more numbers one or more symbols one or more alphabet characters one or more keystrokes or a combination thereof. If the call is not answered as determined in decision block and request retries are allowed as determined in decision block the process waits in block and a new request is sent in block . If however retries are not allowed the call is terminated in block and the process ends in block . If however the call is answered as determined in decision block and the passcode is valid as determined in decision block the call is terminated in block and the process ends in block . If however the passcode is not valid and the maximum number of attempts to enter the passcode have not been exceeded as determined in decision block the user may try to enter the correct passcode. If however the maximum number of attempts has been made the security server sends a message to the IP user end device that will disable the IP user end device in block the user is notified that the IP user end device has been disabled in block . The notification may include one or more display messages audio messages voice mail messages electronic mail messages text messages or a combination thereof. Thereafter a security incidence is generated in block the call is terminated in block and the process ends in block . After the authentication process is successfully completed the IP user end device will be allowed to access resources or connect to devices protected by the security server .

The security server can block any messages from the IP user end device until the IP user end device and the user are authenticated. In addition the security server can initiate another call to the IP user end device and send another request for a passcode to the IP user end device after the IP user end device has been disabled for a specified period of time. The security server can delay registration of the IP user end device with a call manager until the IP user end device and the user are authenticated. Moreover the IP user end device can be enabled after the IP user end device has been disabled by using a clearing process executed by the user a technician a security person a supervisor or a combination thereof. Note that this process can be implemented using a computer readable medium executed by the secure server wherein the steps are executed by one or more code segments.

Referring now to a RSA SecurID authentication network in accordance with one embodiment of the present invention is illustrated. The system includes a security server IPCS communicably coupled to one or more protected resources devices or phones and an authentication server . The security server is also communicably coupled to an IP user end device . The user of the IP user end device has a RSA SecurID that provides a PIN Token Number or RSA SecurID with pinpad that provides a Pass Code. The communication protocol used between the IP user end device and the security server is SIP Skinny over TLS and SRTP. The communication protocol used between the security server and the protected phones is SIP Skinny over TCP. The communication protocol used between the security server and the authentication server RSA Authentication Manager RSA Radius Server is PAP over RADIUS EAP GTC over RADIUS and or EAP POTP over RADIUS. The security server can request authentication of the received passcode from the authentication server .

Now referring to a call flow diagram in accordance with another embodiment of the present invention is illustrated. The solution is described using the SKINNY protocol but it can also apply to other protocols that are used to setup VoIP Voice over IP calls.

Referring now to a screen shot of a virtual IP configuration table in accordance with one embodiment of the present invention is illustrated. For example the following rules can be used 

Now referring to a state machine diagram in accordance with one embodiment of the present invention is illustrated.

Referring now to a network configuration in accordance with another embodiment of the present invention is shown. The client based security software e.g. Sipera UC Sec Client application or plug in is installed on the IP user end device e.g. a dual mode phone a wireless phone a soft phone a web phone a personal data assistant a computer or other IP based telecommunications device . The network security node e.g. Sipera UC Sec network node is deployed in the core network where it communicates with the client based security software on the IP user end device via an access network and or an open IP network . The network security node is deployed in the DMZ of the associated Call Server and Media Gateway and will service any remote IP user end device that has the client based security software and is connecting to that DMZ. The Call Server and Media Gateway communicate with other devices or services within the core network e.g. Directory Services Authentication Authorization and Accounting AAA Applications etc. . All VoIP calls for the IP user end device operating remotely to the Enterprise will go through the network security node deployed in the DMZ. A separate network security node not shown can also be deployed upon customer need and request inside the Enterprise to serve internal VoIP devices that have the client based security software . The network security node also communicates with the Back office Network Operation Center e.g. Sipera Central EMS in the operation network via an out of band network . The operation network typically also includes DHCP SNMP Syslog and Chrg . The client based security software can apply to mobile phone devices with a Smart card a Flex SIM card and user PC devices that have VoIP Soft client. The client based security software does not apply to VoIP Hard phones .

Now referring to a block diagram of a system for authenticating and protecting an IP user end device in accordance with another embodiment of the present invention is shown. The system includes one or more IP user end devices communicably coupled to a network security node via an IP network . The network security node is communicably coupled to a call server and a media gateway via a core network and a security management center EMS via an out of bound network . Each IP end user device includes a first communications interface a first memory and a first processor communicably coupled to the first communications interface and the first memory wherein the first processor is configured to run a client based security software resident on the IP user end device . The IP user end device can be a dual mode phone a wireless phone a soft phone a web phone a personal data assistant a computer or other IP based telecommunications device.

The IP user end device runs an IP based application comprising a Voice over IP VoIP application an Instant Messaging IM application a Short Message Service SMS application a video application a presence application or a Unified Communication UC application.

The network security node includes a second communications interface a second memory and a second processor communicably coupled to the second communications interface and the second memory wherein the second processor is configured to run a network node security software resident on the network security node . Other devices may be communicably coupled to the network security node such as an authentication server or a call manager. The client based security software and the network security node a authenticate the IP user end device and b authenticate a user of the IP user end device whenever a trigger condition occurs using an in band channel between the client based security software and the network security node . The client based security software protects the IP user end device by screening incoming IP traffic to the IP user end device . The network security node protects the IP user end device by detecting an attack or a threat involving the IP user end device . Various methods for authenticating and protecting the IP user end device will be described in more detail with respect to .

Referring now to a flow chart of a method for authenticating and protecting an IP user end device in accordance with another embodiment of the present invention is shown. A client based security software resident on the IP user end device is provided in block . The IP user end device is authenticated using the client based security software and a network security node communicably coupled to the IP user end device in block . The IP user end device can be authenticated using a smart card a SIM card a Flexi SIM card a security certificate stored on the smart card or the SIM card or on the UP user end device one or more control messages one or more voice prompts a white list or a combination thereof. If a trigger condition occurs as determined in decision block a user of the IP user end device is authenticated using an in band channel between the client based security software and the network security node in block . The trigger condition can be a time based condition an event based condition or a combination thereof.

The time based condition can be a requirement to authenticate the user of the IP user end device daily weekly bi weekly monthly quarterly yearly or some other specified time. The event based condition can be receiving a registration request from the IP user end device a switch over to standby a challenge from an authentication manager a request for a specified service a request for access to a specified device or a failure of a fingerprint match. The fingerprint match may include a change in a format a value or an order of information in a header wherein the header information include via max forwards contact user agent allow proxy require supported route Cseq session expires allow events content length SDP bandwidth SDP silence suppression SDP connection SDP originator or SDP payload.

After the user is authenticated in block or if the trigger condition has not occurred as determined in decision block the IP user end device is protected by screening incoming IP traffic to the IP user end device using the client based security software in block and detecting an attack or a threat involving the IP user end device using the network security node in block . The attack or the threat may include DoS DDoS floods fuzzing malformed messages reconnaissance attacks spoofing attacks MIM attacks stealth call attacks rogue media anomalous behavior and or SPAM. The process repeats the steps of detecting the trigger condition and protecting the IP user end device as needed to authenticate and protect the IP user end device . The step of authenticating the IP user end device can be repeated. Note that this process can be implemented using a computer readable medium executed by the processors wherein the steps are executed by one or more code segments.

Now referring to a flow chart of a method for authenticating and protecting an IP user end device in accordance with another embodiment of the present invention is shown. A client based security software resident on the IP user end device is provided in block . If the IP user end device is not authorized as determined in decision block a security incidence is generated in block and the process screens incoming traffic in block . A white list or other type of commonly used device authentication can be used to authenticate the IP user end device. If however the IP user end device is authorized but a trigger condition does not occur or is not satisfied as determined in decision block the process screens incoming traffic in block . The trigger condition can be a time based condition an event based condition or a combination thereof. The time based condition can be a requirement to authenticate the IP user end device daily weekly bi weekly monthly quarterly yearly or some other specified time. The event based condition can be receiving a registration request from the IP user end device a switch over to standby a challenge from an authentication manager a request for a specified service or a request for access to a specified device. If however the trigger condition is satisfied the network security node initiates a call to the IP user end device in block .

After the call is initiated the secure server sends a request for the user s passcode to the IP user end device in block . The request for the passcode may include one or more display prompts one or more voice prompts or a combination thereof. The passcode can be a personal identification code a token code a physical key an electronic key a biometric identifier a magnetic signature an electronic signature one or more numbers one or more symbols one or more alphabet characters one or more keystrokes or a combination thereof. If the call is not answered as determined in decision block and request retries are allowed as determined in decision block the process waits in block and a new request is sent in block . If however retries are not allowed the call is terminated in block and the process screens incoming traffic in block . If however the call is answered as determined in decision block and the passcode is valid as determined in decision block the call is terminated in block and the process screens incoming traffic in block . If however the passcode is not valid and the maximum number of attempts to enter the passcode have not been exceeded as determined in decision block the user may try to enter the correct passcode. If however the maximum number of attempts has been made the network security node sends a message to the IP user end device that will disable the IP user end device or reject the authentication request in block the user is notified that the IP user end device has been disabled or the authentication request was rejected in block . The notification may include one or more display messages audio messages voice mail messages electronic mail messages text messages or a combination thereof. Thereafter a security incidence is generated in block the call is terminated in block and the process screens incoming traffic in block . After the IP user end device is authenticated the IP user end device will be allowed to access resources or connect to devices protected by the network security node .

The network security node can block any messages from the IP user end device until the IP user end device and the user are authenticated. In addition the network security node can initiate another call to the IP user end device and send another request for a passcode to the IP user end device after the IP user end device has been disabled for a specified period of time or after the specified period of time since the authentication request from the IP user device was rejected. The network security node can delay registration of the IP user end device with a call manager until the IP user end device and the user are authenticated. Moreover the IP user end device can be enabled after the IP user end device has been disabled by using a clearing process executed by the user a technician a security person a supervisor or a combination thereof.

After the user is authenticated in block or if the trigger condition has not occurred as determined in decision block the IP user end device is protected by screening incoming IP traffic to the IP user end device using the client based security software in block and detecting an attack or a threat involving the IP user end device using the network security node in block . The process repeats the steps of detecting the trigger condition and protecting the IP user end device as needed to authenticate and protect the IP user end device .

Additional steps may include receiving a request for a configuration file from the IP user end device retrieving the configuration file sending the configuration file to the IP user end device requesting the configuration file from a call manager receiving the requested configuration file and saving the requested configuration file and sending a reset message to the IP user end device whenever the requested configuration file is different than the configuration file. In addition the following steps may be performed receiving another request for the configuration file in response to the reset message and sending the requested configuration file to the IP user end device . Note that the client based security software can split one or more resources of the IP user end device into one or more logical access controlled areas. Note that this process can be implemented using a computer readable medium executed by the processors wherein the steps are executed by one or more code segments.

The User Fingerprint composition is defined during configuration and can be composed of a combination or all of the following information elements 

It will be understood by those of skill in the art that information and signals may be represented using any of a variety of different technologies and techniques e.g. data instructions commands information signals bits symbols and chips may be represented by voltages currents electromagnetic waves magnetic fields or particles optical fields or particles or any combination thereof . Likewise the various illustrative logical blocks modules circuits and algorithm steps described herein may be implemented as electronic hardware computer software or combinations of both depending on the application and functionality. Moreover the various logical blocks modules and circuits described herein may be implemented or performed with a general purpose processor e.g. microprocessor conventional processor controller microcontroller state machine or combination of computing devices a digital signal processor DSP an application specific integrated circuit ASIC a field programmable gate array FPGA or other programmable logic device discrete gate or transistor logic discrete hardware components or any combination thereof designed to perform the functions described herein. Similarly steps of a method or process described herein may be embodied directly in hardware in a software module executed by a processor or in a combination of the two. A software module may reside in RAM memory flash memory ROM memory EPROM memory EEPROM memory registers hard disk a removable disk a CD ROM or any other form of storage medium known in the art. Although preferred embodiments of the present invention have been described in detail it will be understood by those skilled in the art that various modifications can be made therein without departing from the spirit and scope of the invention as set forth in the appended claims.

