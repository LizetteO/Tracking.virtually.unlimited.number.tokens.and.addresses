---

title: Quantum repeater and system and method for creating extended entanglements
abstract: An iterative method is provided for progressively building an end-to-end entanglement between qubits in first and second end nodes () of a chain of nodes whose intermediate nodes () are quantum repeaters. At each iteration, a current operative repeater () of the chain merges an entanglement existing between qubits in the first end node () and the operative repeater, with a local entanglement formed between qubits in the operative repeater and its neighbor node towards the second end node (). For the first iteration, the operative repeater is the neighbor of the first end node (); thereafter, for each new iteration the operative repeater shifts one node further along the chain toward the second end node (). A quantum repeater adapted for implementing this method is also provided.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08781334&OS=08781334&RS=08781334
owner: 
number: 08781334
owner_city: 
owner_country: 
publication_date: 20091026
---
The present invention relates to quantum repeaters and to systems and methods for creating extended entanglements.

In quantum information systems information is held in the state of a quantum system typically this will be a two level quantum system providing for a unit of quantum information called a quantum bit or qubit . Unlike classical digital states which are discrete a qubit is not restricted to discrete states but can be in a superposition of two states at any given time.

Any two level quantum system can be used for a qubit and several physical implementations have been realized including ones based on the polarization states of single photons electron spin nuclear spin and the coherent state of light.

Quantum network connections provide for the communication of quantum information between remote end points. Potential uses of such connections include the networking of quantum computers and quantum key distribution QKD in which a quantum channel and an authenticated but not necessarily secret classical channel with integrity are used to create shared secret random classical bits. Generally the processes used to convey the quantum information over a quantum network connection provide degraded performance as the transmission distance increases thereby placing an upper limit between end points. Since in general it is not possible to copy a quantum state the separation of endpoints cannot be increased by employing repeaters in the classical sense.

One way of transferring quantum information between two spaced locations uses the technique known as quantum teleportation . This makes uses of two entangled qubits known as a Bell pair situated at respective ones of the spaced locations the term entanglement is also used in the present specification to refer to two entangled qubits The creation of such a distributed Bell pair is generally mediated by photons sent over an optical channel for example an optical waveguide such as optical fibre . Although this process is distance limited where a respective qubit from two separate Bell Pairs are co located it is possible to combine or merge the Bell pairs by a local quantum operation effected between the co located qubits. This process known as entanglement swapping results in an entanglement between the two non co located qubits of the Bell pairs while the co located qubits cease to be entangled at all.

The device hosting the co located qubits and which performs the local quantum operation to merge the Bell pairs is called a quantum repeater . The basic role of a quantum repeater is to create a respective Bell pair with each of two neighbouring spaced nodes and then to merge the Bell pairs. By chaining multiple quantum repeaters an end to end entanglement can be created between end points separated by any distance thereby permitting the transfer of quantum information between arbitrarily spaced end points.

It may be noted that while QKD does not directly require entangled states the creation of long distance Bell pairs through the use of quantum repeaters facilitates long distance QKD. Furthermore most other applications of distributed quantum computation will use distributed Bell pairs.

The present invention is concerned with the creation of entanglement between spaced qubits and with the form management and interaction of quantum repeaters to facilitate the creation of entanglements between remote end points.

According to the present invention there is provided a quantum repeater as set out in the accompanying claim . The quantum repeater is usable as a intermediate node in a chain of nodes to permit an end to end entanglement between qubits in end nodes of the chain of nodes

Also provided is a method of creating an end to end entanglement between qubits in end nodes of a chain of nodes whose intermediate nodes are quantum repeaters the method being as set out in accompanying claim .

Considering in more detail a light field emitted by an emitter snapshot a is passed through the physical qubit qb snapshot b which is in a prepared non classical state for example 0 1 typically the physical qubit implementation is as electron spin the electron being set into a predetermined state immediately prior to passage of the light field. The light field and qubit qb interact with the light field effectively capturing the quantum state of the qubit qb. The light field then travels down the optical fibre snapshots c and d and interacts with qubit qb snapshot e before being measured at detector snapshot f if successful this results in the transfer of the quantum state of qubit qb to qubit qb entangling these qubits in this entanglement is represented by double headed arrowed arc this form of representation being used generally throughout the drawings to depict entanglements . The properties of the light field measured by detector enable a determination to be made as whether or not the entanglement operation was successful. The success or failure of the entanglement operation is then passed back to the qb end of the fibre in a classical non quantum message snapshot g . This message can be very simple in form the presence or absence of a single pulse and as used herein the term message is to be understood to encompass both such simple forms as well as structured messages of any degree of complexity subject to processing time constraints in embodiments where the message needs to identify a particular qubit amongst several as well as the success or failure of an entanglement operation the message may still take the form of the presence or absence of a single pulse with the timing of the latter being used to identify the qubit concerned. Where there is a need to transmit information about the success failure of the entanglement operation or to identify an involved qubit back to the qb end of the fibre the overall elapsed time for the entanglement operation is at least the round trip propagation time along the fibre even where the entanglement operation is successful.

An entanglement operation can be performed to entangle qubits qb and qb whether or not qb is already entangled with another qubit in the case of qb already being entangled with another qubit qbj when an entanglement operation is performed between qb and qb this results in the states of all three qubits qb qb and qbj becoming entangled .

The properties of the light field measured by detector also enable a determination to be made in the case of a successful entanglement operation as to whether the entangled states of the qb and qb are correlated or anti correlated this generally being referred to as the parity of the entanglement even and odd parity respectively corresponding to correlated and anti correlated qubit states . It is normally important to know the parity of an entanglement when subsequently using it as a result either parity information must be stored or steps taken to ensure that the parity always ends up the same for example if an odd parity is determined the state of qb can be flipped to produce an even parity whereby the parity of the entanglement between qb and qb always ends up even .

In fact the relative parity of two entangled qubits is a two dimensional quantity often called the generalized parity and comprising both a qubit parity value and a conjugate qubit parity value. For a simple entanglement operation as depicted in the conjugate qubit parity value information is effectively even parity and need not be measured. Generalized parity requires two classical bits to represent it. In certain applications such as QKD knowledge of the conjugate qubit parity value information may not be required. Hereinafter except where specific reference is being made to one of the components of generalized parity that is to the qubit parity value or the conjugate qubit parity value reference to parity is to be understood to mean generalized parity but with the understanding that in appropriate cases the conjugate qubit parity value information can be omitted.

As already indicated the qubits qb and qb are typically physically implemented as electron spin. However the practical lifetime of quantum information stored in this way is very short of the order of 10seconds cumulative and therefore generally immediately following the interaction of the light field with qb and qb the quantum state of the qubit concerned is transferred to nuclear spin which has a much longer useful lifetime typically of the order of a second cumulatively . The quantum state can be later transferred back to electron spin for a subsequent light field interaction such as to perform a merge of two entanglements described below .

Another practical feature worthy of note is that the physical qubits qb and qb are generally kept shuttered from light except for the passage of light field . To facilitate this at the qb end of the fibre and to trigger setting the qubit into a prepared state immediately prior to its interaction with light field the light field can be preceded by a herald light pulse this light pulse is detected at the qb end of the fibre and used to trigger priming of the qubit qb and then its un shuttering for interaction with the light field . Other ways of triggering these tasks are alternatively possible.

The relationship between the probability of successfully creating a Bell pair the distance between qubits involved and the fidelity of the created pair is complex. By way of example for one particular implementation using a light field in the form of a laser pulse of many photons. Bell pairs are created with fidelities of 0.77 or 0.638 for 10 km and 20 km distances respectively between qubits and the creation succeeds on thirty eight to forty percent of the attempts. The main point is that the entanglement operation depicted in is distance limited for simplicity in the following a probability of success of 0.25 is assumed at a distance of 10 km.

An assembly of components for carrying out an entanglement operation is herein referred to as an entanglement creation subsystem and may be implemented locally within a piece of apparatus or between remotely located pieces of apparatus generally referred to as nodes . depicts an example of the latter case where two nodes and are optically coupled by an optical fibre optical fibres such as the fibre providing a node to node link are herein called local link fibres. The nodes of include components for implementing respective qubits qb and qb for ease of understanding the same qubit designations are used in as in . The qubits qb and qb together with an emitter associated with qb a detector associated with qb the local link fibre and entanglement operation control logic in each node not shown form an entanglement creation subsystem for creating an entanglement between qubits qb and qb. An entanglement of this sort created by a light field passed across a local link fibre between nodes is herein called a local link entanglement or LLE the node spanning entanglement creation subsystem is correspondingly called an LLE creation subsystem .

An entanglement such as created by a FIG. LA entanglement operation can be extended to create a new entanglement involving one of the originally entangled qubits and a new qubit the latter typically being located at a greater distance from the involved originally entangled qubit than the other originally entangled qubit. illustrate two ways of extending an initial entanglement between qubits qb and qb referenced to form an entanglement between qubit qb and another qubit both ways involve the passing of light fields through various qubits followed by measurement of the light fields but for simplicity the light fields themselves and the optical fibres typically used to channel them have been omitted from .

After the X measurement has been made to eliminate qb from entanglement an extended entanglement is left between qb and qb this extended entanglement is depicted as medium thick are in snapshot d of .

The parity of the extended entanglement is a combination of the parities of the entanglements and and a conjugate qubit parity value determined from the X measurement in the above example the X measurement gives either a 1 or 1 result this sign is the conjugate qubit parity value . Where qubit parity value information and conjugate qubit parity value information are each represented by binary values 0 and 1 for even and odd parity respectively the qubit parity value information and conjugate qubit parity value information of the extended entanglement are respective XOR Exclusive OR combinations of the corresponding component parities.

It may be noted that a functionally equivalent result to the elongate operation can be obtained by first entangling qb with qb by means of an entanglement operation in which the mediating light field passes first through qb and then removing qb from entanglement by effecting an X measurement on it. In the present specification for linguistic clarity reference to an elongate operation with its integral X measurement only encompasses the case where the initial entanglement performed as part of the elongate operation is effected by a light field first passing through a qubit of the entanglement being extended the above described functional equivalent to the elongate operation is treated as being separate entanglement and X measurement operations.

Where the objective is to set up an entanglement between two qubits spaced by a substantial distance the elongate operation described above with reference to is not that useful by itself. This is because should the component entanglement operation see a of fail then the pre existing entanglement that is being extended entanglement in will be destroyed. In effect the probability of successfully creating the extended entanglement is the product of the success probabilities of the entanglement operations used to create entanglements and . As already noted the probability of a successful entanglement operation is distance related so the chances of successfully creating an entanglement over long distances using only elongate operations to successively extend an initial entanglement are poor. The same problem exists with the described functional equivalent of the elongate operation.

A better approach is to use the merge operation illustrated in to knit together independently created entanglements that individually span substantial distances this approach effectively decouples the success probabilities associated with the individual entanglements as a failure of one attempt to create such an entanglement does not destroy the other entanglements. Of course to be useful the merge operation used to join the individual entanglements must itself be highly reliable and this is achieved by carrying it out over extremely short distances.

The measurements made as part of the merge operation provide both an indication of the success or otherwise of the merge and an indication of the generalized parity of the merge operation. For example the first merge operation process may measure a qubit parity value and the second merge operation process the conjugate qubit parity value. In this case the second process can be effected either as a single X measurement using a light field passed through both qubits qb and qb in which case the light field has a different value to that used in the first process e.g. 0 1 as opposed to 0 1 or as individual X measurements subsequently combined made individually on qb and qb the latter approach being depicted in . The parity of the extended entanglement will be a combination of the parities of the entanglements and and the parity of the merge operation. As before where qubit parity value information and conjugate qubit parity value information are each represented by binary values 0 and 1 for even and odd parity respectively the qubit parity value information and conjugate qubit parity value information of the extended entanglement are respective XOR Exclusive OR combinations of the corresponding component parities.

Information about the success or otherwise of the merge operation is passed in classical messages to the end qubit locations as otherwise these locations do not know whether the qubits qb qb are entangled alternatively since the failure probability of a merge operation is normally very low success can be assumed and no success failure message sent in this case it will be up to applications consuming the extended entanglement to detect and compensate for merge failure leading to absence of entanglement. As the parity of the extended entanglement will normally need to be known to make use of the entangled qubits parity information needed to determine the parity of the extended entanglement is also passed on to one or other of the end qubit locations.

It will be appreciated that the form of merge operation described above with respect to is effectively an elongate operation carried out over a very short distance between qb and qb to extend entanglement together with an X measurement on qb to remove it from entanglement qb having been removed from entanglement by the X measurement performed as part of the elongate operation . Of course unlike the example elongate operation where the qubit qb to which the entanglement is being extended is not itself already entangled the equivalent qubit qb in is already involved in a second entanglement however as already noted an elongate operation encompasses this possibility.

As already noted the merge operation is a local operation between qubits qb and qb in that is effected over a very short distance and thus has a high probability of success. A merge operation takes of the order of 10secs.

In practice when seeking to create an extended entanglement between two qubits which are located in respective end nodes separated by a distance greater than that over which a basic entanglement operation can be employed with any reasonable probability of success one or more intermediate nodes called quantum repeaters are used to merge basic entanglements that together span the distance between the end nodes. Each quantum repeater node effectively implements a merge operation on a local pair of qubits that correspond to the qubits qb and qb of and are involved in respective entanglements with qubits in other nodes. depicts such a quantum repeater node forming one node in a chain sequential series of nodes terminated by left and right end nodes and that respectively accommodate the qubits qb qb it is desired to entangle but which are too far apart to entangle directly using an entanglement operation . In the present example the chain of nodes comprises three nodes with the left and right end nodes also forming the left and right neighbour nodes of the quantum repeater . The quantum repeater is connected to its left and right neighbour nodes by left and right local link optical fibres L and R respectively. It is to be noted that the terms left and right as used throughout the present specification are simply to be understood as convenient labels for distinguishing opposite senses directions along ends of and the like of the chain of nodes that includes a quantum repeater.

The quantum repeater effectively comprises left and right portions or sides labeled L and R in each comprising a respective qubit qb qb for ease of understanding the same qubit designation are used in as in . The qubit qb of the left neighbour node and qb of the quantum repeater node are part of a LLE creation subsystem formed between these nodes and operative to create a left LLE shown as a dashed arrowed are in between qb and qb. Similarly the qubit qb of the right neighbour node and qb of the quantum repeater node are part of a LLE creation subsystem formed between these nodes and operative to create a right LLE between qb and q.

It may be noted that the direction of travel left to right or right to left of the light field used to set up each LLE is not critical whereby the disposition of the associated emitters and detectors can be set as desired. For example the light fields involved in creating LLEs and could both be sent out from the quantum repeater meaning that the emitters are disposed in the quantum repeater and the detectors in the left and right neighbour nodes . However to facilitate chaining of quantum repeaters of the same form it is convenient if the light fields all travel in the same direction along the chain of nodes for example the light fields can be arranged all to travel from left to right in which case the left side L of the quantum repeater will include the detector for creating the left LLE and the right side R will include the emitter for creating the right LLE . For simplicity and unless otherwise stated a left to right direction of travel of the light field between the nodes will be assumed hereinafter unless otherwise stated the accompanying claims are not however to be interpreted as restricted to any particular direction of travel of the light field or to the direction of travel being the same across different links unless so stated or implicitly required.

In operation of the quantum repeater after creation in any order of the left and right LLEs and a local merge operation involving the qubits qb and qb is effected thereby to merge the left LLE and the right LLE and form extended entanglement between the qubits qb and qb in the end nodes and respectively.

If required information about the success or otherwise of the merge operation and about parity is passed in classical messages from the quantum repeater to the nodes .

Regarding the parity information where the parity of the local link entanglements has been standardized by qubit state flipping as required only the merge parity information needs to be passed on by the quantum repeater and either node or can make use of this information. However where LLE parity information has simply been stored then the quantum repeater needs to pass on whatever parity information it possesses for example where the parities of the left and right LLEs are respectively known by the quantum repeater and the node the quantum repeater needs to pass on to node both the parity information on LLE and the merge parity information typically after combining the two. Node can now determine the parity of the extended entanglement by combining the parity information it receives from the quantum repeater with the parity information it already knows about LLE .

From the foregoing it can be seen that although the merge operation itself is very rapid of the order of 10seconds there is generally a delay corresponding to the message propagation time to the furthest one of the nodes before the extended entanglement is usefully available to these nodes.

By chaining together multiple quantum repeaters it is possible to create an extended entanglement between any arbitrarily spaced pair of nodes. illustrates this for a chain of N nodes comprising left and right end nodes and respectively and a series of N 2 quantum repeaters each labeled QR and diagrammatically depicted for simplicity as a rectangle with two circles that represent L and R qubits . The nodes are interconnected into a chain by optical fibres not shown and are numbered from left to right the number n of each node is given beneath each node and node number j represents an arbitrary QR node along the chain. The node number of a QR node can be used as a suffix to identify the node thus QR is a reference to the quantum repeater node numbered j. This node representation numbering and identification is used generally throughout the present specification.

In three existing entanglements and are shown between qubits in respective node pairings for convenience when referring at a high level to entanglements along a chain of nodes a particular entanglement will herein be identified by reference to the pair of nodes holding the qubits between which the entanglement exists this reference taking the form of a two element node number tuple. Thus entanglement which is a local link entanglement LLE between qubits in the neighbouring nodes numbered N 1 and N is identifiable by the node number tuple N 1 N. Entanglements and shown by medium thick arcs in are extended entanglements existing between qubits in the node pairings and 1 j and j N 1 respectively these entanglements having been created by the merging of LLEs. To create an end to end abbreviated herein to E2E entanglement between qubits in the left and right end nodes see thick arc in entanglements and can first be merged by QRwith the resultant extended entanglement then being merged with LLE by QR alternatively entanglements and can first be merged by QRwith the resultant extended entanglement then being merged with entanglement by QR.

The entanglement build path EBP of an entanglement is the aggregate qubit to qubit path taken by the mediating light field or fields used in the creation of an un extended or extended entanglement where there are multiple path segments that is the path involves more than two qubits the light fields do not necessarily traverse their respective segments in sequence as will be apparent from a consideration of how the E2E entanglement is built in this example the entanglement build path is the path from one end node to the other via the left and right side qubits of the chain of quantum repeaters .

The particular form of physical implementation of a qubit and the details of the methods of performing entanglement elongate and merge operations for example whether very weak amounts of light or laser pulses of many photons are used are not of direct relevance to the present invention and accordingly will not be further described herein it being understood that appropriate implementations will be known to persons skilled in the art. Instead the physical hardware for implementing the quantum operations the quantum physical hardware will be represented in terms of a basic block herein called a Q block that provides for the implementation of and interaction with one qubit and an associated optical fabric.

Q block variety represents the physical hardware needed to manifest a qubit and carry out the Capture interaction of with that qubit that is the controlled sending of a light field through the qubit in a prepared state. This variety of Q block herein called a Capture Q block abbreviated in the drawings to Q block C comprises a physical implementation of a qubit and a light field emitter together with appropriate optical plumbing functionality for putting the qubit in a prepared state and for shuttering it for example using an electro optical shutter except when a light field is to be admitted functionality where appropriate for the qubit implementation concerned for transferring the qubit state between electron spin and nuclear spin and vice versa as needed and control functionality for coordinating the operation of the Capture Q block to send a light field through its qubit and on out of the Q block upon receipt of a Fire signal .

Q block variety represents the physical hardware needed to manifest a qubit and carry out the Transfer interaction of with that qubit that is the passing of a received light field through the qubit in a prepared state followed by measurement of the light field. This variety of Q block herein called a Transfer Q block abbreviated in the drawings to Q block T comprises a physical implementation of a qubit and a light field detector together with appropriate optical plumbing functionality responsive for example to a herald light pulse for putting the qubit in a prepared state and for shuttering it except when a light field is to be admitted functionality where appropriate for the qubit implementation concerned for transferring the qubit state between electron spin and nuclear spin and vice versa as needed and control functionality for coordinating the operation of the Transfer Q block and for outputting the measurement results .

Q block variety is a universal form of Q block that incorporates the functionality of both of the Capture and Transfer Q block varieties and and so can be used to effect both Capture and Transfer interactions. For convenience this Q Block variety is referred to herein simply as a Q block without any qualifying letter and unless some specific point is being made about the use of a Capture or Transfer Q block this is the variety of Q block that will be generally be referred to even though it may not in fact be necessary for the Q block to include both Capture and Transfer interaction functionality in the context concerned persons skilled in the art will have no difficulty in recognizing such cases and in discerning whether Capture or Transfer interaction functionality is required by the Q block in its context. One reason not to be more specific about whether a Q block is of a Capture or Transfer variety is that often either variety could be used provided that a cooperating Q block is of the other variety the direction of travel of light fields between them not being critical .

Regardless of variety every Q block will be taken to include functionality for carrying out an X measurement in response to receipt of an Xmeas signal thereby enabling the Q block to be used in elongate and merge operations the X measurement result is provided in the Result signal it being appreciated that where the Q block has Transfer interaction functionality the X measurement functionality will typically use the detector associated with the Transfer interaction functionality. X measurement functionality is not of course needed for an entanglement operation and could therefore be omitted from Q blocks used only for such operations.

It may be noted that where there are multiple Q blocks in a node the opportunity exists to share certain components between Q blocks for example where there are multiple Q blocks with Capture interaction functionality a common light field emitter may be used for all such Q blocks . Persons skilled in the art will appreciate when such component sharing is possible.

An entanglement operation will involve a Q block with Capture interaction functionality either a Transfer Q block or a universal Q block optically coupled to a Q block with Transfer interaction functionality either a Transfer Q block or a universal Q block the entanglement operation being initiated by a Fire signal sent to the Q block with Capture interaction functionality and the success failure of the operation being indicated in the result signal output by the Q block with Transfer interaction functionality.

Where an elongate operation is to be effected the initial entanglement operation component of the elongate operation will also involve a Q block with Capture interaction functionality and a Q block with Transfer interaction functionality. The provision of X measurement functionality in all varieties of Q block enables the subsequent removal from entanglement of the intermediate qubit to be effected by sending an Xmeas signal to the Q block implementing this qubit the measurement results being provided in the result signals output by this Q block.

Where a merge operation is to be effected this will also involve a Q block with Capture interaction functionality and a Q block with Transfer interaction functionality. Again the provision of X measurement functionality in all varieties of Q block enables the removal from entanglement of the qubit s involved in the merge operation. Measurement results are provided in the result signals output by the appropriate Q blocks.

In the LLE creation subsystem of the single Q blocks are simply coupled directly to the local link fibre . However in many cases there will be a need to provide a controllable optical fabric in a node to appropriately guide light fields to from the Q block s of the node depending on its current operational requirements. For example where there are multiple Q blocks in a node sharing the same external fibre an optical fabric may be required to merge outgoing light fields onto the common fibre or direct incoming light fields from the fibre to selected Q blocks in another example an optical fabric may be required in a quantum repeater node such as node in to switch a L side Q block and a R side Q block from optically interfacing with respective left and right local link fibres for LLE creation to optically interfacing with each other for a local merge operation.

In general terms therefore the quantum physical hardware of a node that is the physical elements that implement and support qubits and their interaction through light fields comprises not only one or more Q blocks but also an optical fabric in which the Q block s are effectively embedded. By way of example depicts such a representation for a quantum repeater node thus quantum physical hardware is shown as comprising an optical fabric for guiding light fields to from the Q blocks and the Q blocks are depicted as existing within the optical fabric with the local link fibres coupling directly to the optical fabric. One L side and one R side Q block are shown in solid outline and possible further L side and R side Q blocks are indicated by respective dashed outline Q blocks.

As employed herein any instance of the above described generalized quantum physical hardware representation such as the instance shown in in respect of a quantum repeater is intended to embrace all possible implementations of the quantum physical hardware concerned appropriate for the number and varieties of Q blocks involved and their intended roles. It may be noted that although shows the Q blocks as Q blocks that is of the Universal variety this is simply to embrace all possible implementations and is not a requirement of the role being played by the Q blocks in the quantum repeater a particular implementation may use other varieties of Q blocks as appropriate to their roles. This use of Q blocks in the above described generalized quantum physical hardware representation is not limited to the representation of quantum physical hardware for a quantum repeater .

Depending on the quantum operations to be performed by the quantum physical hardware the latter is arranged to receive various control signals and to output result signals In the case of the quantum physical hardware block appropriate for a quantum repeater the quantum physical hardware is arranged to receive Firing Control and Target Control signals for controlling entanglement creation operations to receive Merge signals for controlling merge operations and to output Result signals indicative of the outcome of these operations. The signals may be parameterized to indicate particular Q blocks. Target Control signals are not needed in some quantum repeater embodiments as will become apparent hereinafter. In one implementation of the quantum physical hardware the Firing Control signals comprise both 

For quantum physical hardware intended to perform elongate operations the quantum physical hardware as well as being arranged to receive Firing Control signals for performing the entanglement creation component of the elongate operation and to output Result signals is also arranged to receive Xmeas signals for instigating X measurements whereby to complete the elongate operation.

The optical fabric of a node may have a default configuration. For example where the quantum physical hardware only includes one L side and one R side Q block the optical fabric may be arranged to default to an LLE creation configuration optically coupling the Q blocks to respective ones of the local link fibres. In this case the merge signals are arranged to only temporarily optically couple the two Q blocks to each other for the time needed to carry out a merge operation. In cases such as this the Target Control signals can be dispensed with entirely and the Firing Control signals simply comprise Fire signals sent to the appropriate Q block.

The implementation is applicable to the case of a quantum repeater with one L side Q block and one R side Q block in this implementation both Q blocks are universal Q blocks . The left local link fibre couples directly to the input of the L side Q block and the right local link fibre couples directly to the output of the R side Q block . The output of the L side Q block is coupled to the input of the R side Q block by a short optical fibre . For LLE creation operation the L side Q block is operated as a Transfer Q block receiving a light field along local link fibre and the R side Q block is operated as a Capture Q block sending a light field after passage through its qubit out along local link fibre . To carry out a merge operation between the Q blocks the L side Q block is operated as a Capture Q block sending a light field after passage through its qubit along the optical fibre to the R side Q block now operated as a Transfer Q block. The set up signals of the Firing Control Target Control and Merge signals configure the optical fabric to ensure that the Q blocks as appropriate for the LLE creation merge operation to be performed.

The implementation is also applicable to the case of a quantum repeater with one L side Q block and one R side Q block in this implementation the L side Q block is a Transfer Q block and the R side Q block is a Capture Q block . An active optical switch enables a light field from the R side Capture Q block to be selectively optically coupled either to the right local link fibre when a LLE creation operation is to be carried out or to a loop back optical fibre when a merge operation is to be carried out . A passive optical merge unit enables the L side Transfer Q block to receive light fields coming in over either the left link fibre or the loop back optical fibre . The optical switch is set in dependence on the set up signals of the Firing Control and Merge signals this is another example of where the Target Control signals can be dispensed with entirely in this case because the Firing Control set up signals are adequate to appropriately configure the optical fabric for LLE creation .

The implementation is applicable to the case of a quantum repeater with multiple L side universal Q blocks genetically in number and multiple R side universal Q blocks generically r in number . In this case an active optical switch L interfaces the left local link fibre with the inputs of the L side Q blocks and a passive optical merge unit L puts the outputs of the L side Q blocks onto a single intermediate fibre . Similarly an active optical switch R interfaces the intermediate fibre with the inputs of the R side Q blocks and a passive optical merge unit R puts the outputs of the R side Q blocks onto the right local link fibre . For an LLE creation operation the optical switch L switches a light field coming in over the left link fibre to a desired one of the L side Q blocks while the optical merge unit R couples the R side Q blocks to the right local link fibre . For a merge operation the optical merge unit L and the optical switch R enable any one of the L side Q blocks to be optically coupled to any desired one of the R side Q blocks .

The implementation is applicable to the case of a quantum repeater with multiple L side Transfer Q blocks l in number and multiple R side Capture Q blocks r in number . In this case a passive optical merge unit puts the outputs of the R side Capture Q blocks onto a single fibre which is then switched by an active optical switch either to the right local link fibre or to a loop back optical fibre . An active optical switch disposed in front of the L side Transfer Q blocks is coupled to receive the output of a passive optical merge unit the latter being coupled on its input side to the left local link fibre and the loop back optical fibre . The active optical switch enables light fields received from the optical merge unit to be selectively passed to a desired one of the L side Transfer Q blocks .

For an LLE creation operation the optical switch is set to feed the light field output by one or more of the R side Capture Q blocks to the right local link fibre and the optical switch is set to feed a light field received over the left local link fibre to a selected one of the Transfer Q blocks the selected block being indicated in the Target Control set up signals fed to the quantum physical hardware . For a merge operation the optical switch is set to feed the light field output by one of the R side Capture Q blocks to the loop back fibre the Q block concerned will have been indicated in the Merge set up signals fed to the quantum physical hardware and the optical switch is set to feed the light field received via the loop back fibre to a selected one of the Transfer Q blocks again the selected Q block being indicated in the Merge set up signals .

Of course for both the quantum physical hardware implementations with l L side Q blocks and r R side Q blocks the value of l or r could be one in which case certain of the optical hardware elements optical merges switches can be omitted.

More particularly quantum repeater comprises quantum physical hardware of the form described above with respect to and including one or more L side and R side Q blocks and optical fabric coupled to left and right local link fibres via respective optical interfaces L R. As already indicated for convenience and without limitation the light fields involved in LLE creation will be taken unless otherwise stated as travelling from left to right along the local link fibres between nodes whereby the R side Q block s of the repeater act as Capture Q block s during LLE creation forming a right side LLE creation subsystem with L side Q block s in a right neighbour node not shown and the L side Q block s of the repeater act as Transfer Q block s during LLE creation forming a left side LLE creation subsystem with R side Q block s in a left neighbour node not shown .

An R side LLE R LLE control unit is responsible for generating the Firing Control signals that select where appropriate and trigger firing of the R side Q block s in respect of LLE creation. An L side LLE L LLE control unit is responsible for generating where appropriate the Target Control signals for selecting the L side Q block s to participate in LLE creation the L LLE control unit is also arranged to receive the Result signals from the quantum physical hardware indicative of the success failure of the LLE creation operations involving the L side Q blocks.

It will thus be appreciated that initiation of right side LLE creation is effectively under the control of the R LLE control unit of the repeater as unit is responsible for generating the Fire signal for the R side Q block involved in creating the right side LLE initiation of left side LLE creation is however effectively under the control of the R LLE control unit in the left neighbour node.

An LLE control LLEC classical communication channel inter communicates the L LLE control unit with the R LLE control unit of the left neighbour node that is the R LLE control unit associated with the same LLE creation subsystem as the L LLE control unit the L LLE control unit uses the LLEC channel to pass LLE creation success failure messages message in to the R LLE control unit of the left neighbour node.

An LLE control LLEC classical communication channel inter communicates the R LLE control unit with the L LLE control unit of the right neighbour node that is the L LLE control unit associated with the same LLE creation subsystem as the R LLE control unit the R LLE control unit receives LLE creation success failure messages message in over the LLEC channel from the L LLE control unit of the right neighbour node.

It will be appreciated that where the light fields involved in LLE creation are arranged to travel from right to left along the local link fibres between nodes rather than from left to right the roles of the L side and R side LLE control units are reversed.

A merge control MC unit is responsible for generating the Merge signals that select where appropriate local Q blocks to be merged and trigger their merging. The MC unit is also arranged to receive from the quantum physical hardware the Result signals indicative of the success failure and parity of a merge operation.

A merge control MC classical communication channel inter communicates the MC unit with corresponding units of its left and right neighbour nodes to enable the passing of parity information and if needed success failure information concerning merge operations. Messages on the MC channels are referred to herein as MC messages.

The LLEC communication channel and the MC communication channel can be provided over any suitable high speed communication connections such as radio but are preferably earned as optical signals over optical fibres. More particularly the LLEC communication channel and the MC communication channel can be carried over respective dedicated optical fibres or multiplexed onto the same fibre which could be the fibre used for the local links optically coupling Q blocks in neighbouring nodes for example the MC communication channel can be implemented as intensity modulations of the herald signal particularly where only parity information is being sent on this channel . More generally the LLEC and MC communication channels can be combined into a single duplex classical communications channel.

In the embodiments described hereinafter the LLEC communication channel is carried by the local link fibres and the MC communication channel is split into a left to right LR channel and a right to left RL channel these two MC channels being carried by respective optical fibres distinct from that used for the local links. Messages on the LR MC channel and the RL MC channel are respectively referred to herein as LR MC messages and RL MC messages. It will be appreciated that this arrangement of channels and fibres is merely exemplary and other arrangements could alternatively be used.

It may be noted that the end nodes linked by a chain of quantum repeaters will each contain functionality for inter working with the facing side L or R of the neighbouring quantum repeater. Thus the left end node will include functionality similar to that of the R side of a quantum repeater thereby enabling the left end node to inter work with the L side of the neighbouring repeater and the right end node will include functionality similar to that of the L side of a quantum repeater to enable the right end node to inter work with the R side of the neighbouring repeater.

With regard to entanglement parity in the embodiments described below rather than the parity of entanglements being standardized by qubit state flipping at each quantum repeater LLE parity information is stored and subsequently combined with merge parity information for passing on along cumulatively to an end node thereby to enable the latter to determine the parity of end to end entanglements.

In the following description of the quantum repeater embodiments the same reference numerals are used for the main repeater components as are used in the generic diagram of it being understood that the specific implementations of these components will generally differ.

The first and second quantum repeater embodiments illustrated in respectively both operate on an Extend from End basis to build an end to end E2E entanglement between qubits in left and right end nodes of a chain of nodes whose intermediate nodes are quantum repeaters. Building an E2E entanglement on the Extend from End basis involves an iterative process starting with an LLE between a first one of the end nodes and the neighbouring quantum repeater of extending an entanglement existing between the first end node and a quantum repeater of the chain of nodes by merging that entanglement with an LLE formed between that repeater and its neighbour node on the side away from the first end node. This iterative process is illustrated in to for building an E2E entanglement from the left end of an example chain of seven nodes this chain comprises left and right end nodes respectively and five intermediate quantum repeater QR nodes the local link fibres that optically couple the nodes are only shown in to avoid unnecessarily cluttering the Figure . The node representation node numbering n and repeater identification QRused in respect of are the same as used for in particular n 1 and n 7 for the left and right end nodes respectively of . Arrow arcs between nodes represent entanglements those in solid lines being pertinent to the Extend from End process of building an E2E entanglement whereas those shown in dashed lines are incidental LLEs.

Each of to represents a respective entanglement extending iteration of the Extend from End process with the entanglement to be extended in the iteration concerned being shown as a medium thick arc and the operative quantum repeater that is the one that is to effect the entanglement extending merge being shown hatched. In to each iteration is depicted just prior to the operative quantum repeater effecting its merge operation.

The LLEs used in the Extend from End process are for example created on an on going basis by the quantum repeaters whereby an LLE extending to the right from the operative quantum repeater will exist or shortly exist when needed by that repeater notwithstanding the limited lifetime of an entanglement the dashed line LLEs are ones created by the quantum repeaters as part of such an ongoing LLE creation process but before they are actually needed.

Although the Extend from End process illustrated in builds an E2E entanglement from the left end node to the right end node it will be appreciated that the same general process can be applied to build an E2E entanglement from the right end node to the left end node .

For simplicity of explanation it is assumed in that all merges are successful if a merge fails the whole Extend from End process is re started.

A number of generic features may be noted about the Extend from End process illustrated in . In particular 

The first Extend from End quantum repeater embodiment will now be described with reference to it being understood that the quantum repeater operates in the context of being an intermediate node in a chain of nodes such as depicted in between the left and right end nodes of which E2E entanglements are to be created.

The quantum physical hardware of the quantum repeater comprises an optical fabric that services a single L side Q block and a single R side Q block and optically couples with left and right local link fibres respectively.

As already generally described in connection with for LLE creation the R side Q block of quantum repeater operates as a Capture Q block sending a light field through its qubit and out over the right local link fibre to a L side Q block operating as a Transfer Q block of the right neighbour node the R side Q block of the quantum repeater forms together with the L side Q block of the right neighbour node an LLE creation subsystem . The L side Q block of quantum repeater operates as a Transfer Q block receiving a light field via the left local link fibre from a left neighbour node Transfer Q block with which it forms an LLE creation subsystem . The L side and R side Q blocks are managed in respect of LLE creation by left and right LLE control units and respectively that is L LLE control unit and R LLE control unit . The R LLE control unit is responsible for generating the Firing Control signals however the L LLE control unit is not required to generate Target Control signals in the present embodiment. Result signals in respect of LLE creation are passed from the L side Q block to the L LLE unit . The left LLEC channel is imposed on the left local link fibre via optical interface L and used to pass LLE creation success failure messages from the L LLE control unit to the R LLE control unit of the left neighbour node. Similarly the right LLEC channel is imposed on the right local link fibre via optical interface R and is used to pass to the R LLE control unit LLE creation success failure messages from the L LLE control unit of the right neighbour node.

Merge control is effected by merge control MC unit which as well as interfacing with the quantum physical hardware to initiate a merge operation and receive back result signals is arranged to exchange various signals with the L LLE control unit and R LLE control unit and to communicate with the merge control units of other nodes by messages sent over a left to right merge control LR MC channel carried on left and right optical fibres L and R respectively and aright to left merge control RL MC channel carried on left and right optical fibres L and R respectively. A fibre interface unit of the MC unit not only provides transmit Tx and receive Rx interfaces for coupling with the fibres but also triages messages received over the fibres to pass them along the same channel and or provide them to the main part of the MC unit . The fibre interface also includes a fibre integrity monitor the purpose of which will be explained later.

A more detailed description will next be given of LLE creation. As noted when discussing the generic repeater initiation of right side LLE creation is under the control of the R LLE control unit of a repeater whereas initiation of left side LLE creation is under the control of the R LLE control unit in the left neighbour node. As will be more fully described below the R LLE control unit of repeater is arranged to cause creation of right side LLEs to be done on a minimum delay regeneration basis that is as soon as a right side LLE is used in a merge operation or ceases to be usable because the state of one or both of its qubits has decayed too far a new right side LLE creation operation is initiated. This serves to maximize the likelihood of a right side LLE being present when the repeater becomes the operative repeater in terms of the Extend from End process described above with respect to . Alternative strategies for creating right side LLEs are possible for example only initiate right side LLE generation when the repeater becomes the operative repeater. The role of the L LLE control unit of repeater is more passive involving reporting the success or failure of LLE creation.

The functioning of the LLE control units will be explained in terms of the operation of respective controlling state machines L R and associated timers L and R.

The timers L R are used to track the useful lifetimes of the qubits of the L side and R side Q blocks respectively each timer being reset and started by a restart signal sent from the associated state machine L R when a qubit is set up and sending back a timeout signal L timeout or R timeout as appropriate a fixed time later corresponding to the useful lifetime of a qubit.

Considering first the R LLE control unit state machine R this has two states namely a first state labelled Right Entangled in which the state machine exists when the qubit of the R side Q Block is entangled and a second state labelled Pending . The signals input to output by the state machine R comprise 

Whenever the state machine R receives a Reset R an LLEC failure message or a R timeout signal it re initiates right side LLE creation by outputting appropriate Firing Control signals in this case just the Fire signal and restarts the associated timer R to start timing down the useful lifetime of the R side qubit these actions are labelled FIRE R and RESTART R TIMER in . The state machine R will now be in its Pending state .

If a right side LLE is successfully created the state machine R will receive an LLEC success message which causes it to transit from its Pending state to its Right Entangled state see arc with a R entangled notification being sent to the MC unit . If right side LLE creation is unsuccessful resulting in receipt of a LLEC fail message or if the useful lifetime of the R side qubit times out resulting in receipt of a R timeout signal or if a Reset R signal is received from the MC unit then right side LLE creation is re initiated arc .

When the state machine R is in its Right Entangled state following successful right side LLE creation one of two relevant events may occur. Firstly a R timeout signal may be received from the timer R in which case right side LLE creation must be re initiated and the MC unit notified through a R expired signal that the right LLE has expired arc . Secondly a Reset R signal may be received from the MC unit for example as a result of a successful merge operation in which case right side LLE creation is re initiated are . In either case the state machine R returns to its Pending state .

Considering next the L LLE control unit state machine L this also has two states namely a first state labelled Left Entangled in which the state machine exists when the qubit of the L side Q Block is entangled and a second state labelled Pending . The signals input to output by the state machine L comprise 

Whenever the state machine L receives a Reset L or a L timeout signal it will transit to its Pending state if not already in this state. If now the state machine L receives a L Entangled Result signal from the quantum physical hardware telling it that the L side qubit has been successfully entangled in a left side LLE initiated by its left neighbour node the state machine L transits to its Left Entangled state arc . At the same time the state machine L stores in memory the left LLE parity information sends a LLEC success message to the left neighbour node and restarts its associated timer L to start timing down the useful lifetime of the L side qubit.

However if when in its Pending state the state machine L receives a L Not Entangled Result signal from the quantum physical hardware telling it that a left side LLE creation attempt initiated by its left neighbour node has failed the state machine L sends a LLEC failure message to the left neighbour node arc and remains in its Pending state . Receipt of a L timeout signal or Reset L signal by the state machine L when in its Pending state simply results in the state machine L remaining in this state arc .

When the state machine L is in its Left Entangled state following successful left side LLE creation one of two relevant events may occur. Firstly a L timeout signal may be received from the timer L in which case the MC unit is notified through a L expired signal that the left LLE has expired and the state machine L returns to its Pending state arc . Secondly a Reset L signal may be received from the MC unit for example as a result of a successful merge operation in which case the state machine R simply returns to its Pending state arc .

The functioning of the merge control MC unit will next be explained in terms of the operation of a controlling state machine reference being made to which shows a state transition diagram for MC state machine . The same convention is used in for representing state transitions events and actions as in .

As noted above when discussing the Extend from End process illustrated in before effecting a merge operation a quantum repeater such as repeater implementing this process needs to know when the following two conditions are met 

To track the fulfilment of these conditions the MC state machine has three states namely a first state labelled. Waiting in which the state machine exists when neither condition is met a second state labelled Merged To Left in which the state machine exists when only the first condition is met and a third state labelled Right Primed in which the state machine exists when only the second condition is met.

The state machine exchanges the following previously mentioned signals with the lower level functions of the repeater L LLE and R LLE control units and the quantum physical hardware 

For present purposes the EchoMe message can be considered as a general node reset signal regardless of the current state of the MC state machine receipt of the EchoMe message causes it to transit to its Waiting State and send the Reset L and Reset R signals.

The basic operation of the MC state machine is straightforward. When in its Waiting state for example following receipt of an EchoMe message the state machine may either receive 

If a L expired signal is received when the state machine is in its Merged To Left state it returns to its Waiting state arc and sends the RL MC message E2E failed to tell the left end node that the entanglement being extended from that node has failed the failure in this case being due to the timeout of right hand qubit of the entanglement that is the L side qubit of the current repeater. If a R expired signal is received when the state machine is in its Right Primed state it simply returns to its Waiting state arc .

If a R entangled signal is received when the state machine is in its Merged To Left state or a merge succeeded LR MC message received when the state machine is in its Right Primed state both of the merge pre conditions are fulfilled and the state machine in transiting back to the Waiting state arcs sends a Merge signal to the quantum physical hardware to initiate a merge operation and reports the result of this operation to the nodes that need to know in LR MC and RL MC messages. If the merge was successful the LR MC message merge succeeded is sent to the right neighbour node effectively passing it control that is that node if not the end node becomes the operative quantum repeater . If the merge was unsuccessful the RL MC message E2E failed is sent so that the left end node knows the current entanglement extension process has failed the LR MC message merge failed is also sent to the right neighbour node to cause the L LLE control unit state machine of that node to be reset to its Pending state.

Receipt by the MC state machine of a LR MC merge failed message when in its Waiting or Right Primed state results in the Reset L signal being output to the L LLE control unit state machine to put it in its Pending state the state of the MC state machine is unchanged arcs .

It will be appreciated that strictly a further state Awaiting Merge Result should have been included in the state diagram this state being entered after the Merge signal is sent and pending receipt of the merge operation Result signal the state has been omitted simply for reasons of clarity of explanation.

Regarding parity information the LR MC message merge successful includes cumulative parity information. The MC state machine is operative upon receipt of a LR MC merge successful message to temporarily store the cumulative parity information in memory see actions on arcs and . If the local merge operation subsequently carried out on arc is successful the MC state machine combines the left LLE parity information held in store with 

As noted above the fibre interface unit of the MC unit not only provides transmit Tx and receive Rx interfaces for coupling with the MC channel fibres but also triages LR and RL MC messages to pass them along the same channel and or provide them to the MC state machine .

It will be appreciated that the role of certain of the foregoing messages such as E2E failed E2E succeeded is not strictly merge control nevertheless all of the above messages are herein referred to as MC messages .

The fibre interface unit triages received LR MC message to pass merge succeeded and merge failed messages to the MC state machine and pass on EchoMe messages along the LR MC channel. The unit also acts to insert merge succeeded and merge failed messages generated by the MC state machine into the LR MC channel.

The fibre interface unit triages received RL MC message to pass EchoMe messages to the MC state machine and pass on E2E failed E2E succeeded EchoMe and Path broken messages along the RL MC channel. The unit also acts to insert E2E failed and Path broken messages into the RL MC channel.

The fibre integrity monitor of the fibre interface unit is connected to the fibre receive Rx interfaces to detect loss of signal from the upstream nodes the left neighbour node for the LR MC channel and the right neighbour node for the RL MC channel indicative of a fibre break in the interconnecting fibre. The signal monitored to detect this loss of signal is typically a continuously present carrier signal used to carry the MC channel signals but could alternatively be a dedicated integrity monitoring signal. On detecting a fibre break the integrity monitor unit outputs a Path broken signal. This enables the left end node to be rapidly informed of a failure of the fibre used for the MC messages.

As already indicated the terms left and right are simply convenient labels for relative directions along the node chain. The embodiment could equally as well been described in terms of the light fields passing from right to left in the LLE creation subsystems in which case for LLE creation the L side Q blocks need Capture interaction functionality and the R side Q blocks need Transfer interaction functionality and E2E entanglements being built from the right end node.

A more interesting case is to reverse the direction of travel of the light fields involved in LLE creation to be right to left while still building E2E entanglements from the left end node. In fact only small changes are needed to the right and left LLE control unit state machines L R to accommodate this case 

With regard to parity information the repeater measures and stores the parity of its right LLE rather than its left LLE and merge control unit updates the received cumulative parity information by combining it with the stored right LLE parity and the parity of the local merge operation. The result is that the cumulative parity information received by a repeater is directly the parity of the entanglement between the left end node and the repeater.

It may also be noted that a hybrid form of repeater with two complimentary varieties is possible in which the direction of travel of the light fields during LLE creation is opposite for the left and right sides of the repeater. Thus in one variety of this hybrid repeater the light fields are generated by the left and right sides of the repeater and after passage through L and R qubits respectively are sent out over left and right local link fibres to the left and right neighbour nodes in the other variety of this hybrid repeater the light fields are received by the left and right sides of the repeater over left and right local link fibres respectively from the left and right neighbour nodes are passed through L and R qubits respectively and are then measured. It will be appreciated that in a chain of quantum repeaters of the foregoing hybrid form it is necessary to alternate the two varieties of repeater. It will further be appreciated that the control units can be arranged to build E2E entanglements from left to right or from right to left as desired.

With regard to the operation of the left end node of the chain of nodes whose intermediate nodes are constituted by Extend from End quantum repeaters of the form this left end node comprises quantum physical hardware including a R side Capture Q block coupled to a local link fibre connecting to the right neighbour repeater node and a controller with an associated qubit timeout timer . This controller communicates with the right neighbour node over the LLEC and MC channels the controller is also arranged to exchange messages with a local E2E entanglement consumer application . The operation of the left end node controller can be represented by a state machine with a state transition diagram of the form shown in this state machine being similar to the R LLE control unit state machine R but with modifications including two extra states one of which corresponds to waiting for the return of an EchoMe message and the other of which corresponds to the R side qubit of the left end node being successfully entangled with a L side qubit of the right end node.

More particularly the left end node state machine has a first state labelled Pending a second state labelled Right Entangled a third state labelled E2E Entangled and a fourth state labelled Await Echo . The signals input to output by the state machine comprise 

When the left end node is started arc it sends an EchoMe LR MC message and the state machine enters its Await Echo state . As the EchoMe message is echoed back by the right end node it resets all the nodes upon receipt back of the EchoMe message on the RL MC channel the state machine initiates right side LLE creation by outputting appropriate Firing Control signals and restarts its associated timer before transiting to its Pending state .

If a right side LLE is successfully created the state machine will receive an LLEC success message which causes it to transit from its Pending state to its Right Entangled state see arc with a merge succeeded LR MC message being sent to the MC unit of the neighbour node thereby making it the operative repeater in the terms of . The merge succeeded LR MC message is sent even though the left end node has not carried out a merge operation because the successful creation of a right side LLE is the left end node s equivalent of an Extend from End repeater merge operation in respect of extending an entanglement anchored at the left end node to the right neighbour node. As there is no parity information available the left end node does not receive any cumulative parity information is not involved in a left LLE and does not carry out a merge operation the state machine simply adds neutral parity information that is even parity indications to the merge succeeded LR MC message it sends out.

If right side LLE creation is unsuccessful resulting in receipt of a LLEC failure message or if the useful lifetime of the R side qubit times out resulting in receipt of a Timeout signal then right side LLE creation is re initiated arc .

When the left end node state machine is in its Right Entangled state following successful right side LLE creation one of three relevant events may occur. Firstly an E2E succeeded RL MC message may be received from the right end node indicating that an E2E entanglement has been successfully created in this case the state machine notifies the consumer application by sending an E Go message and transits to its E2E Entangled state see arc . Secondly an E2E failed RL MC message may be received in which case right side LLE creation is re initiated arc and the state machine returns to its Pending state . Thirdly a Timeout signal may be received indicating timeout of the R side qubit since the building of an E2E entanglement could at this point have reached any node the state machine resets all the nodes by sending an LR MC EchoMe message and then transits to its Await Echo arc .

When the left end node state machine is in its E2E Entangled state following successful E2E Entanglement creation one of three relevant events may occur. Firstly a Timeout signal may be received in which case the state machine notifies the consumer application by sending it an E NoGo message and resets all the nodes by sending an LR MC EchoMe message before transiting to its Await Echo state arc . Secondly a Consumed message may be received from the consumer application in which case right side LLE creation is re initiated arc and the state machine transits to its Pending State . Thirdly an E2E failed message may be received on the RL MC channel for example because the right end node qubit has timed out in this case the state machine notifies the consumer application by sending it an E NoGo message and reinitiates LLE creation before transiting to its Pending state are .

The left end node also includes functionality for handling Path broken messages received over the RL MC channel this functionality may serve to generate an alarm signal and or to effect the repeated sending of EchoMe messages on the RL MC channel until received back on the LR MC channel indicating that the fibre break has been rectified.

With regard to the operation of the right end node of the chain of nodes whose intermediate nodes are constituted by Extend from End quantum repeaters of the form this right end node comprises quantum physical hardware including a L side Transfer Q block coupled to a local link fibre connecting to the left neighbour repeater node and a controller with an associated qubit timeout timer . The controller includes a memory for storing left LLE parity information. The controller communicates with the left neighbour node over the LLEC and MC channels the controller is also arranged to exchange messages with a local E2E entanglement consumer application . The operation of the right end node controller can be represented by a state machine with a state transition diagram of the form shown in this state machine being similar to the L LLE control unit state machine L but with modifications including an extra state corresponding to the L side qubit of the right end node being successfully entangled with the R side qubit of the left end node.

More particularly the right end node state machine has a first state labelled Pending a second state labelled Left Entangled and a third state labelled E2E Entangled . The signals input to output by the state machine comprise 

With the right end node state machine in its Pending state if it now receives a L Entangled Result signal from the quantum physical hardware telling it that the L side qubit has been successfully entangled in a LLE initiated by its left neighbour node the right end node state machine transits to its Left Entangled state are . At the same time the state machine stores the parity of the left LLE in memory sends a LLEC success message to the left neighbour node and restarts its associated timer to start timing down the useful lifetime of the L side qubit.

However if when in its Pending state the right end node state machine receives a L Not Entangled Result signal from the quantum physical hardware telling it that a left side LLE creation attempt has failed the state machine sends a LLEC failure message to the left neighbour node are and remains in its Pending state . Receipt of a Timeout signal by the state machine when in its Pending state simply results in the state machine remaining in this state.

When the right end node state machine is in its Left Entangled state following successful left side LLE creation one of three relevant events may occur. Firstly a Timeout signal may be received in which case the left end node is notified through a E2E failed message sent on the RL MC channel and the state machine returns to its Pending state are . Secondly a merge failed LR MC message may be received from the left neighbour node in which case the state machine simply returns to its Pending state are . Thirdly a merge succeeded LR MC message may be received from the left neighbour node in which case the state machine i determines the parity of the newly created E2E entanglement by combining the cumulative parity received in the merge succeeded message with the left LLE parity stored in memory ii sends an E Go message to the local consumer application to notify it that an E2E entanglement is available this message including the E2E parity information and iii sends an E2E succeeded RL MC message to the left end node are the state machine then transits to its E2E Entangled state .

When the right end node state machine is in its E2E Entangled state following successful E2E entanglement creation one of two relevant events may occur. Firstly a Consumed message may be received from the local consumer application in which case the state machine transits to its Pending state . Secondly a Timeout signal may be received in which case the state machine both sends an E NoGo message to the local consumer application to notify it that an E2E entanglement is no longer available and sends an E2E failed RL MC message to the left end node are the state machine then transits to its Pending state .

The right end node also includes functionality for responding to an EchoMe message received over the LR MC channel by sending the message back on the RL MC channel and causing the right end node state machine to transit to its Pending state regardless of its previous state additionally if the state machine s previous state was E2E Entangled an E NoGo message is sent to the local consumer application .

Various modifications can be made to the above described first quantum repeater embodiment with a view to increasing the rate of successful E2E entanglement creation. Five such modifications are discussed below it being understood that these modifications can be used alone or in combination to increase the rate of E2E entanglement creation.

As so far described once an E2E entanglement has been created the chain of nodes left and right end nodes and intermediate repeater nodes see cannot be re used until the consumer applications consume the existing E2E entanglement this is because the E2E entanglement exists between the R Q block of the left end node and the L Q block of the right end node .

To free up the R Q block of the left end node and the L Q block of the right end node and thereby the node chain without waiting upon the consumer applications the left and right end nodes can be provided with respective output buffers each comprising multiple Q blocks respectively. The optical fabric and controller of each end node are set up to enable any selected one of the node s output buffer Q blocks to be entangled with the node s R or L Q block as the case may be whereby to move the E2E entanglement across into the selected buffer Q block this operation involves substantially the same Capture and Transfer interactions as are depicted in but carried out over a short distance and therewith with a high probability of success . Thus once an the E2E entanglement has been created between the R Q block of the left end node and the L Q block of the right end node the two ends of the entanglement are moved across into available left and right buffer Q blocks . The node chain is now free to create another E2E entanglement which in turn can be moved across into available left and right buffer Q blocks and so on.

More particularly in the left end node optical merge unit couples the buffer Q blocks to the R Q Block . The buffer Q blocks have Capture interaction functionality and the R Q block now possess Transfer interaction capability in addition to the Capture interaction capability if uses to set up an LLE with its neighbour repeater node. To transfer the left end root of an E2E entanglement from the R Q block to a particular buffer Q block the qubit of latter is first entangled with the qubit of the R Q block by an entanglement operation this is effected by selectively energizing the emitter associated with the buffer Q block concerned thereby causing a light field to traverse the qubit of that Q block before being channelled by the optical merge unit to the R Q block as generally indicated by arrow . Thereafter the qubit of the R Q block is removed from entanglement by an X measurement operation.

In the right end node optical merge unit couples the buffer Q blocks to the L Q Block again the buffer Q blocks have Capture interaction functionality and the L Q block already possess the required Transfer interaction capability. To transfer the right end roof of an E2E entanglement from the L Q block to a particular buffer Q block the qubit of the latter is first entangled with the qubit of the L Q block by an entanglement operation this is effected by selectively energizing the emitter associated with the buffer Q block concerned thereby causing a light field to traverse the qubit of that Q block before being channelled by the optical merge unit to the L Q block as generally indicated by arrow . Thereafter the qubit of the L Q block is removed from entanglement by an X measurement operation.

It will be appreciated that different optical fabric implementations are possible for example to reverse the light field direction of travel in the right end node an active optical switch could be used to optically couple the L Q block to a selected buffer Q block in this case the L Q block would need Capture interaction capability and the buffer Q blocks would need Transfer interaction capability .

It will further be appreciated that associated with the operation of moving of an E2E entanglement into a buffer Q block will be a parity measurement. If the measured parity is even no further action is needed as the parity of the E2E entanglement unchanged however if the measured parity is odd then to keep the E2E entanglement the same the buffer qubit concerned is flipped.

By splitting the chain of nodes into multiple segments each with its own pair of left and right end nodes creation of extended entanglements can be effected in parallel over respective segments these E2E segment entanglements can then be merged to created the final E2E entanglement.

One particular example arrangement of such segmentation is depicted in . In this case the ultimate end nodes between which it is desired to create an E2E entanglement are left end node and right end node . The chain of nodes end nodes and intermediate repeater nodes is divided into a first segment and a second segment .

The end nodes of the first segment are the left end node and a sub node of a segment spanning node . The segment is arranged to build an E2E segment entanglement right to left arrow and to this end the functionality of the sub node corresponds to that of the previously described left end node whereas the functionality of the left end node corresponds to that of the previously described right end node .

The end nodes of the second segment are right end node and a sub node of the segment spanning node . The segment is arranged to build an E2E segment entanglement left to right arrow and to this end the functionality of the sub node corresponds to that of the previously described left end node whereas the functionality of the right end node corresponds to that of the previously described right end node .

The segment spanning node is the initiator of E2E segment entanglement building over both segments and and in due course will receive an E2E succeeded message from each of the end nodes and informing it of the successful creation of E2E segment entanglements. The segment spanning node now merges these E2E segment entanglements to generate the desired E2E entanglement between nodes and . The segment spanning node thus not only possesses end node functionality but also merge functionality.

As noted above the probability of a successfully entangling two qubits coupled by a 10 km fibre is of the order of 25 which means that for quantum repeaters of the form spaced by distances of the order of 10 km on average it will take four attempts at entanglement to achieve success each attempt taking at least the light speed round trip time between repeaters. This clearly limits the rate at which E2E entanglements can be created. Matters can be improved by increasing the probability of success of each entanglement attempt.

The simplest way of doing this is to expand each LLE creation subsystem by paralleling up the pairing of a R side Q block of one repeater and the L side Q block of the neighbour repeater so that there are multiple such pairings at each entanglement attempt every R side Q block would be fired at its paired L side Q block.

Such an arrangement is shown in for an LLE creation subsystem formed between quantum repeater QR and its right neighbour repeater QR. The R side of the quantum physical hardware of repeater QR comprises q Capture Q blocks with respective IDs 1 to q. Similarly the L side of the quantum physical hardware of repeater QR comprises q Transfer Q blocks with respective IDs 1 to q. Each R side Q block in repeater QR is optically coupled by a respective local link optical fibre to the corresponding L side Q block of repeater QR. When the R LLE control unit of repeater QR outputs a Fire signal to its quantum physical hardware to trigger an LLE creation attempt all q Q blocks are simultaneously fired and the emitted light fields pass along respective ones of the local link optical fibres to the corresponding Q blocks of repeater QR. The result signals from the Q blocks are passed to the L LLE control unit of repeater QR which 

The R LLE control unit of repeater QR either itself stores the ID of the selected Q block or passes it to the MC unit for storage this ID serves to identify the corresponding successful Q block of repeater QR . When the MC unit comes to effect a merge it retrieves the stored Q block ID so that it knows which R side Q block to use. In due course the repeater QR becomes the operative repeater and itself comes to effect a merge it knows which L side Q block to use either because its ID was previously locally stored or because the ID was included in the LR MC merge succeeded message it received from repeater QR.

Of course the arrangement shown in is inefficient in that it uses a respective optical fibre for each pairing of R side Q block and L side Q block . By staggering the firing of the R side Q blocks of repeater QR it is possible to multiplex the emitted light fields onto a single fibre and such an arrangement is illustrated in for an LLE creation subsystem formed between quantum repeater QR and its right neighbour repeater QR.

The R side of the quantum physical hardware of repeater QR comprises q Capture Q blocks with respective IDs 1 to q. Similarly the L side of the quantum physical hardware of repeater QR comprises q Transfer Q blocks with respective IDs 1 to q. Each R side Q block in repeater QR is optically coupled by an optical merge unit to local link optical fibre . Fibre feeds optical switch of repeater QR the outputs of the switch feeding respective ones of the L side Q blocks of repeater QR. When the R LLE control unit of repeater QR outputs a Fire signal to its quantum physical hardware to trigger an LLE creation attempt the Q blocks are sequentially fired and the emitted light fields pass through the merge unit and onto the fibre in due course the light field arrive in sequence at the optical switch of repeater QR and are switched to corresponding ones of the Q blocks Operation is then substantially as described above for the arrangement. Each light field may be preceded by its own herald light pulse or a single herald can be provided preceding the sequence of light fields the individual fields not having their own separate heralds in this case .

Appropriate operation of the switch to ensure that the light field associated with the QRQ block with ID k is passed to the QRQ block with the same ID can be achieved in a number of ways. For example a herald pulse at the front of the sequence of light fields arriving at the switch can be used to trigger sequential switching according to the same timing as used to sequentially fire the Q blocks of repeater QR. Alternatively the switch can simply count the incoming light fields and switch according. The time interval between adjacent light fields in the sequence of light fields arriving at the switch is advantageously kept as small as possible consistent with giving enough time for the optical switch to change over between Q blocks of repeater QR.

Rather than sequentially firing the Q blocks of repeater QR an equivalent result can be achieved by tiring them all together but using different lengths of fibre to connect each Q block to the optical merge unit thereby introducing different delays.

Because the repeater embodiment can only handle one right LLE at a time the arrangements of may appear profligate in their use of Q blocks notwithstanding the objective of increasing the LLE creation success rate. However with regard to the R side Q blocks of repeater QR it should be noted that once fired each of these Q blocks cannot be used again at least until the result of the entanglement it was attempting to achieve is known at least the round trip time to repeater QR therefore a R side Q block cannot be rapidly re used to try to increase LLE creation success rates. On the other hand because the result of an attempted entanglement will be very quickly known at a L side Q block of repeater QR it is possible to rapidly re use the Q block unless and until a successful entanglement is achieved. This leads to the firing squad arrangement depicted in for an LLE creation subsystem formed between quantum repeater QR and its right neighbour repeater QR.

More particularly the R side of the quantum physical hardware of repeater QR comprises f Q blocks with respective IDs 1 to f that have Capture interaction functionality. These Q blocks collectively form a firing squad . The L side of the quantum physical hardware of repeater QR comprises a single Q block with Transfer interaction functionality. The Q blocks of the firing squad of repeater QR are optically coupled by an optical merge unit to local link optical fibre that in turn is optically coupled to the single L side Q block of repeater QR. Thus as can be seen all the Q blocks of the firing squad herein fusilier Q blocks are aimed to fire at the same target Q block .

When the R LLE control unit of repeater QR outputs a Fire signal to its quantum physical hardware to trigger an LLE creation attempt the fusilier Q blocks of the firing squad are sequentially fired and the emitted light fields pass through the merge unit and onto the fibre as a light field train It may be noted that there will be an orderly known relationship between the fusilier Q block IDs and the order in which the light fields appear in the train. Rather than each light field being preceded by its own herald a single herald preferably precedes the light field train to warn the target Q block of the imminent arrival of the tram this herald being generated for example by a dedicated emitter not shown of the firing squad in response to the Fire signal and in advance of the firing of the fusilier Q blocks .

As each light field arrives in sequence at the target Q block of repeater QR the shutter of the target Q block is briefly opened to allow the light field to pass through the qubit of the target Q block to potentially interact with the qubit the light field thereafter being measured to determine whether an entanglement has been created. If no entanglement has been created the qubit of target Q block is reset and the shutter is opened again at a timing appropriate to let through the next light field of the train . However if an entanglement has been created by passage of a light field of train the shutter of the target Q block is kept shut and no more light fields from the train are allowed to interact with the qubit of target Q block . The measurement result dependent control of the Q block shutter is logically part of the L LLE control unit associated with the L side target Q block though in practice this control may be best performed by low level control elements integrated with the quantum physical hardware.

It will be appreciated that the spacing of the light fields in the train should be such as to allow sufficient time for a determination to be made as to whether or not a light field has successfully entangled the target qubit for the target qubit to be reset and for the Q block shutter to be opened before the next light field arrives.

In fact rather than using an explicit shutter to prevent disruptive interaction with the target qubit of light fields subsequent to the one responsible for entangling the target qubit it is possible to achieve the same effect by transferring the qubit state from electron spin to nuclear spin immediately following entanglement whereby the passage of subsequent light fields does not disturb the captured entangled state the target qubit having been stabilized against light field interaction . It may still be appropriate to provide a shutter to exclude extraneous light input prior to entanglement but as the qubit is not set into its prepared state until the herald is detected such a shutter can generally be omitted.

The L LLE control unit is also responsible for identifying which light field of the train successfully entangled the target qubit and thereby permit identification of the fusilier Q block and thus the qubit entangled with the target Q block qubit as already noted there is a known relationship between the fusilier Q block IDs and the order in which the light fields appear in the train . For example the light fields admitted to the target Q block may simply be counted and this number passed back to the repeater QR in an LLEC success message the recipient R LLE control unit performing any needed conversion of this number to the ID number of the successful fusilier Q block before storing the latter for example in a register for later reference alternatively the fusilier ID may be passed on immediately . Of course if none of the light fields of train is successful in creating an entanglement an LLEC fail message is returned.

As there is only one target Q block the handling of left LLE parity information is the same as previously described for the repeater.

As with the arrangement rather than sequentially firing the fusilier Q blocks of repeater QR an equivalent result can be achieved by firing them all together but using different lengths of fibre to connect each fusilier Q block to the optical merge unit thereby introducing different delays and creating the light field train .

The number of fusilier Q blocks in the firing squad is preferably chosen to give a very high probability of successfully entangling target Q block at each firing of the firing squad for example 99 or greater. More particularly if the probability of successfully creating an entanglement with a single firing of a single fusilier Q block is s then the probability of success for a firing squad of f fusilier Q blocks will be Firing squad success probability 1 1 whereby for s 0.25 16 fusilier Q blocks will give a 99 success rate and 32 fusilier Q blocks a 99.99 success rate. Typically one would start with a desired probability Pof successfully entangling the target qubit with a single firing i.e. a single light field train and then determine the required number f of fusilier qubits according to the inequality 1 1 

The same formulae also apply to the arrangements of with f being set to the value of q in respect of those arrangements .

The time interval between adjacent light fields in the train is advantageously kept as small as possible consistent with giving enough time for the earlier light field to be measured the target qubit reset and its shutter opened before the later light field arrives. By way of example the light fields are spaced by 1 10 nanoseconds.

It may be noted that when using a LLE creation subsystem that provides a high probability of success it becomes practical to assume that every triggering of the LLE creation subsystem is successful and to simplify the overall control paradigm so that a repeater only initiates the creation of a right LLE upon becoming the operative repeater. In this case the overall time taken to successfully create an E2E entanglement becomes substantially constant and the left end node can therefore be arranged to start the building of a new E2E entanglement after this time rather than relying on the RL MC E2E succeeded and E2E failed messages to indicate when the building of a new E2E entanglement can be started. Since as already noted above detection of failed E2E entanglements can be left to the consuming applications it now becomes possible to dispense with the RL MC E2E succeeded and E2E failed messages entirely.

In the quantum repeater right LLE creation attempts are triggered by timeout of an existing right LLE consumption in a merge operation of an existing right LLE or failure of a previous right LLE attempt. This results in a period at least as long as the light speed round trip time to the left neighbour node in which no right LLE is available.

An alternative strategy is possible that reduces this non availability period in most cases more particularly right LLE creation attempts are not triggered by need but happen continually for example with a periodicity that is a fraction of the round trip time. A currently existing right LLE is not disturbed by a new creation attempt but left available for use in a merge operation. However whenever a successful right LLE creation attempt is reported the new right LLE replaces the pre existing one as the LLE waiting to be merged the pre existing right LLE being abandoned and the Q blocks associated with it being freed up for re use. The right LLE waiting to be merged will therefore always be relatively fresh and timeouts will be very unlikely. Also if the waiting right LLE does get consumed in a merge operation an LLE creation attempt will already be underway unless the periodicity is less than or equal to the round trip time and the merge takes place just after a right LLE creation attempt is initiated .

Of course reduction in the right LLE non availability period in this way comes at a cost this being the need for sufficient Q blocks to support a waiting right LLE as well as one or more on going right LLE creation attempts.

By way of example shows an adaptation of the arrangement that can be used for implementing the above strategy the same references are used in as in for elements which are substantially the same . More particularly rather than the R side Q blocks of repeater QRbeing fired once in quick succession in response to a Fire signal the R side Q blocks are sequentially and cyclically fired that is in each of an endless succession of cycles the R side Q blocks are each fired once one after another at equal time intervals throughout the cycle however the R side Q block associated with the current waiting right entanglement is not fired the ID number of this Q block being stored in a register to indicate its non availability to participate in right LLE creation attempts . At repeater QR the optical switch is cyclically switched such as to pass the incoming light fields to the appropriate L Q blocks of repeater QR. Each successful entanglement is reported to the repeater QRin a LLEC success message which also includes the ID of the Q block concerned. At the repeater QRthis ID number replaces that of the previous waiting right LLE in register to indicate the non availability of the identified Q block to participate in the next right LLE creation attempts the replacement in register of the ID associated with the previous waiting right LLE freeing up the Q block concerned for re use.

The repeater QRalso needs to keep track of which Q block is not available as a result of being used for the current waiting right LLE. By simply arranging for the cyclic firing of the Q blocks of repeater QRto involve doing nothing at the point when it is would otherwise be firing the Q block associated with the current waiting right LLE so that in each cycle there is a gap in the regular firing of the Q blocks the optical switch can simply cycle round in correspondence to the firing cycle of the Q blocks without needing to know which Q block is unavailable since there will be no light field presented in respect of the unavailable Q block.

Since more than one LLE may exist at any given moment it is necessary for parity information on multiple LLEs to be stored. One example way of doing this is to arrange for the L side of repeater QRto be able to store parity data on all possible LLEs the repeater being in due course informed by the repeater QRin a merge succeeded message which LLE has been used in a merge and therefore which LLE parity data needs to be included in the cumulative parity information.

With q L Q blocks and q R Q blocks and a round trip time of T the gap between successive creation attempts is on average T q 1 .

It is also possible to operate the arrangement in the same manner that is rather than waiting for a need based trigger timeout of an existing right LLE consumption in a merge operation of an existing right LLE or failure of a previous right LLE attempt the firing squad can be fired at regular or irregular intervals unrelated to need.

Where multiple Q blocks are provided on both sides of an LLE creation subsystem as in the arrangements of and the possibility arises of more than one LLE existing at the same time between the nodes concerned. In the arrangements of and up to q LLEs may be created at each attempt though only one is selected to endure whereas in the arrangement there is a brief overlap in the existence of two LLEs before the later created one replaces the earlier created one. Rather than abandoning excess LLEs that is LLEs beyond the one waiting to be merged one some or all of these excess LLEs can be kept in reserve banked in a queue and so immediately available to become the waiting LLE when the previous LLE fulfilling this role is merged or times out. This of course requires the relevant Q blocks to be unavailable to participate in LLE creation which can be readily achieved by using a non available ID register similar to the register of .

The second Extend from End quantum repeater embodiment employs such an LLE banking arrangement and will next be described.

The second Extend from End quantum repeater embodiment is shown in it being understood that the quantum repeater operates in the context of being an intermediate node in a chain of nodes such as depicted in between the left and right end nodes of which E2E entanglements are to be created.

The second quantum repeater embodiment of is similar in form and operation to the first quantum repeater embodiment of and the same references are used in as in for elements which are substantially the same. The main differences between the first and second embodiments is that in the second quantum repeater embodiment 

The details of the form of LLE creation subsystems and of which the L side and R side Q blocks respectively form a part and of the L LLE and R LLE control units and are described below. The merge control unit and its associated fibre interface of the quantum repeater operate substantially in the same way as the merge control unit and fibre interface of the quantum repeater apart from the inclusion of Q block ID information in various messages and signals accordingly the description of these elements will not be repeated in respect of the quantum repeater though the main differences will be described .

The arrangement is effectively a combination of the arrangements of further adapted to enable the creation and banking of multiple LLEs. Thus as with the arrangement in the arrangement the R side Q blocks are continually sequentially and cyclically fired except that is for any R side Q block associated with an existing banked entanglement. At repeater QR all the incoming light fields are directed by the optical switch to the same Q block as in the arrangement until a successful entanglement is created whereupon the optical switch is switched to pass the incoming light fields to a new available un entangled L side Q block . Each successful entanglement is reported to the repeater QRin a LLEC success message which also includes the ID of the L side Q block concerned. The availability status of the R side Q blocks and of the L side Q blocks are respectively tracked by the R LLE control unit and L LLE control unit .

It may be noted that the above described feature of switching incoming light fields to a new un entangled target L side Q block upon an existing target Q block becoming entangled can also be used with the firing squad arrangement of that is multiple target Q blocks are provided only one of which serves as the current target this current target being changed immediately it becomes entangled. Operating in this way ensures an efficient use of the light fields fired by the firing squad .

The operation of the LLE control units and will next be described in terms of the interaction of their principle components rather than in terms of a controlling state machine. Considering first the R LLE control unit this comprises a firing control unit R an R side timeout monitor R an available non available status register R an R side Entangled queue R which is a FIFO queue and a status control unit R that controls the status register R and the R side entangled queue R.

The status register R maintains an entry for each R side Q block these entries being indexed by Q block ID. Each entry comprises for the Q block concerned an available not available bit and a qubit Capture interaction time for the last LLE creation Capture interaction of the Q block unless the LLE creation attempt concerned has been reported as having failed.

The firing control unit R controls the cyclic sequential firing of the R side Q blocks and in doing so refers to the status register to determine which Q blocks are available for firing. Whenever the firing control unit R fires a Q block the status control unit sets corresponding available not available bit of the register R to not available .

The LLEC success and fail messages received from the right side neighbour node are passed to the status control unit . Each of these messages includes an indication of the ID of the R side Q block concerned and for success messages also the ID of the L side Q block involved.

If an LLEC fail message is received the control unit R sets the available not available status register bit of the Q block explicitly or implicitly identified in the message to available . However if an LLEC success message is received the available not available status register bit of the Q block concerned is not changed instead the control unit R places the ID of the R side and L side Q blocks concerned in the R Entangled queue R. If this entry is now the current head entry the control unit R sends an R entangled signal to the merge control unit if the entry is not the current head entry no such signal is sent the entry simply being queued.

The timeout monitor R continually monitors the age of the qubit of the R side Q block at the head of the queue R by comparing the qubit Capture interaction time stored for this Q block in the status register with the current time. When the qubit times out the control unit R is informed which thereupon deletes the head entry of the queue R and sets the corresponding available not available bit of the register R to available . If there is no other entry in the queue that can be moved up to the head of the queue the control unit R sends a R expired signal to the merge control unit .

The status control unit R is also arranged to receive the Reset R signals from the merge control unit . Two types of Reset R signal are provided by the merge control unit in this embodiment the first type here called the Reset All R signal is produced in response to the receipt of an RL MC EchoMe message by the merge control unit whereas the second type here called the Reset Head R signal is produced in all other cases. On receiving a Reset All R signal the control unit R deletes all entries in the queue R and resets all entries in the register R to indicate all Q blocks as available . On receiving a Reset Head R signal the control unit R deletes the head entry of the queue R and sets the corresponding available not available bit of the register R to available if there is another entry in the queue R that can be moved up to the head of the queue the control unit R sends a R entangled signal to the merge control unit .

The overall effect of the above described operation of the R LLE control unit is to queue right LLEs in queue R the merge control unit simply being told when the queue ceases to be empty R entangled signal and when it becomes empty again R expired signal . The R side Q blocks of the queued LLEs are unavailable for firing by the firing control unit R.

Considering now the L LLE control unit this comprises a target control unit L an L side timeout monitor L an available non available status register L and a status control unit L that controls the status register L.

The status register L maintains an entry for each L side Q block these entries being indexed by Q block ID. Each entry comprises for the Q block concerned i an available not available bit ii a qubit Transfer interaction time for the last successful LLE creation Transfer interaction of the Q block and iii parity information for the last successful LLE creation Transfer interaction of the Q block

The target control unit L controls the optical switch in dependence on the Q block availability data in the status register L so that incoming light fields are all passed to the same available L side Q block until its status changes to not available whereupon a new available Q block is selected as the target. The switch setting remains unchanged unless otherwise commanded by the target control unit L.

The Results signals L entangled L not entangled from the current target Q block are passed to the status control unit L which send corresponding LLEC success and fail messages to the left neighbour node. Each of these messages includes an indication of the ID of the R side Q block concerned derived for example from the time of arrival of the light field concerned in the current firing cycle or by the light field s counted position in the cycle in addition for success messages the ID of the L side Q block involved is also included. No other action is taken by the control unit L when receiving a L not entangled signal. However when the control unit L receives an L entangled signal the control unit L sets the available not available status register bit of the Q block concerned to unavailable thereby causing the target control unit L to select a new available Q block as the target the status control unit L also enters the current time into the status register entry as the Transfer interaction time for the Q block just entangled and stores left LLE parity information.

The timeout monitor L continually monitors the age of the oldest non available Q block in the status register L by comparing the qubit Transfer interaction time stored for this Q block with the current time. It is noted that the way the current repeater embodiment works only this qubit and Q block amongst L side ones could be participating in a L side entanglement that is rooted in the left end node. When the qubit times out the control unit L is informed which sets the corresponding available not available bit of the register L to available the control unit L also sends a L expired signal to the merge control unit .

The status control unit R is also arranged to receive the Reset L signals from the merge control unit . As for the Reset R signal in the present embodiment there are two types of Reset L signal provided by the merge control unit the first type here called the Reset All signal is produced in response to the receipt of an RL MC EchoMe message by the merge control unit whereas the second type here called the Reset This L signal is produced in all other cases and includes a specific L side Q block ID. On receiving a Reset All L signal the control unit L resets all entries in the register L to indicate all Q blocks as available . On receiving a Reset This L signal the control unit L sets the available not available status register bit for the identified L side Q block to available .

The overall effect of the above described operation of the L LLE control unit is that the L side Q blocks of the queued entanglements are unavailable for selection as a target Q block by the target control unit L.

With regard to the operation of the merge control unit as already mentioned this is substantially the same as for the merge control unit of the embodiment. The main difference is that the LR MC messages merge succeeded and merge failed both contain the ID of the L side Q block concerned that is the involved Q block of the right neighbour node of the operative quantum repeater sending the message . In the case of a merge failed message this enables the merge control unit of the receiving quantum repeater to identify to the L LLE control unit of the repeater in an Reset This L signal the L side Q block to be reset as available . In the case of a merge succeeded message the included L side Q block ID tells the merge control unit which L side Q block is to be used when the repeater is ready to perform a merge the identity of the R side Q block to be used for the merge is retrieved when needed from the R LLE control unit this ID being the R side ID contained in the head entry of the queue R.

After receiving a merge succeeded LR MC message the merge control unit will in due course attempt to effect a merge after which it will signal the LLE control units to reset the Q blocks concerned regardless of the outcome of the merge the merge control unit will of course already have the L side ID it needs for inclusion in the Reset This L signal it outputs the corresponding right side signal Reset Head R does not require the ID of the R side Q block to be reset as this can be obtained from the head entry of the queue R . If the attempted merge was successful the merge control unit sends an LR MC merge succeeded message that not only serves to tell the left neighbour repeater that it is now the operative repeater but also to inform it of the ID of its L side Q block forming the current right hand end of the entanglement being extended from the left end node the relevant L side Q block ID is inserted into the LR MC merge succeeded by the merge control unit after it has retrieved the ID from the head entry of the queue R. which it does prior to sending the Reset Head R signal .

As regards parity information when the MC unit receives a merge succeeded message it updates the cumulative parity information in the message by combining the received cumulative parity information with i the parity of the left LLE involved in merge to which the message relates this information being retrieved from the status register L based on the L side Q block ID included in the received merge succeeded message and ii merge parity information for the merge subsequently carried out by the repeater.

It will be apparent from the foregoing that in the quantum repeater embodiment there is a good chance that as soon as a right LLE is used up in a merge operation or expires there will be another right LLE immediately ready to use this LLE having been banked in the queue R.

Banked LLEs can also be used in the process known as purification . Purification raises the fidelity of an entanglement by combining two entanglements via local quantum operations and classical communication into one higher fidelity pair.

With respect to the form and operation of the end nodes of a chain of nodes with intermediate repeater nodes of the form persons skilled in the art will by reference to the foregoing description of the repeater be able to determine the adaptations needed to the left and right end nodes described above in relation to the repeater of .

Where as for the embodiment there are multiple L side and or R side Q blocks in an LLE creation subsystem resulting in one or both of the associated end nodes having multiple Q blocks then if such a multi Q block end node is to be provided with an output buffer into which E2E entanglements can be shifted as described above with reference to the arrangement depicted in can usefully be employed to avoid the use of an n m optical switch that would otherwise be required to interface the multiple L side R side Q blocks with the multiple Q blocks of the output buffer.

More particularly depicts a left end node having an R side substantially as in the LLE creation subsystem with n R side Q blocks optically coupled through an optical merge unit and local link fibre to a chain of repeater nodes. The end node also includes an output buffer of the form with m Q blocks and an optical merge unit . To avoid the use of an n m optical switch to optically couple any one of the R side Q blocks to any one of the output buffer Q blocks an intermediary Q block is provided. The Q blocks and all have Capture interaction functionality whereas the intermediary Q block has Transfer interaction capability. A 1 2 optical switch enables the output of the optical merge unit to be switched between the local link fibre and a loopback fibre that feeds an input of the optical merge unit . This arrangement permits any selectively fired one of the R side Q blocks or any selectively fired one of the output buffer Q blocks to be coupled to the intermediary Q block . As a result the left end of an E2E entanglement anchored in one of the R side Q blocks can be shifted across to the intermediary Q block and from there shifted into a selected one of the output buffer Q blocks both shifts being effected by an elongate operation see alternatively the selected output buffer Q block can first be entangled with the intermediary Q block and a merge operation then effected between the latter and the R side Q block anchoring the E2E entanglement.

Although the end node depicted in is a left end node with multiple R side Q blocks the same approach can be used for a right end node with multiple L side Q blocks.

It will be appreciated that many variants are possible to the above described embodiments of the invention.

For example where LLE creation subsystems of the form are employed to give a high probability of successfully creating entanglements at each firing then it would be possible to operate the quantum repeater on the basis that a right LLE is assumed to have been created a predetermined time after firing of the firing squad this predetermined time being the transit time of the light train to the target qubit plus the time length of the light train and its herald . Transition from Pending state to Right Entangled state in can thus be triggered on a time basis rather than receipt of an LLEC success message this leads to a local merge operation being triggered when both a token has been received from the left neighbour node making the repeater the operative repeater and a right side qubit is expected to have been entangled with a qubit of the right neighbour node as opposed to the existence of this latter entanglement having been confirmed by a success message . In fact for the embodiment this variant is largely irrelevant as it is still necessary to await information from the right neighbour node enabling identification of the fusilier qubit that has been entangled and this information itself is effectively a success message. However for the modification of the embodiment discussed above in which the direction of LLE creation light field travel is made right to left while E2E entanglements are still built from the left end node there is only one R qubit a target qubit in the quantum repeater so now a merge operation can be triggered once both the repeater is the operative repeater and the light field train from the firing squad in its right neighbour node has been fully received. Unfortunately this generally is also of no particular advantage as knowledge of when the light field train has been fully received will not be earlier than when the result of the LLE creation attempt would in any case be known at the repeater through measurement of the target qubit.

For various reasons it may be desirable to arrange for the merging of leftward and rightward entanglements that is effected by a quantum repeater each cycle to be carried out through the intermediary of one or more local qubits intermediate qubits rather than directly by carrying out a merge operation of the form described above on the relevant repeater L side and R side qubits. For example where one intermediate qubit is provided the leftward and rightward entanglements can be separately extended to the intermediate qubit by respective elongate operations involving the entangled L side R side qubit as appropriate and the intermediate qubit thereafter the intermediate qubit is removed from entanglement by performing an X measurement operation upon it. It will be appreciated that the details of how the local merging of a repeater s leftward and rightward entanglements is effected is not critical to the general manner of operation of a quantum repeater operating on the Extend from End basis.

With regard to the implementation of the LLE control units and the merge control unit it will be appreciated that typically the described functionality will be provided by a program controlled processor or corresponding dedicated hardware. Furthermore the functionality of the LLE control units and the merge control unit may in practice be integrated particularly in cases where the LLE control unit functionality is minimal. Of course the division of control functionality is to a degree arbitrary however LLE control functionality merits separation into the LLE control units because in certain repeater embodiments LLE creation is free running that is uncoordinated with higher level operations such as merge control. Overlying the LLE control functionality is the control functionality associated with merge control and the control of token passing this latter control functionality effectively provides fop level control of the repeater and can be considered as being provided by a top level control arrangement in the described embodiments this is formed by the merge control unit though it would also be possible for the token passing control to be separated out from the merge control unit into its own distinct control unit .

Although in the foregoing description light fields have generally been described as being sent over optical fibres both between nodes and between components of the quantum physical hardware of a repeater it will be appreciated that light fields can be sent over any suitable optical channel whether guided as with an optical waveguide or unguided straight line and whether through free space or a physical medium. Thus for example the optical fabric of the quantum physical hardware of a repeater may comprise silicon channels interfacing with a qubit provided by a nitrogen atom in a diamond lattice located within an optical cavity.

As already indicated persons skilled in the art will understand how the Q blocks can be physically implemented and relevant example implementation details can be found in the following papers herein incorporated by reference 

