---

title: Discrete fourier transform (DFT) analysis for applications using iterative transform methods
abstract: According to various embodiments, a method is provided for determining aberration data for an optical system. The method comprises collecting a data signal, and generating a pre-transformation algorithm. The data is pre-transformed by multiplying the data with the pre-transformation algorithm. A discrete Fourier transform of the pre-transformed data is performed in an iterative loop. The method further comprises back-transforming the data to generate aberration data.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08285401&OS=08285401&RS=08285401
owner: The United States of America as represented by the Administrator of the National Aeronautics and Space Administration
number: 08285401
owner_city: Washington
owner_country: US
publication_date: 20090828
---
The invention described herein was made by an employee of the United States Government and may be manufactured and used by or for the Government of the United States of America for governmental purposes without the payment of any royalties thereon or therefor.

The present invention relates generally to digital signal processing and more particularly to a faster method of performing the discrete Fourier transform and the fast Fourier transform in applications using iterative transform methods.

Fourier analysis is a family of mathematical techniques based on decomposing signals into sinusoids. The discrete Fourier transform DFT is the family member that can be used with digital signals and digital signal processing. A DFT can decompose a sequence or set of data values into components of different frequencies. In calculating each of the components real and imaginary pairs of the Fourier transform one must use all N vectors of the sampled set. As is known in the art the total computation time of the DFT is the total number of operations N N or N. While the DFT is useful in many fields computing it directly from the definition can often be too slow to be practical.

A fast Fourier transform FFT is a way to compute the same result as the DFT more quickly. Through the use of interlace decomposition an FFT can compute approximately the same result as the DFT in N log N operations. Still this number of computations can often be slow and take up large amounts of processing time. A need exists to overcome the deficiencies of the DFT and the FFT.

According to various embodiments the present teachings provide an improved method for performing the discrete Fourier transform. By pre transforming the data performing the DFT and then back transforming the data the method described herein can compute the DFT in a total of N operations. The present teachings describe the matrix form of the discrete Fourier transform DFT and the hybrid index notation of Schouten is introduced as a method for performing the DFT calculations in a complex vector space. The similarity transformation is presented in detail for a multi dimensional DFT example 4 4 array size and then applied to illustrate how the DFT can be carried out in a diagonal basis using the hybrid index notation of Schouten.

According to various embodiments an optical system is provided that is adapted to collect optical data for example imaging data. The optical system can comprise a signal processor configured to carry out the DFT calculations described herein. By pre transforming the data once at the beginning of the calculation and back transforming the data at the end of the calculation the DFT can be implemented as a one dimensional vector product using just N operations compared to the N log N operations needed by the fast Fourier transform FFT counterpart. The pre and back transforms are implemented using the DFT similarity transform and the inverse of the DFT similarity transform. In some embodiments the calculation can be implemented using arbitrary frequency spacings.

According to various embodiments of the present teachings a method is provided for determining aberration data for an optical system. An optical system can be configured to perform the method. The optical system can comprise a signal processor for example one or more computers. The optical system can further comprise a control unit that can be operably linked to the signal processor. The optical system can be launched into space prior to collecting data for example prior to collecting intensity data. The optical system can comprise a telescope. In some embodiments the telescope can comprises one or more optical components and at least one of the optical components can be configured to move. The optical components can comprise at least one mirror lens servo mechanism prism beam splitter photomultiplier tube detector or a combination thereof. The control unit can be configured to control the movement of at least one of the optical components. The method can comprise collecting data generated by the optical system for example intensity data light imaging data thermal imaging data or another type of data.

According to various embodiments the method can comprise performing various calculations on the data. For example a similarity transform and an inverse of the similarity transform can each be calculated based upon the data. In some embodiments a discrete Fourier transform matrix can be calculated on the data. The method can comprise pre transforming the data using the similarity transform and the inverse of the similarity transform to generate pre transformed data. The method can perform an iterative transform operation on the pre transformed data using the processor by multiplying the pre transformed data by the discrete Fourier transform matrix for example for a predetermined number of times to generate iteratively transformed data. The method can back transform the data using the signal processor by multiplying the data by either the similarity transform or the inverse of the similarity transform to form aberration data. The aberration data can be outputted to a user for example on a display such as a graph and or the aberration data can be printed out.

In some embodiments the method can comprise generating correction data based upon the aberration data. In some embodiments the optical system can be adjusted using the correction data for example an adjustment can be made to the orientation of an optical component under the control of the control unit. The aberration data can pertain to at least one of a piston aberration a tip aberration a tilt aberration a defocus aberration an astigmatism aberration a coma aberration a spherical aberration and a trefoil aberration.

In some embodiments the iterative transform operation can comprise iteratively performing a phase retrieval operation on the pre transformed data. The method can further comprise generating phase correction data and the optical system can be adjusted using the phase correction data for example to overcome phase errors and provide an image that is in greater focus. For example the correction data can comprise information that can adjust one or more optical components of the optical system to thereby compensate for aberrations in the data.

According to various embodiments the signal processor can be configured to generate correction data based upon the aberration data. The control unit can be configured to adjust the optical system based upon the correction data. The optical system can comprise a telescope and the telescope can comprise one or more optical components. The one or more optical components can comprise at least one of a mirror lens servo mechanism prism beam splitter photomultiplier tube detector or a combination thereof. In some embodiments the optical system can comprise a focusing system. In some embodiments the optical system can comprise a beam generating device such as a laser beam generating device and a sighting system for the beam generating device.

According to various embodiments the discrete Fourier transform calculation can be applied in diagonal form. The diagonal form introduces a transformation of basis by an application of the similarity transform of linear algebra. In doing so a more efficient implementation of the DFT for applications using iterative transform methods can be achieved. The present teachings can be used in the field of signal processing for example the method can be used with phase retrieval for determining the phase error or aberrations in an optical system.

Performance of optical systems such as those found in cameras telescopes microscopes and other systems for the collection of images can often be improved by actively correcting for aberrations in the optical system. Wavefront sensing is a technique that can be used to obtain phase information from a wavefront to recover such aberrations. According to various embodiments of the present teachings a method is provided for determining aberration data for an optical system. An optical system configured to perform the method is also provided. The optical system can comprise a signal processor. The optical system can comprise a telescope. The optical system can further comprise a control unit that can be operably linked to the signal processor and for example an optical component of a telescope. The optical system can be launched into space prior to collecting intensity data. In some embodiments the telescope can comprise one or more optical components and at least one of the optical components can be configured to move. The optical components can comprise at least one mirror lens servo mechanism prism beam splitter photomultiplier tube detector camera or a combination thereof. The control unit can be configured to control movement of at least one of the optical components. The method can comprise collecting data generated by the optical system for example intensity data light imaging data thermal imaging data or another type of data.

According to various embodiments the method can comprise performing various calculations on collected data. For example a similarity transform and an inverse of the similarity transform can be calculated based upon the data. In some embodiments a discrete Fourier transform matrix can be calculated on the data. The method can comprise pre transforming the data using the similarity transform and the inverse of the similarity transform to generate pre transformed data. The method can perform an iterative transform operation on the pre transformed data using the processor by multiplying the pre transformed data by the discrete Fourier transform matrix a predetermined amount of times to generate iteratively transformed data. The method can back transform the data using the processor by multiplying the data by one of the similarity transform and the inverse of the similarity transform to form aberration data. The aberration data can be outputted to a user for example on a display such as a graphical display.

In some embodiments the method comprises generating correction data based upon the aberration data and adjusting the optical system using the correction data. The aberration data can pertain to at least one of a piston aberration a tip aberration a tilt aberration a defocus aberration an astigmatism aberration a coma aberration a spherical aberration and a trefoil aberration. In some embodiments the iterative transform operation can comprise iteratively performing a phase retrieval operation on the pre transformed data. The method can further comprise generating phase correction data. The optical system can be adjusted using the phase correction data to thereby overcome phase errors and provide an image that is in greater focus. For example the correction data can comprise information that can adjust one or more optical components of the optical system to thereby overcome for aberrations in the data.

According to various embodiments the signal processor can be configured to generate correction data based upon the aberration data. The control unit can be configured to adjust the optical system based upon the correction data. The optical system can comprise a telescope wherein the telescope can comprise one or more optical components. The one or more optical components can comprise at least one of a mirror lens servo mechanism prism beam splitter photomultiplier tube detector camera or a combination thereof. In some embodiments the optical system can comprise a focusing system. In some embodiments the optical system can comprise a beam generating device such as a laser beam generating device and a sighting system for the beam generating device.

According to various embodiments phase retrieval is just one example where the method of the present teachings can be applied but it will be appreciated that the method of the present invention is not limited to phase retrieval and can instead be utilized in various digital signal processing methods. The method can be used anytime a transform of data from the time or spatial domain to the frequency domain is desired. The method of the present teachings can also be used anytime a transform of data from a frequency domain to the time or spatial domain is desired. In some embodiments the method of the present teachings can be utilized in an optical system. The optical system can comprise one or more of a control unit a signal processor an optical unit a telescope and or a combination thereof. In some embodiments the optical system can comprise a space telescope for example the National Aeronautics and Space Administration s NASA s Hubble Telescope and NASA s James Webb Space Telescope JWST .

According to various embodiments the optical system can be configured to collect optical data for example intensity data. The optical system can comprise an optical unit for example the fine guidance sensors of the Hubble Space Telescope. The optical unit can comprise one or more mirrors lenses servo mechanisms prisms beam splitters photomultiplier tubes detectors cameras or a combination thereof. In some embodiments the optical unit can be disposed on a space telescope that is orbiting the earth. The optical system and or the optical unit can be manipulated by a user from the ground through the use of various wireless communication methods and wireless communication networks. A user can manipulate the optical system to adjust or move various optical components within the optical system. This feature can allow for a user to adjust the optical system to overcome aberrations obscurations or other errors that can result from one or more of the components of the optical system becoming displaced for example during launch of a rocket carrying a space telescope that comprises the optical system.

As is known in the art to transform a digital signal from one domain to another the discrete Fourier transform can be used. Diagonalizing the DFT matrix the DFT eigen problem can be a useful equation in transforming data in the field of signal processing. The matrix can be either one dimensional or two dimensional. Diagonalizing the DFT matrix is described for example in J. H. McClellan et al. Eigenvalue and Eigenvector Decomposition of the Discrete Fourier Transform IEEE Trans. on Audio and Electroacoustics Vol. AU 20 1 3 pp. 66 74 1972 L. Auslander et al. Is computing with the finite Fourier transform pure or applied mathematics Bull. Amer. Math. Soc. Vol. 1 pp. 847 891 1979 and B. W. Dickinson et al. Eigenvectors and Functions of the Discrete Fourier Transform IEEE Trans. Acoust. Speech Signal Processing Vol. ASSP 30. 1 2 pp. 25 31 1982 all of which are incorporated herein by reference in their entireties.

Some aspects of the problem are related to topics in number theory that are solved by Gauss as described in E. Landau Vol. I. New York Chelsea 1927 1950 reprint p. 164 as described in L J. Good Analogues of Poisson s Summation Formula Amer. Math. Monthly Vol. 69 pp. 259 262 1962 and J. H. McClellan Comments on Eigenvalue and eigenvector decomposition of the discrete Fourier transform IEEE Trans. on Audio and Electroacoustics Vol. AU 21 p. 65 1973 all of which are incorporated herein by reference in their entireties. For some applications for example phase retrieval the diagonal structure of the DFT is exploited in a special way particularly when certain parts of the calculation do not have to be repeated at each iteration.

Described herein are algorithms and equations that are useful in calculating a pre transformation and a back transformation of a digital signal. By pre transforming the data performing the DFT in diagonal form and then back transforming the data the discrete Fourier transform can be performed faster than the FFT for certain applications.

According to various embodiments the DFT calculation can be implemented in matrix form for example as 

According to various embodiments and as previously set forth the DFT can be represented as a unitary transformation in a complex vector space. The calculations can be performed using the tensor transformation formalism described by Schouten. Schouten s hybrid index notation can provide a natural framework for the DFT calculations in a complex manifold. One goal in the kernel index approach can be to give a more general representation of the DFT calculations by identifying components with quantities of a geometric manifold. Often but not always such identification can lead to alternative or more efficient calculation strategies that are discussed herein. By adopting a notation that makes the transformation rules of a quantity explicit the meaning of the calculations can often be clarified and the notation can serve as an efficient bookkeeping device for checking consistency throughout the calculations.

According to various embodiments the DFT can be defined as a unitary transform between conjugate Fourier domains. The one dimensional DFT transform can be expressed using Schouten s hybrid index notation as and using the Einstein sum convention defined over a repeated indices in an upper lower combination the transform can be expressed as 

According to various embodiments the complex conjugate of the DFT using the hybrid index notation can be expressed as where the over bar can denote the complex conjugation of components and kernel symbols in accordance with Schouten s hybrid index notation. Further . The conjugation of indices and kernel objects can be used for calculations of the DFT transform. In some embodiments the data values can be labeled by a contravariant component f and by complex conjugation of the kernel symbol and indices in various combinations several other types of components can be represented in Schouten s notation by the raising and lowering of indices using the fundamental or metric tensor for example where the latter two can follow by complex conjugation of the first two. Contravariant component fand its inverse can be defined as and as mentioned above covariant and contravariant transformation rules can be switched back and forth using the metric or fundamental tensor a to raise or lower indices as appropriate. The metric tensor can define how the differential element of distance can be calculated in the geometric manifold as well as the inner product between two vectors for example uand v thus . The metric for raising and lowering indices can be represented as 

 b the result in a can be complex conjugated to give and therefore. A comparison can be made in matrix boldface notation where T defines the transpose operation that is well known in the art. The matrix bold face notation illustrates a degree of non generality in the way the adjoint can be calculated in matrix notation. Specifically defining the adjoint using components in a geometric manifold using steps a and b above can give different results than complex conjugating and then performing the transpose operation using the T . In special coordinates 

According to various embodiments because the W are unitary the inverse can be defined using the adjoint and can be expressed as 

In some embodiments in tensor transformation theory there can be geometric meaning attributed to these differing but complementary transformation rules. Specific transformations can be defined by an allowable group of transformations for example G. The corresponding allowable transformations of basis for the DFT application in digital signal processing can include fractional and integer shifts of the data origin in addition to scaling and phase transformations. The details for these various transformations are discussed herein.

According to various embodiments when calculating with components index order is important for proper matrix multiplication and thus it is desirable to adopt the following convention for a rank 2 quantity 

According to various embodiments various geometric quantities can be defined that can be distinguished by their transformation rules using index position. For example a group of allowable transformations G can be introduced and then several invariant quantities can be constructed based on invariance of a given symmetry group. One such quantity can be the metric tensor that can define distance in the manifold and can also define the inner product between any two vectors. The DFT metric tensor can be solved for postulating the unitary invariance under the action of the point transformation W as illustrated below. The Wcan be defined as a unitary transformation and a metric tensor can be defined by invariance under the action of the Wtransformation such that or in matrix form Quantities that are invariant under the action of the unitary group can be hermitian and thus the acan satisfy The introduction of a hermitian metric ainto the Egeometric manifold defines the manifold as a Uwhich differs from the earlier notation used by Schouten where this manifold was labeled as the tilde over R . General Form of Parseval s Theorem

According to various embodiments Parseval s theorem can be implied by unitary invariance and not necessarily energy conservation as it is commonly referred to in the art. Consider the magnitude squared of F F that can be represented as . Substituting the DFT transformation rule from the hybrid index notation equation we have but since the acan be invariant under this unitary transformation the right hand side can be simplified to . Parseval s theorem is seen to hold for any solution of the a as amplified by unitary invariance and thus in general . The common form of Parseval s theorem can be expressed in vector notation as .

In some embodiments the standard DFT approach can be a special solution for example a coordinate system such that for the agiven by the Kronecker delta 

According to various embodiments the can be a solution for the aand can correspond to a positive definite signature solution. The approach taken here can be motivated by that fact that in general an eigen problem requires the use of a general metric and by no means does this necessarily correspond to the Kronecker delta in a unitary complex vector space U. Below is described how the Kronecker delta solution is used to make progress on the main point of calculating the DFT in a diagonal basis and for easy comparison with previously published results.

By postulating unitary invariance of the metric one can solve for the a. The Wcan be identified with as The W as previously set forth. Therefore The Wcan be represented as 

According to various embodiments the solution can be checked by substituting the general solution back into the metric tensor. This verifies that this a is invariant under the action of the Wfor arbitrary but real numerical values of xand x. According to various embodiments an infinite number of solutions can exist for the 2 2 metric a as implied by unitary invariance in terms of two real parameters. One possible solution is the special case of when x 0 and x 1 giving the Kronecker delta as mentioned earlier 

According to various embodiments and as mentioned previously there are an infinite number of solutions for the a. Examples of such solutions can be the following based on various choices for the xand xcomponents 

According to various embodiments several other quantities can be derived from the fusing the a and comparing the right hand sides of the previous equations as expected the result is f . Correspondingly various other Fquantities can be given by

According to various embodiments further restrictions can be placed on the solution values for the xand x by classifying aas being positive definite negative definite or indefinite corresponding to the number of values that are greater than zero less than zero or mixed respectively along the diagonal of the a. When ais definite there is no distinction between the various quantities that can be derived from ain the U and thus numerical distinctions do not have to exist for components labeled by upper lower indices or even the complex conjugation of indices. Because acan be used to solve the eigen problem there can be different solutions for the eigen problem corresponding to different solutions for the a. Different solutions for the acan lead to different DFT eigen quantities but all the while preserving unitary invariance and the hermitian character of the a. From the perspective of the transformation theory of complex vector spaces one can regard some properties of the DFT as deriving from the characteristics of the a for example a acan be invariant under unitary transformations and b is hermitian. Condition b can be derived from a but it can be convenient when solving for the acomponents to regard b as an independent condition.

In some embodiments the solution to acorresponding to larger dimensional data sets can be solved for. Solutions where the aare complex valued can provide consistency checks on the proper use of Schouten s notation. By deriving a 4 4 Wand its inverse that can be represented as 

According to various embodiments the condition for unitary invariance can provide a simultaneous system of 16 equations and 32 unknowns which can be further reduced to six free parameters by imposing the hermitian condition on the a. After considerable algebra the general solution for the a constrained by the hermitian condition can be represented as 

There are an infinite number of both real and complex valued 4 4 solutions for the ain terms of the six free parameters. Several example solutions corresponding to basic numerical values for the x and y components can be the following 

For exemplary purposes a solution can illustrate a few of the basic quantities that are derived for the DFT in Schouten s notation. For generality consider the following complex valued solution for the a 

As previously set forth multiple solutions for the aexist based on unitary invariance and thus more general calculations of the DFT and its various quantities can be extended to arbitrary basis sets. The additional generality stems from the possibility that the metric tensor does not necessarily have to be the Kronecker delta. As is known in the art the eigenvalue eigenvector problem eigen problem seeks solutions to the following set equations 

In some embodiments the metric tensor can be used to show that the eigen problem can be equivalently expressed in the form 

According to various embodiments it is known in the art that because the eigenvalues for the DFT matrix for N 3 are non unique and are multiples of the so called roots of unity 

As discussed above the significance of W I for the DFT eigenvalue problem can be that degenerate eigenvalues appear for N 4. The multiplicities of these eigenvalues are defined as the number of times each eigenvalue appears. For the 4 4 example the result is 2 1 1 0 where the Mordering corresponds to the ordering of the eigenvalues. These results can be generalized to higher dimensions as shown in the following Table of multiplicities for each eigenvalue 

The 4 4 matrix corresponds to the m 1 value in the top row 4 of the table giving the multiplicities of eigenvalues listed. Similarly it can be shown that for the 5 5 case the eigenvalues comprise the following solution 

According to various embodiments given the eigenvalues the eigenvectors corresponding to each eigenvalue can be constructed using the eigen problem. It is instructive to consider this process for the eigenvectors corresponding to the degenerate first and third eigenvalues 

According to various embodiments because two of the eigenvalues are degenerate neither the eigenvector v or the set of eigenvectors v v form an orthogonal system that can be verified by forming the inner product between any two vectors using the base solution 

According to various embodiments the diagonal form of the DFT can allow the DFT calculation to be performed as simply a multiplication of the entries on the main diagonal the eigenvalues to the corresponding data components that have been pre multiplied using the similarity matrix. This means that after pre multiplying the data the DFT transform can be reduced to a vector product consisting of N operations rather than a matrix multiplied with Noperations when the Fourier transform is used or N log N operations as is the case when a fast Fourier transform FFT is used. This can result in a reduction in computation time and cost. In some embodiments the diagonal DFT representation can lead to a fast calculation for one part of the DFT operation but this gain can be offset by the added computational cost of having to pre transform the data and then back transform to bring the Fourier transform into the original basis. In some embodiments however these latter operations need not be performed at every step in an iterative transform application such as for example in a phase retrieval operation.

According to various embodiments once the notation of the DFT calculation in the diagonal basis has been switched back to distinct kernel symbols for the data and its transform the DFT can be represented as where the m represents the transformation of basis under the action of the similarity transform. The only non zero values for the Ware along the diagonal therefore one can form a vector from the eigenvalues for example from the diagonal entries of the W. Continuing with the calculation of the starting data f can be pre transformed or pre multiplied using the inverse similarity transform to give

According to various embodiments where it is feasible to perform the DFT in a diagonal basis the similarity transform and its inverse can be pre calculated. The multiplication of the similarity transform with the data can also be pre calculated. Then at an appropriate point the DFT results can be transformed back to the original basis using the inverse similarity transform preferably at the end of an iterative loop. An exemplary algorithm approach can comprise the method illustrated in .

As shown in in a first step the similarity transform and the inverse similarity transform can be pre calculated. In a second step the diagonal form of the DFT matrix can be calculated in a third step wherein a data set can be pre transformed by multiplying the data by the inverse similarity transform. In a fourth step the DFT and the inverse DFT can be calculated for a set of data. This fourth step can be for an iterative transform application for example phase retrieval. The fourth step can loop a desired number of times for example a fixed number of times set by a user.

According to various embodiments the algorithms described herein can be used with any desired signal processing application where a transfer of data between the spatial domain and the frequency domain is used or vice versa. For example the methods provided herein can be used with a hybrid diversity algorithm that is used to recover phase retrieval that has high spatial frequency. The methods provided herein can be used with a distributed transpose algorithm for a two dimensional FFT on a cluster of digital signal processors. In some embodiments the methods provided herein can be used with matrix DFTs for fast phase retrieval. The methods herein can be used with space telescope wavefront sensing software for example the software used with NASA s James Webb Space Telescope. In some embodiments the methods provided herein can be used with hybrid diversity methods that utilize an adaptive diversity function as described in U.S. patent application Ser. No. 11 469 105 filed Aug. 31 2006 to Dean which is incorporated herein in its entirety by reference. The methods of the present teachings can also be incorporated with various digital signal processing applications for example algorithms using the Nyquist Shannon sampling theorem or variations thereof algorithms that provide optimal padding for two dimensional FFTs and hybrid architecture active wavefront sensing and control.

The steps above are illustrated for a 4 4 example. Consider the general complex data vector . The inverse similarity transform times the data vector is given by 

According to various embodiments the diagonal form of the DFT can illustrate that the DFT calculation can be performed as a vector product. This means that the DFT can be reduced to N multiplications of the data with the eigenvalues. Certain signal processing applications spend a majority of their time in the forward and inverse transforms part of the calculations see . For signal processing applications where the initial and final data transformations are needed only once the subsequent DFT calculations can proceed as simply N multiplications of the entries along the main diagonal. The performance gain for a single DFT calculation can then be approximately log N time faster with respect to the FFT. For example assuming for simplicity a power of 2 for the data size N 2 we can estimate a performance improvement for large n to be n log 2 10 or about an order of magnitude faster then the equivalent FFT calculation and for arbitrary frequency spacing.

Other embodiments will be apparent to those skilled in the art from consideration of the present specification and practice of various embodiments disclosed herein. It is intended that the present specification and example be considered as exemplary only.

