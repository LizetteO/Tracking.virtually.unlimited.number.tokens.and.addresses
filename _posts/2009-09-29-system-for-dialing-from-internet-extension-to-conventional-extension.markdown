---

title: System for dialing from internet extension to conventional extension
abstract: A system for dialing from Internet extension to conventional extension is disclosed. A VoIP gateway or an IP auto attendant is used for dialing from Internet extension to conventional extension. The phone number of the Private Branch Exchange and the voice guidance are not needed. The calling number of SIP message is interpreted directly and converted into DTMF (Dual-tone multi-frequency) messages for dialing into a conventional extension.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08488595&OS=08488595&RS=08488595
owner: National Taipei University of Technology
number: 08488595
owner_city: Taipei
owner_country: TW
publication_date: 20090929
---
The present invention relates to a system for dialing from internet extension to conventional extension and more particularly to a method system by using a VoIP gateway or an IP auto attendant to interpret SIP messages and convert into DTMF Dual tone multi frequency signals for being read by a Private Branch Exchange PBX .

VoIP Voice over Internet Protocol is one of the popular communication technology. In VoIP SIP Session Initiation Protocol defined by IETF is the most widely used protocol because of its simple structure expandability and easy operation.

In a conventional telephone system the number of extensions is limited by the capacity of the Private Branch Exchange. A Private Branch Exchange with more capacity will have a higher price. Therefore it is often to combine an Internet telephone system into a conventional telephone system for increasing the extensions and for upgrading into an IP telephone system so as to provide a more flexible expandability for extensions.

A dialing from an Internet extension to a conventional extension has to dial the telephone number of the Private Branch Exchange first so as to pass through SIP proxy server gateway Private Branch Exchange and then answered by the auto attendants for providing a voice guidance thereafter dial the number of the conventional extension so that a connection between the Private Branch Exchange and the conventional extension is established as shown by the bold solid arrow lines in

The dialing described above has to dial the telephone number of the Private Branch Exchange first and then directed by a voice guidance it is not convenient.

The object of the present invention is to provide a system in IP telephone system for dialing from an Internet extension to a conventional extension by dialing directly the telephone number of the conventional extension without dialing a telephone number of the Private Branch Exchange and without voice guidance.

The system for dialing from internet extension to conventional extension according to the present invention comprises an SIP proxy server an Internet extension a Private Branch Exchange a VoIP gateway and a conventional extension the SIP Proxy server the Internet extension and the VoIP gateway are connected by Internet the Private Branch Exchange the VoIP gateway and the conventional extension are connected by conventional telephone lines when dialing from internet extension to conventional extension it is not necessary to dial a telephone number of the Private Branch Exchange just dial directly a telephone number of the conventional extension from the Internet extension and then pass through the SIP proxy server the VoIP gateway the Private Branch Exchange to the conventional extension no voice guidance is needed.

The VoIP gateway has a telephone port and an Internet port the telephone port has an FXO interface for being connected with an FXS interface of the Private Branch Exchange the Internet port connects with the SIP proxy server by Internet.

The VoIP gateway can be replaced by an IP auto attendants. The IP auto attendants is a computer telephone integration system comprised of a computer an Network interface controller and a telephone voice card and an application program is designed for controlling.

A message is the basic unit for SIP to set up a speech communication. The message can be classified into request message and response message. A request is an SIP message from a client to a server to express the purpose of the client while a response is an SIP message from a server to a client to answer the request from the client.

Referring to a user dials the telephone number 0227710846 of the Private Branch Exchange at the Internet extension and issues message INVITE 0227710846 . . . for passing through the SIP proxy server to the gateway the gateway issues RING IN message to the Private Branch Exchange then the Private Branch Exchange transfers the RING IN message to the auto attendants the auto attendants answers the call automatically and sends out greetings issues OFFHOOK message for passing through the Private Branch Exchange to the gateway and then the gateway issues messages of 183 Ringing and 200 OK to the SIP proxy server the SIP proxy server issues messages of 100 Trying 183 Ringing and 200 OK to the Internet extension the internet extension returns with ACK 0227710846 . . . for passing through SIP proxy server to the gateway therefore confirms the dialing.

Thereafter the user dials the telephone number of the conventional extension directly to the auto attendants the auto attendants sends the telephone number of the conventional extension to the Private Branch Exchange by message Forward 30 the Private Branch Exchange issues RING IN message to the conventional extension and causes the conventional extension to ring then offhooked by someone and issuing OFFHOOK message to the Private Branch Exchange and then a speech communication is conducted the auto attendants also issues ONHOOK message to the Private Branch Exchange to end up the voice guidance. Once the conventional extension hangs up the phone the conventional extension issues ONHOOK message to the gateway the gateway issues BYE 10 . . . for passing through SIP proxy server to the Internet extension then the Internet extension issues 200 OK message to the gateway to end up the communication.

The present invention is limited in the function for dialing from internet extension to conventional extension.

Referring to which shows the system diagram of the present invention including an SIP proxy server Internet extensions for Internet telephone a gateway a Private Branch Exchange conventional extensions for conventional telephone and VoIP gateway . The SIP proxy server of the Internet telephone connects with an upper SIP proxy server of Taipei Education Bureau. The gateway of the conventional telephone connects with Chung Hwa Telecommunication Co. . The SIP proxy server connects with the Internet extensions the VoIP gateway the gateway and the SIP proxy server by Internet indicated by dotted lines. The Chung Hwa Telecommunication Co. the gateway the Private Branch Exchange the VoIP gateway and the conventional extensions are connected by conventional telephone lines indicated by solid lines as shown in the figure.

A dialing from the Internet extension to the conventional extension will pass through the SIP proxy server the VoIP gateway the Private Branch Exchange directly to the conventional extension as shown by the bold solid arrow lines in . is different from in that it is not necessary to go through the gateway and there is no voice guidance in a user can dial the number of the conventional extension directly at the Internet extension it is not necessary to dial the telephone number of the Private Branch Exchange .

Referring to a flow chart in IP telephone system of the present invention is described. A user picks up the telephone at the Internet extension for dialing the telephone number of the conventional extension a message Invite 30 . . . is issued for passing through the SIP proxy server to the VoIP gateway and then the VoIP gateway issues OFFHOOK message and Play DTMF 30 message to the Private Branch Exchange thereafter the Private Branch Exchange issues RING IN message and causes the conventional extension to ring the conventional extension was offhooked by someone so as to issue OFFHOOK message for passing through the Private Branch Exchange to the VoIP gateway and then the VoIP gateway issues 180 Ringing and 200 OK messages for passing through the SIP proxy server to the Internet extension the SIP proxy server will issue 100 Trying message simultaneously to the Internet extension the Internet extension will return with a message ACK 30 . . . for passing through the SIP proxy server to the VoIP gateway means the communication is conducted so the Internet extension and the conventional extension passes RTP Real time Transport Protocol speech packets and voice with each other as shown in the figure. After the communication is ended the conventional extension hangs up the telephone a message ONHOOK is issued to the VoIP gateway the VoIP gateway will then issue Bye 10 . . . message for passing through the SIP proxy server to the conventional extension the conventional extension returns with 200 OK message for passing through the SIP proxy server to the VoIP gateway so the communication is ended.

The VoIP gateway is a device between conventional PSTN telephone and IP Internet. It has an Internet port and a telephone port RJ 45 port is usually used for the Internet port while RJ 11 port is used for the telephone port. RJ 11 port has two specifications of FXS Foreign exchange station and FXO Foreign exchange office . The present invention uses the Tenor AS Series gateway of QUINTUM which has both the FXS and FXO specifications.

If the VoIP gateway is to connect with FXO port of the Private Branch Exchange then an FXS gateway has to be used if the VoIP gateway is to connect with FXS port of the Private Branch Exchange then an FXO gateway has to be used. The present invention uses a VoIP gateway having FXO port for being connected with FXS port of the Private Branch Exchange .

The present invention is limited in the function for dialing from internet extension to conventional extension.

When the Internet extension dials the conventional extension for message part SIP and SS7 messages the Internet extension sends the Internet telephone messages for passing through the SIP proxy server to the Internet port of the VoIP gateway and then the VoIP gateway analyzes the dialing number for passing through the telephone port to the Private Branch Exchange and then to the conventional extension on the contrary the conventional extension returns with the conventional telephone message for passing through the telephone port and then being converted into a corresponding Internet telephone message for sending to the Internet extension . For voice part the voice packets received from the Internet port by the VoIP gateway will be converted into voice signals for sending out through the telephone port on the contrary the voice signals received from the telephone port will be converted into voice packets for sending out through the Internet port.

Referring to which is the functional flow chart between the SIP proxy server and the VoIP gateway with FXO interface. When the SIP proxy server receives INVITE message issued from the Internet extension step the dialing number is analyzed to see if it belongs to a conventional extension step if the dialing number does not belong to a conventional extension then it is analyzed to see if it belongs to an Internet extension step if yes then the SIP proxy server issues the INVITE message to the Internet extension step and finishes ringing offhook communication onhook procedures step and then ends up the communication step if the dialing number is not a number of an Internet extension then the SIP proxy server responds that there is no such extension step and ends up the communication step .

If the dialing number is a conventional extension number then the SIP proxy server will issue INVITE message to the VoIP gateway step . When the VoIP gateway receives the message from the Internet port an OFFHOOK message will be issued through the telephone port and then the dialing number will be converted into DTMF signals for sending out through the telephone port step thereafter finish ringing offhook communication onhook procedures step and then end up the communication step .

The VoIP gateway can be replaced by an IP auto attendants. IP auto attendants is a computer telephone integration system CTI comprised of a computer an network interface controller and a telephone voice card EVS Electronic Voice Services Dialogic D 4PCI UFW . The telephone voice card is an interface card used for processing the voice on the telephone having functions of OFFHOOK ONHOOK DTMF Busy Tone Disconnected Tone Flash etc. The IP auto attendants connects to the Internet through the network interface controller for sending or receiving Internet packets including SIP messages and RTP voice packets of VoIP. The IP auto attendants connects to the conventional telephone network PSTN through the telephone voice card for detecting or issuing SS7 Signaling System No. 7 messages and voice signals. An application program can be designed for the IP auto attendants to control the API Application Programming Interface of the network interface controller and the telephone voice card so as to achieve integration function for the Internet and telephone.

As to the function design thereof as shown in the IP auto attendants has to have an network interface controller and a telephone voice card and an application program is designed for controlling the network interface controller and the telephone voice card . The message between Internet and telephone used in the present invention is SIP Session Initiation Protocol the voice transmission used in the present invention is RTP Real time Transport Protocol . The Internet packets are transmitted and received through an operating system by the network interface controller the telephone module uses the API provided by the telephone voice card through the operating system to control messages and voice of the telephone voice card

The IP auto attendants has the function to process Internet telephone and conventional telephone so it can provide four aspects for communication 1. dialing between the Internet extensions 2. dialing between the conventional telephones 3. dialing from Internet extension to conventional extension 4. dialing from conventional extension to Internet extension.

The present invention only adopts the third aspect of dialing from Internet extension to conventional extension. When an Internet extension dials a conventional extension for message part IP auto attendants receives Internet telephone messages sent from the Internet extension through the SIP proxy server by the network interface controller analyzes the dialing number from the Internet packets and then sends message by the telephone voice card to the Private Branch Exchange on the contrary when the telephone voice card receives conventional telephone messages returned from the conventional extension the conventional telephone messages will be converted into corresponding Internet telephone messages and sent to the Internet extension by the network interface controller . For voice part voice packets received from the network interface controller by IP auto attendants will be converted into voice signals for transmission through the telephone voice card while the voice signals received from the telephone voice card will be converted into voice packets for transmission through the network interface controller .

Referring to it is a system diagram for dialing from Internet extension of other SIP proxy server to conventional extension . The telephone number of the SIP proxy server is 0227710888. A user picks up telephone at the Internet extension for dialing the conventional extension of the SIP proxy server with telephone number 0227712171 . and show the flow charts thereof.

The user picks up telephone at the Internet extension and dials 0227712171 30 it means that the user wants to dial the conventional extension under the SIP proxy server with telephone number 0227712171 so the Internet extension issues INVITE message to the SIP proxy server . The SIP proxy server knows that the dialing belongs to the SIP proxy server so transmits the message packet to an upper SIP proxy server of Taipei Education Bureau and changes the parameter of From in the INVITE packet from 20 to 0227710888 20 it means that the call is from the Internet extension under the switchboard telephone number 0227710888. SIP proxy server determines a route by the telephone number and sends the packet to the SIP proxy server . After the SIP proxy server receives the packet it determines that the dialing is to the conventional extension and changes the dialing number from 0227712171 30 to 30 and transmits to the VoIP gateway . Thereafter the flow chart is the same as that of dialing from Internet extension to conventional extension the only difference is that the SIP proxy server has to process the number 022771271 in receiving or transmitting packet. When the SIP proxy server receives packet from the SIP proxy server the 0227712171 part of the dialing number has to be deleted and then sent to the VoIP gateway when the SIP proxy server receives packet from the VoIP gateway the 0227712171 has to be added into the dialing number.

The scope of the present invention depends upon the following claims and is not limited by the above embodiments.

