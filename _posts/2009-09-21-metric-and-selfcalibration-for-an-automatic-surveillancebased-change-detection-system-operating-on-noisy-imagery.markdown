---

title: Metric and self-calibration for an automatic, surveillance-based change detection system operating on noisy imagery
abstract: Self-calibrating an automatic, surveillance-based change detection system operating on noisy imagery comprises detecting a first image co-registered with a second image, wherein the first image and the second image each comprise pixels of a noisy image of a scene; detecting the second image co-registered with the first image, wherein co-registration of the first image with the second image comprises pixels from different images corresponding to a same location within the scene; producing a calibration factor based on the co-registered images; producing a modified ratio of pixel values corresponding to the first image and the second image from the same location within the scene; and comparing the modified ratio to a pre-determined threshold ratio value.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07961134&OS=07961134&RS=07961134
owner: The United States of America as represented by the Secretary of the Army
number: 07961134
owner_city: Washington
owner_country: US
publication_date: 20090921
---
This patent application claims the benefit of U.S. Provisional Patent application No. 61 161 188 filed Mar. 18 2009. U.S. Provisional Patent application No. 61 161 188 is hereby incorporated herein by reference in its entirety.

The invention described herein may be manufactured used and licensed by or for the United States Government.

The embodiments herein generally relate to computerized image systems and more particularly to detection systems for comparing changes in imagery.

The highly variable nature of radar measurements has plagued automatic target detection algorithm developers for decades. In particular the variability introduced in certain circumstances by system noise and synthetic aperture processing compound the problem for small targets. While a change detection mode of operation may allow the detector to combat these effects the false alarm rate can still remain unacceptably high. This is even true when the highly popular ratio based tests are applied to synthetic aperture radar SAR systems.

One method of addressing this problem is to exploit spatial or temporal averaging to reduce the variance of the underlying random phenomena. If only a single pass or look is available for this purpose then multiple looks for averaging must be synthesized either through spatial averaging or sub aperture processing. This implies that the resulting multi look averaged SAR image will likely have lower resolution than the non averaged one. Such a trade off however is often reasonable especially if the targets of intent comprise several image pixels. Even with spatial or temporal averaging however the false alarm rate often remains too high.

One can also address the false alarm problem by setting various thresholds to eliminate in some way clearly unsuitable samples from consideration. These thresholds can be incorporated either as floors for the denominator and numerator values used to form the ratio or as gatekeepers for considering pixel locations as possible change locations. If a pixel location fails to pass the gatekeeper it is eliminated from consideration. Unfortunately such an algorithmic modification adds complexity and while it should effectively eliminate certain false alarms it also creates new parameters the threshold that must be determined. For a radar system operating at an extremely low grazing angle however the benefits of false alarm reduction may well outweigh any drawbacks due to increased algorithmic complexity. Under these operating conditions the SAR images produced by the system would most likely contain long shadows and other regions of low intensity due to heavy forward scattering. Hence the denominator of the ratio test would often contain small values and the resulting ratio would be artificially large.

A change detection system compares imagery i.e. a two dimensional representation of a scene collected at different times to determine if any changes have occurred. Typically the image pixels indicate the amount of energy reflected or emitted from a particular location e.g. a photograph or a synthetic aperture radar image . One commonly implemented change detection system utilizes a ratio test calculating the ratio of pixel values from the same location and comparing this ratio to a pre determined threshold. In fact ratio based change detection has been shown to be optimal under certain operating conditions. The system designates locations with pixel ratios exceeding the threshold as being change locations. Unfortunately such a system is unable to operate effectively in the presence of noisy imperfect image data. Some attempts to modify the system have been made but these approaches generally are ad hoc and fail to provide a systematic approach to the problem.

In view of the foregoing the embodiments herein provide a system and method for self calibrating an automatic surveillance based change detection system operating on noisy imagery comprising a first sensor that detects a first image co registered with a second image wherein the first image and the second image each comprise pixels of a noisy image of a scene a second sensor that detects the second image co registered with the first image wherein co registration of the first image with the second image comprises pixels from different images corresponding to a same location within the scene a calibration factor module that receives co registered imagery data of the first image and the second image and produces a calibration factor based on the co registered images a metric calculator that directly or indirectly receives the co registered imagery data and directly or indirectly receives the calibration factor and produces a modified ratio of pixel values corresponding to the first image and the second image from the same location within the scene and a modified ratio test module that compares the modified ratio to a pre determined threshold ratio value.

The noisy image comprises synthetic aperture radar imagery grainy photography and low signal to noise ratio video frames. The metric calculator sorts pixel values in the first image. The metric calculator groups the sorted pixels according to value such that all pixels within an interval of a particular length are combined to form at least one pixel set makes a list of pixel locations within each of the at least one pixel set and calculates a mean pixel value for each of the at least one pixel set. The metric calculator selects a set of pixel locations from one of the at least one pixel set extracts spatially corresponding pixel values from the second image and calculates a mean value of the pixel values from the second image. The metric calculator plots the calculated mean values for the at least one pixel set from the first image and plots the calculated mean values for pixel sets from the second image wherein the plot corresponding to the second image is plotted over the plot corresponding to the first image.

The metric calculator records a corresponding value where a slope of the plots corresponding to the first image and the second image begin to correspond with one another. The metric calculator adjusts the plot corresponding to the second image so that the plot corresponding to the second image overlays the plot corresponding to the first image when the interval of the particular length is greater than the corresponding value and wherein the amount of vertical offset between the plots comprises the calibration factor. The metric calculator applies the calibration factor to the second image.

Another embodiment provides a method for self calibrating an automatic surveillance based change detection system operating on noisy imagery wherein the method comprises receiving a first image that has been co registered with a second image wherein the first image and the second image each comprise pixels of a noisy image of a scene receiving the second image that has been co registered with the first image wherein co registration of the first image with the second image comprises pixels from different images corresponding to a same location within the scene producing a calibration factor based on the co registered images and producing a modified ratio of pixel values corresponding to the first image and the second image from the same location within the scene wherein the modified ratio equals pixel values corresponding to the first image divided by the maximum of 1 the pixel values corresponding to the second image and 2 the value where the slope of graphical plots corresponding to the first image and the second image begin to correspond with one another for example the selected floor xwhere the first image line and second image line intersect and begin to correspond to one another as illustrated in .

The method further comprises sorting pixel values in the first image grouping the sorted pixels according to value such that all pixels within an interval of a particular length are combined to form at least one pixel set making a list of pixel locations within each of the at least one pixel set and calculating a mean pixel value for each of the at least one pixel set selecting a set of pixel locations from one of the at least one pixel set extracting spatially corresponding pixel values from the second image and calculating a mean value of the pixel values from the second image plotting the calculated mean values for the at least one pixel set from the first image and plotting the calculated mean values for pixel sets from the second image wherein the plot corresponding to the second image is plotted over the plot corresponding to the first image recording the value where the slope of the plots corresponding to the first image and the second image begin to correspond with one another adjusting the plot corresponding to the second image so that the plot corresponding to the second image overlays the plot corresponding to the first image when the interval of the particular length is greater than the corresponding value and wherein the amount of vertical offset between the plots comprises the calibration factor and applying the calibration factor to the second image.

These and other aspects of the embodiments herein will be better appreciated and understood when considered in conjunction with the following description and the accompanying drawings. It should be understood however that the following descriptions while indicating preferred embodiments and numerous specific details thereof are given by way of illustration and not of limitation. Many changes and modifications may be made within the scope of the embodiments herein without departing from the spirit thereof and the embodiments herein include all such modifications.

The embodiments herein and the various features and advantageous details thereof are explained more fully with reference to the non limiting embodiments that are illustrated in the accompanying drawings and detailed in the following description. Descriptions of well known components and processing techniques are omitted so as to not unnecessarily obscure the embodiments herein. The examples used herein are intended merely to facilitate an understanding of ways in which the embodiments herein may be practiced and to further enable those of skill in the art to practice the embodiments herein. Accordingly the examples should not be construed as limiting the scope of the embodiments herein.

The embodiments herein provide a system and method for enhancing a ratio based change in detection methodologies based on a SAR system s current noise and clutter background characteristics. The embodiments herein enhance the performance of the resulting modified ratio based change detection system. Referring now to the drawings and more particularly to where similar reference characters denote corresponding features consistently throughout the figures there are shown preferred embodiments.

Generally the embodiments herein enhance a ratio based change detection system based on a SAR system s current noise and clutter background characteristics. The approach hinges on the assumption that SAR magnitude images of the same terrain should remain essentially the same for two runs that are collected only minutes apart using the same platform trajectory. This initial no change comparison acts as an additional calibration step indicating reasonable choices for certain algorithm parameter values needed for the enhanced change detector. The embodiments herein provide modifications to the ratio test implemented to reduce the false alarm rate. In particular the embodiments provide a similarity metric that quantifies both spatial and magnitude image correlation.

The embodiments herein may be configured for use on a surveillance based change detection system that re visits an area under surveillance within several hours or days as opposed to months . The imaging sensors are assumed to produce noisy imagery and examples of such data include synthetic aperture radar imagery grainy photography or frames from low SNR signal to noise ratio video. The inputted images are co registered so that the same pixels from different images correspond to the same location within a scene. A block diagram outlining the metric block is illustrated in greater detail in which further illustrates how the method provided by the embodiments herein could be implemented into an existing legacy system. The various blocks in not surrounded by dashed lines correspond to the metric block of .

As depicted in image is co registered with image as provided in block and image is co registered with image as indicated in block . Then the pixel values in image are sorted as shown in block . Then as indicated in block the sorted pixels are first grouped according to value whereby all pixels within an interval of length x expressed in dB which are specified by the user are combined to form a set and typically a plurality of sets . Second a list of the pixel locations with each set is made and third the mean pixel value for each pixel set is calculated.

At this point the process branches to block and block . In block a set of pixel locations is selected from one of the newly created lists from block . The spatially corresponding pixel values from image are extracted and the mean of these values is calculated. In block the calculated means for the sets from image are plotted. The x axis of the plot indicates the value in dB corresponding to the middle of the interval and the y axis represents the mean value. Thereafter the calculated means for the sets from image are overplotted .

In the next block the x axis value xis recorded where the slope of the two plots begin to correspond with one another. This value is the floor for the ratio test. In block the plot for image is adjusted so that it overlays the plot for image when x x. The amount of vertical offset is the calibration factor applied to image and a calibration factor component in is applied to image . Next the ratio test statistic is modified as provided in block as follows 

The metric and calibration procedure provided by the embodiments herein and described in provides a systematic determination of parameters needed by a modified ratio based change detection system of . When included as a subsystem in an existing ratio based change detection system the subsystem reduces false alarms for a given probability of detection.

The embodiments herein provide a technique to determine realistic threshold values for incorporation into a modified ratio test e.g. excluding small values from the denominator of the ratio. The technique is based on a preliminary pair of no change or calibration runs together with the assumption that SAR data from the same terrain i.e. image collected minutes or possibly even hours or days apart will produce similar SAR images. After a small amount of post processing the major differences between the images should be due to system noise and subtle image misalignment.

Heuristically stated a metric as used in accordance with the embodiments herein is defined as part of the algorithm modifications that should indicate which pixel locations within a scene correspond to actual physical reflectors . That is one should be able to use the metric to distinguish pixels within a shadowed noise like region from those due to a reasonably sized target or clutter discretes. The resulting definition involves the correlation between two images in both spatial location and a pixel magnitude. If the images are spatially co registered one would expect to see pixel values from a geographical region in one image similar to those from the corresponding geographical region in the second image. Similarly if the values are not similar as determined by the metric then either a change has occurred from one data collection to the next or the region under consideration is noise like. In fact if the reference pixels from one of the images were all extremely close to some low value then one might expect the average from the spatially corresponding pixels in the second image to approach the average calculated for noise alone. This would especially be true even if the reference noise pixels all independent identically distributed random samples were all selected to be very much below the noise average.

This observation suggests an approach for defining a useful metric as follows one image is selected as a reference image and all of the image pixels are sorted according to magnitude. Then a bin size in a log scale is selected and a specified interval also a log scale between a specified minimum value and a specified maximum value is divided into a collection of contiguous bins. Next each of the reference pixels are placed into the bin that includes its log scale magnitude. Thereafter one of the bins is selected and all of the coordinates for pixels within that bin are tabulated. Then the spatially corresponding pixels are located in the second image and the root mean square RMS average for all of the pixel values from each of the images are separately calculated. As noted above if the samples were from a noise region one would expect the average from the second image to approach the average value of noise. If the samples were due to target or clutter however one would expect them to be correlated and their averages to be close to one another.

Let I x represent the set of indices in the reference image corresponding to pixel intensity x. That is I x includes the indices of all reference image pixels with intensities falling within the same bin as x. Let F n and F n represent M N images indexed by the unique integer n corresponding to the two dimensional pixel coordinate x y . This value of n is calculated according to the formula 1 

From equation 2 one can immediately identify an intuitive graphical method of evaluating the metric. The values of and are plotted in a log scale as a function of x and the value of x at which the two curves begin to overlap is the value at which the noise level has been adequately exceeded. It is pixel values above this level that are of interest here. This value of x is denoted as x and it is incorporated into the modified ratio test as further described below.

With respect to ratio test modifications the threshold x is intended to discriminate pixels that exceed a noise floor from those that do not so values in the denominator that are less than the threshold are set equal to the threshold. As a result the modification ratio test becomes 

With respect to the analysis of the metric using simulated data as an initial step data is simulated to evaluate the metric s behavior under anticipated operating conditions. Since the data are to represent samples from a coherent SAR system one may create both real and imaginary samples. The real and imaginary noise samples are assumed to be white and follow a Gaussian distribution with means 0 and variance . That is they are N 0 random variables RVs . The signal noise samples are also complex and comprise a constant magnitude signal with a random phase plus Gaussian N 0 noise. This formulation allows one to systematically vary the SNR across a wide range of values. A particular pixel value may be expressed mathematically using the expression Noise 4 where srepresents the signal magnitude from region i zero in the case of noise alone represents the random phase i.e. arctan imaginary s n real s n and n denotes the index corresponding to a particular image pixel.

The simulated scene comprises a noise only region and several target plus noise regions as illustrated in the bottom image of . The relative shading indicates the dynamic range of the pixel intensities where black dots in the top image of indicate the location of low intensity samples between 60 dB and 15 dB relative to the average noise intensity power . The average noise power is scaled within the scene of unity and also the signal target level is scaled in increments of 0.5 dB relative to this ambient noise level. This systematic increase in the target level begins at 1 dB however target levels of 0 dB 3 dB and 6 dB are also included for purposes of comparison. While the phase of an underlying target data sample is random its magnitude is fixed this simplifies the process of re scaling targets samples to different intensities. Also two of these simulated scenes are created one that serves as the reference image and another that serves as the test image. In addition spatially averaged versions of the reference and test images are created to determine the effects of spatial average on the effectiveness of the metric.

Based on the bottom image of it is expected that the smallest pixel values are spatially localized to either the noise only region or one of the lowest target noise regions e.g. target level of 6 dB 3 dB or 0 dB . This is exactly what is observed as depicted by the imagery in the top image of . Again here black dots indicate locations of samples that are between 60 dB and 15 dB relative to the average noise power. It is qualitatively clear from the imagery that the samples are indeed located within the regions that are predicted.

Because the corresponding test image samples are independent of those from the reference image one might initially expect the average power of these test samples to approach the average power of noise without exception. A closer examination of the simulation hypotheses however indicates that this assumption is not valid when spatial averaging is absent i.e. for non average data . As illustrated in one should actually expect the non averaged noise data to be biased slightly high due to the percentage of samples coming from higher intensity target noise regions. These samples approach a higher target noise average instead of the noise average resulting in the observed bias. Since spatial averaging reduces the variance of pixel values within a particular region it ensures that a larger percentage of the lowest pixel values are located within the expected noise only spatial region. Hence the incorporation of spatial averaging should drive the test curves closer to the underlying noise only value for extremely low reference values as evident in the plots of wherein metric values are shown as calculated for original and spatially averaged versions of the data. The bin size used is 0.125 dB. The bias has been eliminated even after averaging with a 3 3 spatial window. A detailed discussion of this phenomenon is included in the Appendix below.

With respect to an analysis of the metric provided by the embodiments herein using actual measured SAR data we developed a synthetic impulse reconstruction SIRE radar system and employed it to collect data sets suitable for analysis for the proposed metric. Since the SIRE radar s implemented cross range resolution is coarse by modern SAR standards the approximation described above should be somewhat more accurate. In addition of particular interest is the magnitude statistics for the same pixel in different images not in the magnitude statistics of multiple pixels from a given region in the same image.

During testing three runs are selected from the SIRE data set for use in determining the suitably of the metric for change detection CD algorithm enhancement. First a ratio based CD algorithm is applied to the original data to establish a qualitative baseline. Next the metric is implemented and is used to determine parameters incorporated into the enchanced CD algorithm. Finally the potential benefits realized through implementation of the enhanced change detector are analyzed. The metric evaluations utilize the graphical techniques illustrate in while the CD algorithm evaluation utilizes direct comparisons of output statistics calculated for each pixel value within the imagery.

First the implementation of an un modified version of the ratio based CD algorithm applied to the original non averaged data occurs. The images used for this experiment have incorporated changes that are relatively small. For example one of the changes comprises the insertion of a metal object into a box and another change includes the disturbance of tin cans inside a plastic bag. All of the images have a 40 dB dynamic range i.e. 40 dB down from a common artificially introduced peak value .

A change detection image is created for two different scenarios. The change detection image is formed by evaluating the ratio at each pixel location and assigning the result to that pixel location in a new image array. A nominal extremely low threshold is also included in order to slightly reduce the number of small denominator values encountered by the test. The first of the two scenarios operates in a true CD mode. The second scenario however operates in a pseudo CD mode. The resulting imagery comprises one detection image for each scenario. Several target pixels are between approximately the 19 dB to 25 dB levels indicating that they are only 10 to 15 dB above the prevalent false alarm levels which are between approximately the 8 dB to 11 dB levels. The results of the experiment demonstrate that under realistic operating conditions enhancements to the ratio based test are needed to reduce the number of potential false alarms.

Next detection images are taken for an enhanced ratio test. There is an increase in the number of target pixel values falling between 15 and 25 dB i.e. near the peak value . Additionally there is an increase in the number of background pixel values equal to 0 dB. Finally the process is repeated for spatially averaged data formed by convolving each run with a 15 15 rectangular window. The averaged data is then used to create detection imagery for the enhanced and un enhanced versions of the CD test as described above. Thus four additional images are created two for the enhanced ratio test and two for the un enhanced ratio test. These resulting images indicate that the enhanced version of the CD test removes a large number of potential false alarms through the incorporation of a suitably selected floor .

The techniques provided by the embodiments herein may be implemented on an integrated circuit chip not shown . The chip design is created in a graphical computer programming language and stored in a computer storage medium such as a disk tape physical hard drive or virtual hard drive such as in a storage access network . If the designer does not fabricate chips or the photolithographic masks used to fabricate chips the designer transmits the resulting design by physical means e.g. by providing a copy of the storage medium storing the design or electronically e.g. through the Internet to such entities directly or indirectly. The stored design is then converted into the appropriate format e.g. GDSII for the fabrication of photolithographic masks which typically include multiple copies of the chip design in question that are to be formed on a wafer. The photolithographic masks are utilized to define areas of the wafer and or the layers thereon to be etched or otherwise processed.

The resulting integrated circuit chips can be distributed by the fabricator in raw wafer form that is as a single wafer that has multiple unpackaged chips as a bare die or in a packaged form. In the latter case the chip is mounted in a single chip package such as a plastic carrier with leads that are affixed to a motherboard or other higher level carrier or in a multichip package such as a ceramic carrier that has either or both surface interconnections or buried interconnections . In any case the chip is then integrated with other chips discrete circuit elements and or other signal processing devices as part of either a an intermediate product such as a motherboard or b an end product. The end product can be any product that includes integrated circuit chips ranging from toys and other low end applications to advanced computer products having a display a keyboard or other input device and a central processor.

The embodiments herein may comprise hardware and software embodiments. The embodiments that are implemented in software include but are not limited to firmware resident software microcode etc. Furthermore the embodiments herein can take the form of a computer program product accessible from a computer usable or computer readable medium providing program code for use by or in connection with a computer or any instruction execution system. For the purposes of this description a computer usable or computer readable medium can be any apparatus that can comprise store communicate propagate or transport the program for use by or in connection with the instruction execution system apparatus or device.

The medium can be an electronic magnetic optical electromagnetic infrared or semiconductor system or apparatus or device or a propagation medium. Examples of a computer readable medium include a semiconductor or solid state memory magnetic tape a removable computer diskette a random access memory RAM a read only memory ROM a rigid magnetic disk and an optical disk. Current examples of optical disks include compact disk read only memory CD ROM compact disk read write CD R W and DVD.

A data processing system suitable for storing and or executing program code will include at least one processor coupled directly or indirectly to memory elements through a system bus. The memory elements can include local memory employed during actual execution of the program code bulk storage and cache memories which provide temporary storage of at least some program code in order to reduce the number of times code must be retrieved from bulk storage during execution.

Input output I O devices including but not limited to keyboards displays pointing devices etc. can be coupled to the system either directly or through intervening I O controllers. Network adapters may also be coupled to the system to enable the data processing system to become coupled to other data processing systems or remote printers or storage devices through intervening private or public networks. Modems cable modem and Ethernet cards are just a few of the currently available types of network adapters.

A representative hardware environment for practicing the embodiments herein is depicted in . This schematic drawing illustrates a hardware configuration of an information handling computer system in accordance with the embodiments herein. The system comprises at least one processor or central processing unit CPU . The CPUs are interconnected via system bus to various devices such as a random access memory RAM read only memory ROM and an input output I O adapter . The I O adapter can connect to peripheral devices such as disk units and tape drives or any other program storage devices that are readable by the system. The system can read the inventive instructions on the program storage devices and follow these instructions to execute the methodology of the embodiments herein. The system further includes a user interface adapter that connects a keyboard mouse speaker microphone and or other user interface devices such as a touch screen device not shown to the bus to gather user input. Additionally a communication adapter connects the bus to a data processing network and a display adapter connects the bus to a display device which may be embodied as an output device such as a monitor printer or transmitter for example.

Assume that the random variables X and Y are independent and follow an exponential distribution then 

Hence the percentage of samples falling in the interval is equal to the probability of that interval and the total number of samples falling within an interval is approximately equal to the total number of samples times the probability of the interval.

If p q then the difference between the RCS from different regions in the simulation is the same as the bin size. Plots of the curves described by equations A6 and A7 are included in for the case where p 1.26 1.0 q 4.0 and the regions are assumed to contain the same number of pixels. The x axis in these plots denotes the value at which a particular RCS bin begins i.e. the value of z . This corresponds to a second region with average RCS that is 6 dB higher than the first region. shows how the expected number of samples within a particular bin will vary as a function RCS. For example if the average RCS of region is 6 dB above region the regions are the same size then it is expected that about twice as many of the total samples used for calculating the average to come from clutter region than come from clutter region when the RCS bin begins at 0 dB. That is the ratio is approximately 2 at 0 dB implying that about 33 of the total number of samples used to calculate the metric is expected to come from region .

From equation A2 and the law of large numbers it is expected that the average of these samples representing 33 of the total number of samples when the regions are the same size to approach 6 dB not 0 dB. The overall average should then approach 

The foregoing description of the specific embodiments will so fully reveal the general nature of the embodiments herein that others can by applying current knowledge readily modify and or adapt for various applications such specific embodiments without departing from the generic concept and therefore such adaptations and modifications should and are intended to be comprehended within the meaning and range of equivalents of the disclosed embodiments. The papers titled A Metric and Self calibration Algorithm Surveillance based Change Detection System Operating on Noisy Imagery and Change Detection Using the Synchronous Impulse Reconstruction SIRE Radar and the slide presentation titled Recent Change Detection Experiments Using ARL s SIRE Radar are all hereby incorporated by reference. All of the documents listed therein are also hereby incorporated herein by reference to the same extent as if each individual document or publication was specifically and individually incorporated herein by reference.

It is to be understood that the phraseology or terminology employed herein is for the purpose of description and not of limitation. Therefore while the embodiments herein have been described in terms of preferred embodiments those skilled in the art will recognize that the embodiments herein can be practiced with modification within the spirit and scope of the appended claims.

