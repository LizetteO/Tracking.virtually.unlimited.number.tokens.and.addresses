---

title: Method of triggering location based events in a user equipment
abstract: Methods, a user equipment, a server host, a client application, computer program products, and a server computer program. These methods and components can be utilized by a location based service. One method regards triggering of events in the user equipment based on a position of the user equipment, comprising the steps of: —looking up, in a server database at least one network cell-identity associated with a predefined geographical area, —sending the network cell-identity to the user equipment, —storing the network cell-identity in a database in the user equipment, —obtaining a current network cell-identity to which the user equipment currently is connected, —comparing in the user equipment the current network cell-identity with network cell-identities stored in the database, and —retrieving content associated with the current network cell-identity if the current network cell identity is among the network cell-identities in the database.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08737619&OS=08737619&RS=08737619
owner: Telefonaktiebolaget L M Ericsson (Publ)
number: 08737619
owner_city: Stockholm
owner_country: SE
publication_date: 20090609
---
The invention relates to methods and components such as UEs user equipment server hosts client applications server computer programs and computer program products. These methods and components can be utilized by e.g. an LBS Location Based Service .

LBS are becoming more and more popular in mobile stations. These services are typically based on three different positioning technologies GPS Global Positioning System position triangulation with the help of RBS s radio base stations and positioning with the help of communications network cell ID cell identity or cell name number where the cell ID typically is a unique number of a cell of GSM Global System for Mobile Communications UMTS Universal Mobile Telecommunications System LTE Long Term Evolution for a given operator. Each positioning technology has advantages and disadvantages. GPS gives a relatively exact position under favourable conditions but requires dedicated hardware i.e. a GPS receiver circuit on the client side and is generally not working indoors or in tunnels. Network Cell ID based positioning where a mobile station knows which network cell in the mobile communications network it is closest to generally requires no extra hardware. However a database of mappings between network cell IDs and a geographical area is needed. In comparison with GPS positioning systems that utilize network cell IDs typically does not give as high positioning accuracy and the database needs to be created and updated which could be especially cumbersome if the database owner is not the network owner operator. Triangulation with the help of RBS s typically gives a better accuracy but far from the accuracy typically given through GPS and requires support from the network owner operator.

There exist a lot of different applications exploiting positioning systems and a common feature is POIs points of interest . This feature basically means that certain attractions that are considered to be of interest to a user are displayed on a map in a UE such as a navigation system in a vehicle or a mobile station. For instance modern navigation systems for vehicles are typically adapted to show on a displayed map area all gas stations as small gas pump icons. Another beneficial functionality of LBS is the possibility to trigger events actions based on the location of the UE. A problem when implementing this kind of functionality is that the UE should constantly be aware of its location in order to trigger events. To know its position the UE must either utilize GPS technology or any other satellite based positioning system such as GLONASS Global Navigation Satellite System and GALILEO or make frequent connections to a server in order to either lookup its current network Cell ID in a database of Network Cell IDs mapped to geographic positions or request to be positioned by a radio base triangulation service. As stated before GPS technology does not work appropriately indoors and frequent connections to a network server demands network and UE capacity. Furthermore the battery powering the UE is discharged faster.

WO 2007 051223 A1 discloses a system which may enable service differentiation based on current location. For example if a mobile station subscriber is in a home zone which may be a smaller zone than a network cell the tariffs of services utilized by the mobile station may be smaller than if the subscriber is outside the home zone. According to the system a zone may be stored in a SIM Subscriber Identity Module card which in practice makes the system rely on integration with an operator network.

It is an object of the invention to enable a way or components for the way which may decrease the energy consumption for a service e.g. LBS for activating actions based on the position of the UE.

It is another object of the invention to enable a way for activating actions e.g. LBS without revealing the position of the UE.

A first aspect of the invention relates to a method performed by a UE. The method comprises the steps of 

Hereby is achieved that cell identities such as those relating to POI s for a specific LBS can be saved in the UE and compared in the UE with a current network cell identity without contacting an LBS server every time the UE needs to check on whether there are POI s in the current network cell.

The method may comprise the step of requesting the at least one network cell identity before receiving the at least one network cell identity from the first server host. Hereby is achieved that the UE can request updates of network cell identities when it is appropriate and thereby enable a designer of a service to strike the right balance between an updated database in the UE and the number of cell ID updates being sent to the UE and the first server host.

Hereby is achieved that also content associated with e.g. POI s in a certain network cell is stored in the database. Thus the UE does not have to request another entity for at least that content. Provided that the UE enters a network cell with a network cell identity and associated content stored in the database this saves communication energy and reduces response times for the service thus leading to improved user satisfaction.

The method may comprise the step of requesting further content from the first server host or a second server host based on the content associated with one of the network cell identities stored in the database. This enables a designer of an LBS to strike the right balance between downloading and possibly storing of the content in the database in advance and retrieval of the further content more on demand. The further content may typically have a larger file size than the content stored in the database but it may of course depend on the service. In a future scenario where UE s are expected to have much larger memory capacity the UE s may be preconfigured for LBS s and already have a lot of content stored in the database already when the UE is purchased by a consumer.

The method may comprise the step of if the current network cell identity is the same as at least one network cell identity stored in the database checking if the content or further content associated with the current network cell identity has previously been used for alerting a user of the UE.

The method may comprise the step of displaying a message or an icon on a display of the UE said message or icon corresponding to the content or further content associated with the current network cell identity.

A second aspect of the invention relates to a client application comprising computer readable code means which when run on a UE causes the UE to 

A third aspect of the invention relates to a computer program product comprising computer readable means and the client application which is stored on the computer readable means.

A fourth aspect of the invention relates to a method performed by a UE. The method comprises the steps of 

The method may comprise the step of sending a request message requesting the at least one cryptographically hashed network cell identity before receiving the at least one cryptographically hashed network cell identity from the first server host.

The method may comprise the step of requesting further content from the first server host or a second server host based on the content associated with one of the cryptographically hashed network cell identities stored in the database.

The method may comprise the step of if the cryptographically hashed current network cell identity is the same as at least one cryptographically hashed network cell identity stored in the database checking if the content or further content associated with the cryptographically hashed current network cell identity has previously been used for alerting a user of the UE.

The method may comprise the step of displaying a message or an icon on a display in the UE said message or icon corresponding to the content or further content associated with the cryptographically hashed current network cell identity.

A fifth aspect of the invention relates to a second client application comprising computer readable code means which when run on a UE causes the UE to 

A sixth aspect of the invention relates to a computer program product comprising computer readable means and the second client application the second client application being stored on the computer readable means.

A seventh aspect of the invention relates to a method performed by a first server host in a communications network. The method comprises the steps of

The method may comprise the step of receiving a request from the UE about the at least one network cell identity before sending the at least one network cell identity to the UE.

The method may comprise the step of triggering the step of looking up the at least one network cell identity through a timer function executed in the first server host.

The method may comprise the step of sending to the UE at least one updated network cell identity for a network cell being a current network cell in which the UE is positioned or a network cell in a second geographical area surrounding the current network cell if the network cell identity for the network cell has been changed.

An eighth aspect of the invention relates to a server computer program comprising computer readable code means which when run on a first server host connectable to a UE causes the first server host to 

A ninth aspect of the invention relates to a computer program product comprising computer readable means and the server computer program which is stored on the computer readable means.

A tenth aspect of the invention relates to a method performed by a first server host in a communications network. The method comprises the steps of 

The method may comprise the step of receiving a request message from the UE about the network cell identity before looking up the at least one network cell identity.

The geographical area may be defined by geographical coordinates in the request message and in that case the method comprises the step of generating a look up request comprising the geographical coordinates for use in the step of looking up.

The method may comprise the step of triggering the step of looking up the network cell identity through a timer function executed in the first server host.

The method may comprise the step of sending to the UE at least one updated cryptographically hashed network cell identity for a network cell being a current network cell in which the UE is positioned or a network cell in a second geographical area surrounding the current network cell if the network cell identity for the network cell has been changed.

An eleventh aspect of the invention relates to a second server computer program comprising computer readable code means which when run on a first server host connectable to a UE causes the first server host to 

A twelfth aspect of the invention relates to a computer program product comprising computer readable means and the second server computer program which is stored on the computer readable means.

The UE may comprise requesting means configured to request the at least one network cell identity before receiving the at least one network cell identity from the first server host.

The requesting means may be capable of requesting updated network cell identities from the first server host at regular time intervals.

The requesting means may be capable of requesting updated network cell identities from the first server host upon manual initiation by a user of the UE.

The retrieving means may be configured to receive the content from the first server host and the database may store the content in the database in such a way that the content is associated in the database with the at least one network cell identity.

The retrieving means may be configured to request further content from the first server host or a second server host based on the content associated with one of the network cell identities stored in the database.

The UE may comprise checking means configured to if the current network cell identity is the same as at least one network cell identity stored in the database check if the content or further content associated with the current network cell identity has previously been used for alerting a user of the UE.

The UE may comprise a display and a displaying means configured to display a message or an icon on the display the message or icon corresponding to the content or further content associated with the current network cell identity.

The UE may comprise requesting means configured to send a request message requesting the at least one cryptographically hashed network cell identity before receiving the at least one cryptographically hashed network cell identity from the first server host.

The retrieving means may be configured to receive the content from the first server host and the database may store the content in the database in such a way that the content is associated in the database with the at least one cryptographically hashed network cell identity.

The retrieving means may be configured to request further content from the first server host or a second server host based on the content associated with one of the cryptographically hashed network cell identities stored in the database.

The UE may comprise checking means configured to if the cryptographically hashed current network cell identity is the same as at least one cryptographically hashed network cell identity stored in the database check if the content or further content associated with the cryptographically hashed current network cell identity has previously been used for alerting a user of the UE.

The UE may comprise a display and a displaying means configured to display a message or an icon on the display the message or icon corresponding to the content or further content associated with the cryptographically hashed current network cell identity.

A fifteenth aspect of the invention relates to a first server host adapted for being connected to a communications network. The first server host comprises 

The first server host may comprise second receiving means configured to receive a request from the UE about the at least one network cell identity before sending the at least one network cell identity to the UE.

The sending means may be configured to send to the UE at least one updated network cell identity for a network cell being a current network cell in which the UE is positioned or a network cell in a second geographical area surrounding the current network cell if the network cell identity for the network cell has been changed.

A sixteenth aspect of the invention relates to a first server host adapted for being connected to a communications network. The first server host comprises 

The first server host may comprise second receiving means configured to receive a request message from the UE about the network cell identity before looking up the at least one network cell identity.

The geographical area may be defined by geographical coordinates in the request message and the look up means may be configured to generate a look up request comprising the geographical coordinates for the look up in the server database.

The sending means may be configured to send to the UE at least one updated cryptographically hashed network cell identity for a network cell being a current network cell in which the UE is positioned or a network cell in a second geographical area surrounding the current network cell if the network cell identity for the network cell has been changed.

A seventeenth aspect of the invention relates to a method of triggering events in a UE based on a geographical position of the UE. The method comprises the steps of 

An eighteenth aspect of the invention relates to a method of triggering events in a UE based on a geographical position of the UE. The method comprises the steps of 

The content may comprise at least one Uniform Resource Locator associated with the first server host or the second server host. The content may even comprise at least two or more Uniform Resource Locators for retrieval of further content from two or more different servers.

The database may comprise a hashtable in which the network cell identities stored in the database are keys and the associated contents are values.

While the invention covers various modifications and alternative constructions embodiments of the invention are shown in the drawings and will hereinafter be described in detail. However it is to be understood that the specific description and drawings are not intended to limit the invention to the specific forms disclosed. On the contrary it is intended that the scope of the claimed invention includes all modifications and alternative constructions thereof falling within the spirit and scope of the invention as expressed in the appended claims.

To enable developers to develop applications using the location features of mobile devices based on the J2ME platform the Java Specification Request JSR 179 Location API for J2ME and JSR 293 Location API 2.0 have been developed.

Part of JSR 293 is the ability for an application to subscribe to events based geographic proximity i.e. proximity events. This enables the developer to define a geographic position or area in which the mobile device should alert the application to perform a specific action if the user enters that position area.

In a UE equipped with a GPS support for JSR 293 s proximity events is trivial since the mobile device knows its position. However in a device without a GPS receiver an alternative method of positioning must be used as described above .

It might be also be good to use cell id based proximity events even in the case where the UE has GPS support. If proximity events are implemented using GPS position co ordinates as the triggering mechanism the energy consumption of the UE is expected to be higher since specific GPS equipment is used instead of exploiting the already in place GSM 3G technology.

The invention provides a way to put alarms alerts on POI s which can be triggered by the location of the user carrying the UE in other words triggered by the geographical position of the UE . This could be used to inform the user of interesting activities in the immediate surroundings. This is accomplished by mapping at least one POI to a RBS network cell ID and caching the information in the UE . A current network cell ID i.e. the cell ID for a mobile telecommunications network cell in which the UE currently is in is read by the UE and compared to cached network cell IDs in the database . Thus there is no need for neither a GPS receiver nor repeated lookups for the first server host to determine the location of the UE .

Additionally a method is enabled for a service provider to update network cell ID information in a subscribing user s UE upon the event of changes in the network cell ID information which changes may occur due to network topology changes or changes to the user s POI subscription.

The UE may in this description and claims be a mobile station a laptop a navigation system device for a vehicle and an embedded telecommunications node in a vehicle or other device that may utilize location based services. also illustrates a second geographical area adjacent to or surrounding the current network cell . Furthermore schematically illustrates fields in the database with cell IDs stored in the database . The cell IDs stored in the database may be plain concatenated or concatenated and cryptographically hashed in a way described below. Content associated with the stored cell IDs in the database may also be stored in the database and or the server database and further content associated with the cell IDs may be stored in another entity other than the UE or the first server host . In the further content here in the form of a downloadable mpeg4 file is for the purpose of illustration stored in the second server host . It is to be understood that the content and the further content may be any type of content which could be associated with a POI network cell. Examples of the content and further content are text messages to be displayed on the UE image files such as gif jpeg and bitmap files audio files such as mp3 MPEG 1 audio layer 3 WAV WMA Windows Media Audio AAC Advanced Audio Coding ATRAC Adaptive Transform Acoustic Coding and Flac Free Lossless Audio Coding video and audio files such as divx Xdiv mpeg2 AVI and mpeg4 files documents in the form of PDF files notepad and Microsoft Excel Visio Powerpoint and Word files PDF files URI s uniform resource identifiers such as SIP Session Initiation Protocol URI s and URL s to external devices for downloading of additional content etc and geographical coordinates and playlists such as a M3U Moving Picture Experts Group Audio Layer 3 Uniform Resource Locator .

The means illustrated in may as will be apparent to a person skilled in the art be implemented enabled in the UE by the client application having program modules corresponding to the means and which when run by the processing unit causes the UE to perform the corresponding functions for the UE as described above and in the following. However although not shown in any figure the means illustrated in may also be enabled implemented at least partly by special hardware circuits such as ASICs Application Specific integrated Circuits .

The means and the timer function illustrated in may as will be apparent to a person skilled in the art be implemented enabled in the first server host by the server computer program having program modules corresponding to the means and the timer function and which when run by the processor causes the first server host to perform the corresponding functions for the first server host as described above and in the following. However although not shown in any figure the means and the timer function illustrated in may also be enabled implemented at least partly by special hardware circuits such as ASICs Application Specific integrated Circuits .

According to an embodiment of the UE comprising the client application the UE comprises the following features 

An embodiment of a system implementation of the invention will now be described in more detail in conjunction with . First a mechanism to update the client application with a data structure holding the information about which Network Cell IDs that are associated with POIs is needed. In a first step S an update of information to be sent from the first server host to the UE is triggered. The triggering can according to the invention be performed in different ways e.g. the client application which may run in the background of the UE may as in the case of be adapted to cause the UE to at regular time intervals trigger an update of information. This can be done by incorporation of a second timer function in the client application . Alternatively or in addition thereto the UE may be caused to trigger the update by manual initiation by the user via the client application i.e. the client application may have a module feature which allows the user of the UE to initiate an update by e.g. pushing a physical or virtually displayed button of the inputting means .

In a second step S the client application causes the UE to fetch the information from the first server host with the request message e.g. an HTTP Hypertext Transfer Protocol Get message to get a hashtable.

In a third step S the first server host receives the request message and in its turn send a request for personalized information e.g. a customized personalized hashtable for a certain UE user from the server database . The server database which may be an SQL database comprises a complete set of network cell IDs and associated mapped POIs i.e. preferably more network cell IDs and associated mapped POI than being stored in the database and in a fourth step S returns the requested personalized information e.g. as a customized hashtable including network cell IDs. In the first server host and the server database has been illustrated as being comprised in different hosts the first server host and the database host respectively but the embodiment according to the steps above of course comprises embodiments where the server computer program and the server database are comprised in the same host. Also the first server host and the database host may together be seen as the same node in a network node architecture and in that respect the first server host and the database host respectively may not be single devices computers but may of course be a server cluster farm that share the workload and is working as one node as seen from the other nodes that may communicate with the server cluster.

The personalized information and customized hashtable may be generated stored and retrieved in different ways known to a person skilled in the art. It is a general task which of course is dependent on the LBS that can utilize the invention. However three examples will be mentioned in the following 

In an embodiment A the service is to give users of the service information from different shops. In such a service the user can select e.g. via the UE or via an interface of a second UE not shown such as a PC at home from which shops he she would like to receive information. The selected shops are stored as relations associations edges links between the user and the selected shops in the server database . When the UE starts to use the service or wants to update the database due to e.g. the addition of yet another single shop or multiple shops the first server host via the lookup means in the first server host retrieves all the shops that the user has selected and build a table list comprising associated network cell ID s for the shops. In other words multiple stores i.e. more than one retail enterprise under the same ownership or management are associated with network cell IDs. Those network cell IDs are chosen by the first server host dependent on the home network operator used by the UE .

B Another way is to let the users of an LBS answer a number of questions when they subscribe to the LBS and then based on the answers to the questions generate user preference values and connect these preference values with e.g. related shops. Each shop may then be associated with one or more than one preference. Nevertheless the end result is the same as in the above embodiment A a connection between shops and users UEs is established.

C A third conceivable example is to utilize a machine learning function comprised in e.g. the first server host and calculate connections associations between users and shops based on stored electronic tracks or actions which can be stored in log files that the user UE or any apparatus of a service provider generates such as visited web pages sent e mails or e mail addresses in contacts database called telephone numbers electronic social network connections and positioning data.

In a fifth step S the first server host receives and forwards the personalized information to the UE . This can for example be accomplished by pushing a file with the personalized information to the UE or sending the personalized information in one or more messages such as USSD Unstructured Supplementary Service Data one or more SMS Short Message Service messages or MMS Multimedia Messaging Service messages addressed to the client application . Thus preferably the messages addressed to the client application should not be stored and displayed in an inbox folder for messages intended to be displayed to the user i.e. not in a typical messages application for a user with an inbox and outbox for SMS etc.

In a sixth step S the UE receives the personalized information and updates the database with the personalized information. After that a confirmation message that the update has been performed may be generated for an internal log file of the client application and or as a visual message displayed on the display for the user. The latter message can be advantageous as a response to a manually initiated update. The confirmation message may comprise information not only of the update itself but also how many records that has been inserted updated deleted etc.

In a second step S the first server host sends a WAP Wireless Application Protocol push message to the UE wherein the WAP push message indicate to the client application that there is updated information to be retrieved from the first server host e.g. by including a URL Uniform Resource Locator to the first server host . Hereby the first server host makes it possible for the UE to always have updated cached network Cell ID information. The use of a URL in the message could be advantageous in the case where the service require relatively much information to be downloaded.

In a third step S the UE sends an update request to the first server host in the same way as described with respect to S. Optionally if the received WAP push message comprises a URL or require relatively much data to be downloaded from the first server host the displaying means may cause the UE to display an update question to the user and wait for a confirmation before sending the update request. The following steps are the same as the corresponding steps described above in conjunction with i.e. step S correspond to step S step S correspond to step S step S correspond to step S and step S correspond to step S.

In an optional second step S the determining means causes the first server host to determine which of the subscribers to a certain service associated with the server that should or ought to be sent updated information with network cell IDs for that particular service. If it is determined that a subscriber to the service should be sent updated information the server in a third step S request updated information based on the subscriber user UE profile from the server database e.g. in the same way as described with respect to step S above. A fourth step S corresponds to step S a fifth step S corresponds to the steps S and S and a sixth step S corresponds to the steps S and S.

Although shown as three separate embodiments yet other embodiments of a system according to the invention may have the feature of all or any combination of the triggering alternatives disclosed in the description. In other words embodiments may comprise both trigger events triggered in the UE or in the first server host or even by another computer connected to the first server host for e.g. administering the service profiles and updating the database. Regarding the triggering by the timer function or the first timer function embodiments of the invention may comprise the feature of having a counting function to determine how long the UE has been in one network cell. If the UE is determined to have been in one network cell longer than a predetermined time the timer counter for triggering the update request can be extended set to a larger value than the current value so that update requests are triggered with longer time intervals if the UE is relatively stationary in comparison with a UE that frequently is moved around in different geographical areas.

The UE needs to constantly i.e. at predetermined time intervals or by continuously running a checking loop check if the UE has moved to another geographical position which is associated with a new network cell ID. This can be accomplished by looking up searching for the current network cell ID in the database which as stated above may be a hash table containing network cell IDs as keys and their associated POIs as values. An embodiment of this will be described more in detail in conjunction with .

In a first step U shown in a network cell ID correspondence check is triggered here as an example only by the timer function .

In a second step U the client application causes the UE to obtain the current network cell ID by checking the current network cell ID i.e. the network cell ID of the cell with which the UE is associated which usually is the network cell ID of an RBS with which the UE has or is allowed to have the strongest communication connection with in case the UE may have the possibility to receive signals from more than one RBS. The network cell ID of the current network cell can be retrieved and stored in the UE via a so called Cell search which is the procedure by which a UE acquires time and frequency synchronization with a cell and detects the cell ID of that cell in e.g. UTRAN UMTS Terrestrial Radio Access Network and E UTRAN.

In a third step U the client application causes the UE to search the database for the current network cell ID obtained in the second step U. The database may comprise at least one lookup table which may be implemented in a number of different ways. If the client application is implemented as a Java ME Micro Edition Midlet a suitable data structure would be a hashtable. The hashtable would preferably have network cell IDs as key and the POI s as associated values. The hashtable may also store information e.g. in the form of a true or false flag whether a user has been alarmed already about a POI before. This alarmed already information may in the hashtable also be associated with a time stamp. If this alarmed already information is stored the client application comprises marking means routine that updates such information in the hashtable once a POI message displayed and or audio message and or a signal to another application in the UE or even another device for triggering of a UE external action has been generated or initiated by the UE optionally with associated time stamps indicating the time when the POI message was generated or initiated. The client application may also comprise means configured to cause the UE to change or reset the alarmed already information to false or something with the equivalent function known in the art if a certain time has passed by comparing a current time with the time stamps at regular time intervals. This certain time may be set either by the service provider or alternatively or in addition thereto by the user via a GUI graphical user interface displayed by the UE . The client application here also comprises the checking means which adapts the UE to check whether a POI message already has been generated or initiated for a certain network cell ID POI. Through the alarmed already information the client application is able to avoid that the user is alarmed twice about the same POI at least within the certain time mention above.

By letting the database comprise a hashtable the data structure would be appropriate for lookups based on a network cell ID. Network cell IDs may exist in different formats depending on if an RBS belongs to e.g. a GSM network 3G UMTS network and LTE network. A GSM network cell ID contains 4 hexadecimal numbers e.g. 07ed and a 3G network cell ID contains 8 hexadecimal numbers e.g. 0015066a. However as will be discussed more in detail further down in conjunction with this local or network operator dependent cell ID name may for some embodiments and LBS s not be enough to clearly i.e. collision free distinguish one network cell from another. In other words the definition of a network cell ID according to this invention does not only comprise the 4 hexadecimal numbers of a GSM network cell ID or the 8 hexadecimal number of a 3G network but any data used to identify network cells and comprising the local network cell ID name.

The kind of content that the hashtable will tie to the network cell IDs respectively can depend on the nature of the service that utilizes the invention. As an example a common content type could be a URL pointing to more information about a POI. This is illustrated in table 1 below where VISITED is a column for information data related to whether the visited site file media corresponding to the associated URL has been displayed before or relatively recently or whether information about that site has been displayed before or relatively recently.

In the example described above in Table 1 any content such as text images sound and video can be connected to the POI. This is interesting for services associating rich media to the POI. On the other hand there are other services that associate relatively little information to each POI such as a short text or an icon for a POI category typically POI category formats for vehicle navigation systems. In services of the latter example the client application service could actually store all available information about the POI in the actual lookup table in the UE . Then the format of the lookup table would not store a URL instead the table and the format could look like in Table 2 below.

Since a subscriber of a specific operator only will access RBS s from that specific operator if roaming and mixed networks are excluded the list of Network Cell IDs sent to the UE can be optimized by the server side by only including Network Cell IDs belonging to the home network of the operator of the UE . This also means that it will be necessary for the server side of the system to keep multiple network cell IDs for each POI in order to guarantee that mobile subscribers from different operators can access the information.

The searched looked up cell ID may be found in the database or may not be found in the database . If not found the client application in a fourth step U determines that the current network cell ID is not found and in a fifth step U set a new timer and go back to a sleeping mode.

In case the current network cell ID is found in the database the client application in a sixth step U retrieves the content associated with the current network cell ID in the database provided that it is not indicated that the content shall not be disclosed since it may have been displayed previously . If the database comprises content in the form of URLs as illustrated in Table 1 the associated URL is retrieved from the database for some embodiments provided that VISITED is not true .

In a seventh step U provided that the content comprises a URL the client application causes the UE to request further content from the first server host the second server host or any other server associated with the received URL.

In an eighth step U the first server host the second server host or another server send the requested further content to the UE which receives the further content .

In a ninth step U the client application causes the UE to display the content received from the database and or the further content received from the first server host the second server host or another server associated with the URL received from the database .

The embodiments above described in conjunction with have substantially been described with the database containing the content and that the content is sent from the first server host . However in other embodiments the content does not necessarily have to be stored in the UE or be sent from the first server host . Furthermore the network cell ID s from the server database are sent openly from the first server host to the UE in the embodiments illustrated in . The latter may cause security problem especially in the case where a predefined geographical area is sent in a request to the first server host and cell IDs are sent openly in response to the predefined geographical area. By sending the information about the location of the network cells the cell ID data is exposed and can be stored by a malicious user. This would increase the risk of someone gradually stealing the cell id data and building their own cell id database.

Therefore according to different embodiments of the invention proximity alerts i.e. Cell ID Driven alarms as a service is provided by providing an open API application programming interface where applications wanting to download information about which cells to trigger events on can request cell ids of cells covering a geographical coordinate and download cryptographically hashed values e.g. hashed values of those cell ids for storing in the database instead of plain network cell ID s. The client application can then hash the obtained current network cell ID cell ids according to the same hash function and detect when matching cells.

In a first step V a client application implemented in J2ME needs to subscribe to events triggered by an occasion where the UE is in predefined vicinity which is the choice of an LBS provider of the coordinates latitude 59.19434 and longitude 18.4196 Stockholm city centre . The coordinates can be obtained by the UE in a number of ways e.g. inserted manually via a GUI of the client application or retrieved more or less automatically via an API. One way is that the user of the UE look at an announcement provided by a shop said announcement having the geographical coordinates explicitly stated thereon and then input the geographical coordinates via a GUI. Another way is for the user to simply ask for the geographical coordinates when he she visits the shop or makes this request via a web service having a database with postal addresses mapped to their corresponding geographical coordinates. Yet another way is that the UE is provided with the GPS receiver circuit and that the GPS receiver is turned on to retrieve the geographical coordinates and then turned off to save energy. One possible scenario within the scope of this GPS way is that a user is standing on a balcony or roof of a house where he she can receive signals from GPS satellites with the UE and wants a location based action application service to start when he she enters the house. Such an action could even be to turn off the GPS receiver since the GPS signals from GPS satellites are generally too weak or too inaccurate to be relied upon when the UE is inside the house. Still another way to obtain the geographical coordinates is if the UE comprises an NFC Near field communication tag reader not shown to read an NFC tag provided with data comprising the geographical coordinates or e.g. a link to a site where certain geographical coordinates can be retrieved.

In a second step V the client application via the UE sends the request message e.g. via HTTP WAP to the first server host . The service could be that the client application shall see to that the UE receive an advertisement when the user is in an area near the coordinates.

In a third step V the lookup means causes the first server host to send a lookup request to the database host for matching the geographical coordinates received from the UE to at least one network cell id and receives cell id s that cover the position associated with the geographical coordinates. The server database comprises network cell ID s mapped to geographical coordinates for this purpose. Similarly to previously described embodiments although the server database here is stored in the database host the server database may in other embodiments be stored in the first server host .

In a fourth step V a lookup in the server database is made in order to retrieve at least one matching cell ID for a cell that covers the geographical coordinates received in the request from the first server host .

In a fifth step V at least one matching cell ID is sent from the server database to the first server host in this embodiment exemplified by two network cell id s 

In a sixth step V the first server host determine either implicitly by receiving the two cell ids from the cell id database or explicitly by e.g. checking the validity of the two received cell ids by comparing them to cell id s in a second cell id database not shown . Also in order to save bandwidth when subsequently communicating with the UE some numbers in the cell ID name determined as unnecessary may be removed. In this case 000 in the local names of the two examples a and b thus becoming 

In another embodiment the removal of 000 may already have been made by the database host before sending the lookup answer to the first service host in the fifth step V.

In a seventh step V the first server host concatenates the received cell information ID s into one string for each cell id. In other words all received parameters for each cell ID are added to each other the result being in this example 

In order to decrease the possibility of cell ID collision a delimiter between the mnc mcc lac and cellid may optionally be introduced resulting in 

In an eighth step V the two strings are cryptographically hashed using e.g. a cryptographic hash function such as MD5 Message Digest algorithm 5 with a 128 bit hash value typically expressed as a 32 digit hexadecimal number. The MD5 is as such known via RFC 1321 and therefore not explained more in detail. The two resulting cryptographically hashed strings are in this example 

In a ninth step V the cryptographically hashed strings are sent from the first server host to the client application of the UE .

In a tenth step V the cryptographically hashed strings are stored in the database . In an eleventh step V the UE obtains the current network cell id.

In a twelfth step V the client application causes the UE to concatenate the cell Id of the current network cell in the same way as was done by the first server host in the seventh step V.

In a thirteenth step V the client application causes the UE to hash the concatenated cell Id of the current network cell using the same cryptographic hash function as used in the eighth step V. The hashed concatenated cell IDs may in one embodiment be stored in a second UE database not shown in the UE but in another be deleted once a fourteenth step V has been performed.

In the fourteenth step V the client application retrieves the two resulting cryptographically hashed strings stored in the database in the tenth step V and compare these two strings and other strings already having been stored before the two strings in the database with the cryptographically hashed concatenated cell ID of the current network cell as generated in the thirteenth step V. If it is detected that some of the values here in the form of hash values are identical an event is triggered in a fifteenth step V in this example downloading the content in the form of an advertisement to the UE which is illustrated in with a sixteenth step V of requesting the advertisement from a server entity which may be the second server host or the first server host and in a seventeenth step V receiving the advertisement from that server.

Although the JSR 179 and JSR 293 are very well suited frameworks for an implementation of this embodiment they are only examples. The mechanism described herein could be implemented using any mobile development environment that can read the current cell id and communicate with the first server host .

Three exemplary use cases for the invention will now be described. In a first exemplary use case where a service which advertisers such as owners of stores and restaurants can use to advertise information about their business and where the users of the service can find information about the advertisers businesses marked on a map. In such a service one functionality could be to let users subscribe to information about certain businesses in order to have information sent to the user s mobile phone when the user is close to the location of the business. The following use case is in one embodiment of the invention part of such a service.

The second exemplary use case considers a navigation system service for vehicles. Users can use this navigation system to receive notifications when they are in a geographical area with high way speed cameras. The following use case is a part of such a service.

There are of course several other vehicle associated LBS that could utilize the invention. For example if the UE is connected to a vehicle internal network it could upon determination that a current network cell ID corresponds to a network cell ID in the database send a message to a node in the vehicle internal network which causes the node to initiate an action in the vehicle such as alerting the driver by e.g. an audio message through loudspeakers in the vehicle or a visual alert on the dashboard 

adjust parameters in an automatic gearbox computer such that e.g. the gears are shifted at different engine speeds than before the adjustment and

The UE can connect to a node of the vehicle internal network via a USB Universal Serial Bus or a Firewire interface known in the art or wirelessly via e.g. Bluetooth or UPnP. Alternatively the UE may be an embedded telematics unit in the vehicle that always is connected to the vehicle internal network via e.g. CAN Controller Area Network bus and a FlexRay bus.

The third exemplary use case is a service which users can use to automatically report their current location to a system or other users when they are in certain predetermined areas. Such a service could for instance be used by a taxi company to keep track of when their taxis are getting close to a location e.g. an airport and will soon be free to pick up new passengers. The following use case could be part of such a service.

To sum up having described some embodiments of the invention several advantages of the invention or embodiments of the invention should be apparent such as 

To further sum up show flow diagrams for an embodiment within the scope of the first aspect and the second aspect respectively of the invention. The dashed arrows in these figures indicates optional steps as expressed in dependent claims to the respective independent claims of these aspects.

