---

title: Browser-plugin based method for advanced HTTPS data processing
abstract: The invention described here deals with implementing custom data processing of HTTPS based on a Browser-Plugin Method. Such custom data processing may include, but is not limited to, custom data compression, custom data encryption, data monitoring, data modification. There are two distinct methods to implement the Browser-Plugin Method for Advanced HTTPS Data Processing of the subject invention (BPAHDP). In both cases, BPAHDP provides the option of conducting custom data processing that co-exists with data compression, data encryption, or other types of data processing operations supported by the HTTP standard. Additionally, both BPAHDP methods ensure that the web-browser still implements and executes the underlying SSL/TLS channel setup and encryption operations. In both embodiments of BPAHDP, the most critical functionality is the ability to modify HTTP request/response headers and data sent over a TLS/SSL channel. In the regular HTTP case (HTTP over TCP) headers and data are sent as clear-text (i.e., as unencrypted data). Therefore, any HTTP proxy component can intercept and modify header/data as it choosesâ€”allowing custom data processing operations (including a custom compression operation) to be implemented. For HTTPS traffic, the data leaving a web-browser is encrypted. Therefore, a proxy cannot modify encrypted data, hence the novelty of the BPAHDP methodology. Both methods require specific implementation methods that are described. In particular, both embodiments of BPAHDP require specific techniques to facilitate the use of Microsoft Internet Explorer as a BPAHDP enabled web-browser. Microsoft COM (Component Object Model) interfaces and IE's Pluggable Protocol capabilities are utilized to meet all requirements of both BPAHDP embodiments.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09225803&OS=09225803&RS=09225803
owner: SLIPSTREAM DATA INC.
number: 09225803
owner_city: Waterloo
owner_country: CA
publication_date: 20091028
---
This application is a continuation of U.S. patent application Ser. No. 11 313 771 filed on Dec. 22 2005 which claims the benefit of U.S. Provisional Application No. 60 637 767 filed on Dec. 22 2004 the contents of application Ser. No. 11 313 771 and of Application No. 60 637 767 are hereby incorporated by reference.

The present invention relates to a novel method of utilizing a browser plugin that provides a technique for interception and further processing of data sent via the HTTPS protocol. The HTTPS protocol is defined as HTTP over a Secure Socket Layer SSL or HTTP over a Transport Layer Security TLS . See A. Freier P. Karlton and P. Kocher Internet Draft The SSL Protocol Version 3.0 November 1996 for a discussion of SSL and T. Dierks and C. Allen Request for Comments 2246 The TLS Protocol January 1999 for a discussion of TLS. A potential application of the subject method can be to apply proprietary data compression methods to reduce the volume of data communication of HTTPS payload data and also to possibly reduce the data transmission time. It should be noted that the option of applying proprietary data processing in this case is available in addition to standard built in HTTPS compression and encoding approaches such as Content Encoding methods gzip compress deflate described in section 3.5 of the article entitled Request for Comments 2616 Hypertext Transfer Protocol HTTP 1.1 June 1999 by R. Fielding J. Gettys J. Mogul H Frystyk L. Masinter P. Leach and T. Berners Lee.

Presently large volumes of data are delivered over the Internet by server computers to client computing devices such as desktop computers laptops and various handheld digital devices using a communication protocol called Hyper Text Transfer Protocol HTTP . The HTTP protocol strictly defines the interaction between a client device that sends requests for data and a server that supplies the data. A client after sending the request for data to the server waits for the server s response and then normally upon receipt of data delivers the data to the end user. In many cases the client is implemented by a software component called a web browser . The server is usually implemented by a software component called a web server .

Rapid expansion in Internet usage by businesses banking and direct consumer shopping led to the definition of a standard approach for sending encrypted HTTP data between HTTP clients and servers. This approach also known as HTTPS was first implemented by Netscape as HTTP over a Secure Socket Layer SSL TCP IP connection. The HTTPS protocol allowed end users and corporations to safely send credit card and other sensitive information over the internet. More specifically it prevents eavesdropping message forgery and tampering of HTTP data sent between client server applications. The first implementations of HTTPS utilized 40 bit encryption while the latest standard HTTP over TLS described in an article by E. Rescorla entitled Request for Comments 2818 HTTP over TLS May 2000 facilitates the use of powerful 128 bit encryption.

The underlying implementations of SSL and TLS are described in the article by A. Freier et al. and in the article by T. Dierks et al. respectively. Although the mechanisms are different both SSL and TLS essentially involve several common stages 

It is imperative for SSL and TLS functionality to be implemented by the web browser so that the SSL TLS channel is established directly from the web browser. This guarantees the encryption and security of all HTTP data originating from the web browser and received from the web server. Reference is made to which depicts the aforementioned scenario.

Now consider the compression of HTTPS data HTTP payload data sent over an SSL or TLS channel in order to reduce the volume of data transmission. Content encoding methods inherently present in the HTTP standard section 3.5 of the article by R. Fielding et al. can be used to reduce the volume of data sent in HTTPS transactions. These methods consist of a class of lossless compression algorithms such as gzip compress and deflate which can be supported within web browsers and web servers.

Unfortunately custom approaches e.g. proprietary data compression or any other proprietary or custom data processing cannot be supported by HTTPS. HTTPS does not provide for a standard interface or mechanism to facilitate custom data transformation. More specifically the encryption of HTTP data actually randomizes the original source HTTP data. In an information theoretic sense the entropy of the encrypted data is significantly higher than the original source data. Significant randomization of source data limits the effectiveness of data compression. The encrypted data also makes it difficult to do many other types of desirable data processing operations such as data recording data monitoring or data alteration. Since SSL and TLS are designed to prevent data tampering or man in the middle viewing retrieving the original source HTTP data is extremely difficult.

There are two distinct methods to implement the Browser Plugin Method for Advanced HTTPS Data Processing of the subject invention BPAHDP . In both cases BPAHDP provides the option of conducting custom data processing operations including data compression data encryption or other types of data processing operations supported by the HTTP standard. Additionally both BPAHDP methods ensure that the web browser still implements and executes the underlying SSL TLS channel setup and encryption operations. In both embodiments of BPAHDP the most critical functionality is the ability to modify HTTP request response headers and data sent over a TLS SSL channel. In the regular HTTP case HTTP over TCP headers and data are sent as clear text i.e. as unencrypted data . Therefore an HTTP proxy an intermediary software entity that fetches HTTP data on behalf of a group of HTTP clients component can intercept and modify header data as it chooses allowing custom data processing operations including a custom compression operation to be implemented. The subject of Performance Enhancing Proxies is discussed in a document Request for Comments 3135 Network Working Group June 2001 by J. Border M. Kojo J. Griner G. Montenegro and Z. Shelby entitled Performance Enhancing Proxies Intended to Mitigate Link Related Degradations . For HTTPS traffic the data leaving a web browser is encrypted. Therefore a proxy cannot modify encrypted data hence the novelty of the BPAHDP methodology. Both BPAHDP methods require specific implementation methods. In particular both embodiments of BPAHDP require specific techniques to facilitate the use of Microsoft Internet Explorer as a BPAHDP enabled web browser. Microsoft COM Component Object Model interfaces and IE s Pluggable Protocol capabilities are utilized to meet all requirements of both BPAHDP embodiments.

Define WSA as a BPAHDP enabled web server a web server that has implemented Advanced Processing or custom data processing of HTTP payload data that is able to accept HTTPS connections from standard web browsers. In addition define WBA as a web browser that has implemented the following functionality required by BPAHDP and is thus BPAHDP enabled 

1 The ability to add custom headers on all outgoing HTTP requests sent over an SSL TLS channel. For example 

2 The presence of the X BPAHDP header identifies WBA as being BPAHDP enabled. The control info field is utilized to identify the BPAHDP version identifying the supported data processing operations present in the web browser and any other relevant control information required during the custom data processing operation.

3 The ability to read and modify the HTTP response header returned by WSA over the TLS SSL channel. For example 

Since BPAHDP facilitates data transformation and filtering the modification of certain HTTP headers Content Type and Content Length may be required. Additionally certain response headers may need to be parsed and stored by the BPAHDP filtering method in the above example may be used during the decompression or some other data processing operation .

4 The ability to read and modify the HTTP payload data returned by WSA over an SSL TLS channel. For example 

5 The BPAHDP enabled web browser must be able to communicate with other non BPAHDP enabled web servers for both HTTP and HTTPS data.

This subsection describes the block level architecture and operational method for carrying out custom data processing on HTTPS data based on the capabilities described earlier in Method 1 . The terms WBA and WSA in this subsection have the same definition as given in Method 1 . In the method described in this subsection the HTTP based data exchange between WBA and WSA takes place over a SSL TLS channel. Block level architectural diagram depicting the operation is given in .

Define WSA as a BPAHDP enabled web server a web server that has implemented Advanced Data Processing or custom data processing of HTTP payload data and is able to accept HTTPS connections from standard web browsers. Also define CS as a standard HTTP HTTPS web server that provides the HTTP content to WSA.

In addition define WBA as a web browser that has implemented the following functionality required by BPAHDP 

1 The ability to add custom headers on all outgoing HTTP requests sent over an SSL TLS channel. For example 

2 The presence of the X BPAHDP header identifies WBA as being BPAHDP enabled. The field is utilized to identify the BPAHDP version identifying the supported custom data processing operations present in the web browser and any other relevant control information used during the data processing operations.

3 The ability to read and modify the HTTP response header returned by WSA over the TLS SSL channel. For example 

Since BPAHDP facilitates data transformation and filtering the modification of certain HTTP headers Content Type and Content Length may be required. Additionally certain response headers may need to be parsed and stored by the BPAHDP filtering method in the above example may be used during the decompression or filtering operation .

4 The ability to read and modify the HTTP payload data returned by WSA over an SSL TLS channel. For example 

5 The ability to modify the HTTP URL Uniform Resource Locator of objects originally destined for the CS. For example in order to route all HTTP requests to WSA 

6 The BPAHDP enabled web browser must be able to communicate with other non BPAHDP enabled web servers for both HTTP and HTTPS data.

In certain situations it may not be possible to enable the target content server CS with the custom data processing capability required for BPAHDP. In that case the HTTPS request originally intended for CS can be redirected to another server WSA that is enabled with custom data processing expected by a BPAHDP enabled web browser WBA . This subsection describes the system architecture and operational method for carrying out custom data processing on HTTPS data based on the capabilities described earlier in Method 2 . The terms CS WBA and WSA in this subsection have the same definition as given in Method 2 . In the method described in this subsection the HTTP based data exchange between WBA and WSA takes place over a SSL TLS channel. The use of SSL TLS channel for the HTTP based data exchange between WSA and CS is optional. System architecture depicting the operation of the method is given in .

Implementation of BPAHDP capabilities on the server side to realize a WSA required for Method 1 or Method 2 can be done in two ways 1 Implementation of a custom web server that implements the specified capabilities 2 Via implementation of server side plug in supported by several web servers.

On the client side the exact strategy used for implementing Method 1 and Method 2 is dependent on the Application Programmers Interface API of the web browser product that is used for implementation. There are two distinct strategies for the implementation depending on the situation 

Define COM as Microsoft Component Object Model Microsoft s implementation of interconnecting software objects via Remote Procedure Calls RPC function parameter marshalling and automation. Define IE as Microsoft Internet Explorer versions 4.0 and above. Define a Pluggable Protocol as a COM object that can override IE s handling of specific web schema. For example an http Pluggable Protocol can override a complete http transaction that is normally carried out by IE.

The aforementioned requirements of BPAHDP can be met in IE by novel use of the COM interfaces exposed by Internet Explorer IE . Use of these interfaces facilitate the modification of HTTP request headers modification of HTTP response headers modification of HTTP response data as well as URL link translation. Define the BPAHDP PP as a COM object contained in a dynamic linked library DLL . The BPAHDP PP is registered as an https Pluggable Protocol and implements all of core BPAHDP functionality header modification data processing URL translation .

The following steps are followed to implement BPAHDP functionality in Microsoft Internet Explorer IE 

It should be recognized that the embodiments described herein and shown in the drawing figures are meant to be illustrative only and should not be taken as limiting the scope of invention. Those skilled in the art will recognize that the elements of the illustrated embodiments can be modified in arrangement and detail without departing from the spirit of the invention. Therefore the invention as described herein contemplates all such embodiments and modified embodiments as may come within the scope of the following claims or equivalents thereof.

