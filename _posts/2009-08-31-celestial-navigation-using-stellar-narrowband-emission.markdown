---

title: Celestial navigation using stellar narrow-band emission
abstract: A method is provided for characterizing luminous celestial objects (e.g., stars) in celestial navigation of a missile system. The method includes segmenting, assigning, measuring, computing, ratioing, producing, scaling, and determining operations. Segmenting includes subdividing wavelength range into discrete contiguous bins. Assigning arranges each bin into a plurality of color bands. Establishing sets a transmissivity to each bin of each color band. Computing calculates broad-based fluxes for a reference value as a reference flux. Ratioing computes a ratio between the target flux to the library flux as a color scale for each band. Squaring determines the library flux for each band as a library flux squared. Producing sums a spectral scale over the color bands, a second multiplication of the color scale and the library flux squared as a first sum product, and sums over all the bands the library flux squared as a second sum product and dividing the sum products. Scaling factors each measured intensity of the measured intensities as a scaled intensity by multiplying each target intensity by the spectral scale for each bin. Determining sums a scaled broad-band flux for each band over the bins, a third multiplication of the transmissivity and the scaled intensity.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08222582&OS=08222582&RS=08222582
owner: 
number: 08222582
owner_city: 
owner_country: 
publication_date: 20090831
---
Pursuant to 35 U.S.C. 119 the benefit of priority from provisional application 61 195 385 with a filing date of Sep. 30 2008 is claimed for this non provisional application.

The invention described was made in the performance of official duties by one or more employees of the Department of the Navy and thus the invention herein may be manufactured used or licensed by or for the Government of the United States of America for governmental purposes without the payment of any royalties thereon or therefor.

The invention relates generally to celestial navigation for missile systems. In particular the invention relates to characterizing celestial spectral information in conjunction with stellar catalogs and appropriate adjustments based on narrow band spectral emission NBSE .

Weapon systems that navigate by the stars are designed to view and examine stars that are suitable to the system s charge coupled device CCD capabilities. The manufacturer s design defines the CCD s response to light which can be expressed as a function of wavelength. The CCD response is integrated with each particular star s photometric spectrum. This integrated flux can be used to determine whether or not the star is useable for navigation by the weapon system. The main source for narrow band photometry spectra is the Mitchell Johnson MJ star catalog.

Conventional stellar identification and characterization methods for celestial navigation yield disadvantages addressed by various exemplary embodiments of the present invention. In particular such limitations cause severe inconvenience in characterizing all but a handful of bright stars.

Various exemplary embodiments provide a method for characterizing luminous celestial objects e.g. stars in celestial navigation of a missile system. The method includes segmenting assigning measuring computing ratioing producing scaling and determining operations. Segmenting operation includes subdividing wavelength range into a plurality of discrete contiguous bins. Assigning operation arranges each bin of the plurality of bins into a plurality of color bands. Establishing operation sets a transmissivity to each bin of each color band measuring luminous intensity from a target object for each bin as a plurality of measured intensities. Computing operation calculates broad based fluxes for a reference value as a reference flux the target object as a target flux estimate for each band and a narrow band library as a library flux.

In various exemplary embodiments the reference and library fluxes include summing a first multiplication of the transmissivity for each bin and a reference luminous intensity for each bin over the plurality of bins. Ratioing operation computes a ratio between the target flux to the library flux as a color scale for each band. Squaring operation determines the library flux for each band as a library flux squared. Producing operation sums a spectral scale over the color bands a second multiplication of the color scale and the library flux squared as a first sum product and sums over all the bands the library flux squared as a second sum product and dividing first sum product by the second sum product. Scaling operation factors each measured intensity of the plurality of measured intensities as a scaled intensity by multiplying each target intensity by the spectral scale for each bin. Determining operation sums a scaled broad band flux for each band over the plurality of bins as a third multiplication of the transmissivity and the scaled intensity.

Various exemplary embodiments further include estimating an error for the band the target flux estimate from the scaled broad band flux as a plurality of flux differences and includes summing subtracting computing and determining operations. Summing operation adds a sum square flux difference for each band from a square of each flux difference of the plurality of flux differences. Computing operation determines a root sum square flux difference for each band a square root of the sum square flux difference. Determining operation sums an intensity error estimate over all the color bands each root sum square flux difference as an intensity error estimate.

In the following detailed description of exemplary embodiments of the invention reference is made to the accompanying drawings that form a part hereof and in which is shown by way of illustration specific exemplary embodiments in which the invention may be practiced. These embodiments are described in sufficient detail to enable those skilled in the art to practice the invention. Other embodiments may be utilized and logical mechanical and other changes may be made without departing from the spirit or scope of the present invention. The following detailed description is therefore not to be taken in a limiting sense and the scope of the present invention is defined only by the appended claims.

Stellar navigation for missile systems employs orientation based on specific luminous celestial objects e.g. stars based on select electromagnetic emission characteristics for identification. Although the Mitchell Johnson MJ catalog contains many bright stars estimates of other stars narrow band photometry can provide information to guide the system more accurately.

This disclosure describes a method that uses broad band photometry and spectral types to estimate the narrow band spectra of non MJ stars. The analysis incorporates narrow band spectral emission NBSE characterization. The broad band information is provided by the Hipparcos HIP star catalog. The broad band photometry for a non MJ star can be used to scale similar spectra from the MJ catalog.

The method also estimates errors of the scaled spectra. Analogous to Kalman filtering these errors can be used as weights to combine the estimates of all similarly scaled spectra to calculate the Kalman estimated spectrum. The method can be easily automated so that thousands of spectra can be estimated in minutes. This disclosure describes that method as well as aspects of its validation.

A weapon system s CCD sensitivity tunes to particular frequency bands and intensity of stellar light. Different stars have different frequency spectra some stars are usable by the weapons system and others are not. In order to measure the CCD s sensitivity preferably employs narrow band frequency estimates of the stars spectra. Upon fielding of a CCD in a weapon system operation includes construction of an initial star catalogue tuned to the performance of that device. Over time whether due to system hardware upgrades or staleness of the original star catalog parameters the weapon system s catalog of stars undergoes re evaluation. Stars not usable before may subsequently be deemed beneficial due to the upgrade or catalog changes.

The various star catalogs offer much photometric information. Nonetheless conventional techniques lack a process to rapidly filter all of this information so that limited resources can be focused on the most likely stars appropriate to the specific characteristics of the CCD. By applying the techniques described in this disclosure hundreds of thousands of possibilities can quickly be screened to extract the critical few additions from the non MJ star data. To accomplish this objective manually would constitute a lifetime effort. Once identified the astronomers can apply more sophisticated techniques to improve on the 95 accurate spectra available from this filter approach.

The MJ catalog identified as Thirteen color Photometry of 1380 Bright Stars by H. L. Johnson and R. I. Mitchell . vol. 1 pp. 299 324 has 1380 bright stars. Most of the catalog stars have thirteen narrow bands of color flux. The Hipparcos HIP catalog from European Space Agency 1997 ESA SP 1200 provides three broad band color magnitudes for more than 100 000 stars. Only a fraction of HIP stars have corresponding MJ narrow band spectra.

Traditionally a non MJ star s narrow band photometry was manually estimated for a few select bright stars. This process takes a knowledgeable person a considerable period but the disclosed methodology can be computationally automated and can quickly estimate narrow band spectra for HIP stars. In addition neighboring stars around any catalog star whether MJ or non MJ can affect the CCD performance. The fainter neighboring stars are rarely included in the MJ catalog so their narrow band spectra are also estimated. This paper describes and validates a methodology that Naval Surface Warfare Center Dahlgren Division NSWCDD uses to estimate non MJ narrow band spectra.

The methodology relies on using the MJ spectra as a library of narrow band information. This library of information is cataloged by each star s Harvard Revised Identification Number HR and characterized by its spectral type. A target star is chosen from the HIP catalog along with its spectral type and broad band photometry.

All the MJ narrow band spectra similar to the target star s spectral type are coarse grained and scaled to match the HIP broad band photometry. These scaled MJ narrow band spectra provide a number of estimates of the target star s narrow band spectrum. Each scaled estimate is associated with an expected error that indicates how close the estimated spectrum matches the broad band information provided by HIP. These weights provide a single Kalman type estimate of the target star s spectrum.

Narrow Band Photometry The 13 colored flux data from the MJ catalog are interpolated in wavelength every 10 nm from 350 nm to 1100 nm. The MJ spectrum is denoted as h where the subscript index mj represents the HR . Every MJ spectrum is associated with a spectral type. illustrates a graph of MJ Spectra for B6 Spectral Type Stars. A legend identifies the stars within the MJ catalog. The abscissa denotes wavelength in nano meters nm of the light received and the ordinate denotes the spectral irradiance in fW cm m femto watts per square centimeter per micron .

All ten B6 type spectra reveal similarity in shape. The legend identifies the corresponding HR of each star. Stars with the same spectral type share similar spectra. For example the top curve the graph traces the MJ spectral irradiance for HR 6396. The star HR 6396 belongs to the spectra type B6. The ten other B6 stars spectra from MJ are also plotted. In this example HR 6396 has greater spectral power than the other ten stars.

Broad band Flux Estimates illustrates a graph showing transmission of select electromagnetic energy bands as a function of wavelength . A legend identifies blue visual and infrared curves with the abscissa denoting wavelength and the ordinate denoting normalized transmissivity. The corresponding peaks of the blue b visual v and infrared i transmission curves respectively correspond to 410 nm 530 nm and 820 nm.

For demonstration purposes estimates are provided for a target star included in both MJ and HIP. The stars MJ spectra represent a collected set in which all have the same designated spectral type as the HIP star. In practice this method would be most practical for non MJ stars. However for demonstration purposes this method presented for both to describe the methodology. Subsequently two additional examples of non MJ stars are demonstrated.

The MJ spectra in the collected set are coarse grained in order that MJ data can be compared with HIP provided broad band photometry. One of the transmission curves shown in the graph is multiplied with a star s spectrum at each applicable wavelength bin. This function product represents a function of wavelength integrated to yield the broad band flux for that respective color. The subscript index mj refers to the star s Harvard Revised Identification Number.

The series of relations in eqn 1 shows the color MJ broad band fluxes Ifor blue visual and infrared respectively 

Broad band Hipparcos Photometry Typically irradiance fluxes are referenced to Alpha Lyrae Lyrae HR 7001 . The spectrum for Alpha Lyrae h can be constructed from the 13 color MJ flux. From eqn 1 the associated blue visual and infrared reference fluxes are calculated in eqn 2 

The three color magnitudes B blue V visual and I infrared can be determined from interpolation of broad band color information B V V and V I provided from the HIP catalog for the target star. The reference color magnitudes for Alpha Lyrae are set as b v i 0.03. The difference between the reference magnitudes and the HIP color magnitudes can be used to estimate the broad band fluxes. The color magnitudes are defined such that a difference of five apparent magnitudes translates to the lower magnitude star being one hundred times brighter than the higher magnitude from B. W. Caroll and D. A. Ostlie Addison Wesley Publishing Co. Reading Mass. 1996 ch. 3. The broad band color fluxes respectively blue visual and infrared for a particular HIP star are related to the magnitudes 

Scaling The graph in suggests that a star s spectrum can be scaled to match the spectrum of the target star. The three HIP broadband fluxes can be used with the three MJ fluxes to give three different estimates of this scale. For a given MJ spectrum h and the three HIP color magnitudes a scale can be calculated for each of the three colors as provided in eqns 4 5 and 6 . The scales for the colors correspond to for blue for visual and for infrared. Each scale constitutes a simple ratio of the HIP flux over the MJ flux 

Scale Estimation of the Narrow Band Spectrum Spectra from similar spectral types seem to be approximately offset by a common scale. A least squares approach can be used to calculate this common scale S which is selected to minimize the error in flux for each color region. The errors by color region are shown in the set of eqn 7 

The difference between the scaled broad band fluxes provided in eqn 11 and the HIP fluxes in eqn 3 represents a quality measure of the scaling. Although there exists some wavelength overlap between the blue and visual fluxes their differences are treated as independent. Thus the root sum square of these differences can be treated as an error in the scaled spectrum 

One way to provide a single estimate of the spectrum for the target star is to choose the scaled estimate with the least scaling error. In Table 2 HR 8762 corresponds to the scaled spectrum with the least flux error. This best scaled estimate is denoted as and its error as . Error units are in scaled in fW cm m. The total integrated power of the spectrum of HR 6396 is 107 fW cm m. The error in the best scaled estimate is about 12 of the total integrated power.

Weighting Algorithm of the Narrow Band Spectrum A Kalman type estimate for the spectrum can be constructed from the multiple scaled estimates with associated errors. Information from all of the scaled spectra can provide an estimate that typically has less flux error than the best scaled estimate. The wavelength range can be divided into seventy six wavelength bins of width 10 nm each. The bins range extends from 350 nm to 1100 nm. Each wavelength bin is denoted by . For this example wavelengths bins are denoted as 350 nm 360 nm . . . 1100 nm and the value N 76 is used as the maximum wavelength bin.

For a particular wavelength bin let Xtake the value of the previous estimate of the spectrum with a flux error of V. The first previous estimate is obtained from the first scaled spectrum. The current scaled spectrum Z has a flux error of R. The Kalman weight K weighs the previous and current spectrum to construct the new estimate Xwith error V. The new state replaces the previous. This process is repeated until the last scaled spectra are incorporated into the final weighted spectrum with error . The estimation is performed for all wavelength bins.

In this procedure values are evaluated across each of the wavelength bins stepping incrementally. For n 1 2 . . . N the process increments by one wavelength bin at the end of each process 

The scaled spectrum is denoted as . For the target star HR 6396 example the index mj includes the star HR 1142 as the first star HR 1145 as the second and so on until the tenth star HR 8762 . The scaled error is represented as . In the procedure the error can be generalized to be a function of wavelength. Although these error terms are set in eqns 18 and 19 as a constant for all wavelength bins in each MJ spectrum this does not apply to filling in i.e. extrapolating missing MJ narrow band data.

When the error term is set to unity for all wavelength bins the average of the spectra can be established as the estimate 

The differences between these scaled broad band fluxes given in eqns 20 and 21 with the HIP fluxes given in eqn 3 are treated as the error in the respective estimates for average and Kalman errors 

Method Validation In the above example HR 6396 has been selected as the target star. The MJ data collected included a set of spectra that did not include the target star. The estimates were established based on scaling the MJ set using HIP color data.

Graph in shows all three spectrum estimates to be slightly offset near the maximum value. This is largely due to the MJ estimates of the B6 magnitudes not being consistent with Hipparcos for the star HR 7936. Coarse graining the narrow band MJ by eqn 1 yields broad band fluxes I Iand I. Then inverting eqn 3 to calculate the magnitude estimates yields adjusted transmissivity values 

The Hipparcos magnitudes are B 4.56 V 4.13 and I 3.64. Although B is a bit dimmer than b the difference is sufficient to cause the algorithm to estimate the spectrum with lower power. This observation holds especially valid in the blue region. Identifying which catalog is more correct requires further investigation but this can be neglected in demonstrating the validity of the method.

One manner of measuring the process error involves supplying the MJ derived magnitudes for the target star and not the HIP color magnitudes into the methodology described previously explained. Because MJ and HIP occasionally differ on spectral type the MJ designation is preferentially employed for this purpose. This control enables separation of the algorithm error from the two catalogs broad band differences.

The percent flux differences can be calculated for each of the 1217 MJ stars that contain red data. The MJ catalog lacks red data for 163 stars. provides a tabular list as Table 3 showing the square root of the sum of the mean squared and variance for the 1217 percent differences. The algorithm error uses MJ derived color magnitudes. For a target star having a unique spectral type within MJ that star is excluded in the sample. The tabular list compares the algorithm error with the expected errors calculated by eqns 12 22 and 23 . The algorithm error is much bigger than the expected error. However by omitting a handful of very red problem stars from the sample the process error statistics nearly match the expected error for 1212 stars. Table 3 in shows that the statistics for the average spectrum estimates perform worse than Kalman or best scaled. The best scaled estimates match the Kalman estimate. Initially this may suggest that Kalman estimate does not improve the estimate.

The process can break down under conditions in which the star s spectrum mainly lies outside the bands covered by the broad band magnitudes. illustrate graphs of spectrum estimates for several stars in the catalogs with problematical characteristics 

Composite Estimation of two non MJ stars One advantageous feature of the best scaled estimate is employability of the entire MJ catalog as the collected set. The catalog best scaled estimate has an associated spectral type designated by MJ. For a HIP spectral type not yielding good results i.e. an expected error exceeding 3 then a new set of MJ spectra can be collected with this MJ catalog best scaled spectral type. The method described above can then be performed again. The spectrum from the two suites of estimations that have the least expected error based on differencing with HIP broad band color data can be selected. For example for the star HIP 42913 the MJ catalog best scaled spectral type and HIP catalogs agree. In this example the two suites of estimates are identical.

In the two examples shown in the luminosity specification and the spectral class of K5 Ib are included. If MJ has spectral types and luminosity that match the HIP designation exactly as shown in graph then better Kalman estimates can often be established with this set over the larger set of spectra that matches only on spectral type. On the other hand sometimes the MJ catalog does not have a star that matches the two letter HIP spectral designation exactly. In these cases estimates based on matching only the first letter of the spectral type are made. The overall strategy includes automating the algorithm to provide a composite of estimates and then selecting the value with the lowest expected error as the composite estimate.

MJ and HIP Spectral Comparisons The composite method can be performed on the set of HIP stars also contained in the MJ catalog. The difference between spectra that have been estimated with HIP broad band photometry and their MJ reference counterparts should be no greater than the algorithm error. Table 3 in shows that the algorithm error is expected to be about 3 without the problematic stars.

Stars that have percent flux differences calculated by eqn 25 greater than 3 are expected to be due to broad band differences between MJ and HIP as shown in . For a sample of 1205 stars the average root mean square RMS difference defined by eqn 25 between the using the composite estimates using HIP broad band photometry and the MJ spectra is 9 . Again most of the difference lies not with the method but with the fact that the two catalogs differ in their broad band colors. If seven suspect MJ stars were removed from the sample the remaining 1205 stars would give average RMS differences of 4 .

Validation effort these seven suspect MJ stars included consultation with Dr. Benjamin Lane of Charles Stark Draper Laboratory Cambridge Mass. provided. These MJ spectra also did not correlate especially well to other more sophisticated estimation techniques. In particular this method of spectrum estimation was applied to star HR 5288. Further estimates agreed with Dr. Lane s observation that the MJ spectrum appears suspect as shown in the graph of . The MJ spectrum indicates only about half the power as the other estimates. The HIP provided color magnitudes are B 3.071 V 2.06 and I 1.05. The MJ broad band counter parts were calculated to be somewhat dimmer with magnitudes B 3.588 V 2.58 and I 1.55. For this star estimates were applied for the spectrum but not MJ for CCD sensitivity analysis.

The star HR 2735 provides another example revealing a signifycant difference between MJ spectrum and the method s estimate. For this star Dr. Lane concluded that the MJ catalog probably is mislabeled and the MJ spectrum really belongs to star HR 2736. Thus when two catalogs are available the disclosed method can also quickly illuminate photometric inconsistencies. These inconsistencies can be investigated off line and the spectrum that remains valid under scrutiny can be used for missile navigation.

Filling in Missing Spectra Of the 1380 bright stars in MJ 163 of them lack red data. By adding the partial spectrum to the set and assigning error as a function of wavelength the Weighing Algorithm can fill in the missing data. For example shows a graph for the Spectrum for HR 125. A legend identifies a bold dash line that denotes MJ catalog data and a thin solid line to indicate the completed spectrum from weighting application. A bracket marks the wavelengths above 650 nm beyond which the MJ data are missing and can be compensated for by the process.

For the wavelength bins 670 1100 nm in the HR 125 example the spectrum h 670 nm is zero. In this red region the input spectrum s error can be defined as an arbitrarily very large number when compared to typical flux errors 670 nm 10. 26 

This filling in option may involve supplying the partial MJ spectrum as well as the associated error. For this example the broad band flux error can be supplied by the operator as zero for wavelength bins below or at 670 nm. This method enables these 163 MJ partial spectra to be reclaimed by operating on filled in data consistent with their spectral class. Thus the 163 red less MJ stars need not be treated as purely non MJ stars.

The methodology described herein estimates the narrow band spectra of stars not contained in the MJ catalog. For each estimated spectrum an expected broad band flux error is calculated. The flux errors are used to select the best scaled estimate and are used as weights in a Kalman type estimate. Ultimately a composite estimate is automatically produced when the HIP spectral type designation is suspect.

The method has been validated by treating MJ stars as targets of estimation and then comparing them to the MJ reference spectra counterparts. This method has been shown to detect and highlight photometric differences between the MJ and HIP catalogs as well as fill in missing red data for 163 spectra in the MJ catalog. The process has been implemented as an automated set of instructions and within minutes has evaluated more over a hundred thousand HIP stars for possible inclusion in the weapon system s star catalog for navigation. Furthermore the method quickly detects photometric violations that neighboring HIP stars may impose on a star for consideration in the weapon system s catalog.

Spectral Estimation The procedures for the automation process can be described in the following portion associated with appropriate flowcharts. For an operator having only broad band information or at best parts of a narrow band spectrum a set of priori estimates that characterizes the photometry of a target star NBSE is used to estimate the narrow band spectrum of that star.

The NBSE algorithm uses broad band photometry for the target star and manipulates the information provided in a user supplied library of narrow band spectra. The product of these manipulations is an estimate of the narrow band spectrum for comparison with the received CCD measurements. The process can function as a subroutine in a computer program so that the operator can execute with the necessary inputs and outputs communicated by data arrays. The following high level description of NBSE does not employ arrays but rather serves as an introduction to the information flow of the algorithm. A detailed procedural description follows.

NBSE Detailed Description This detailed description includes arrays and computations and is done in two parts. Part A describes how data arrays are organized in the algorithmic procedure. Some of these arrays serve as the mechanism of input and output to and from the procedure. Other data arrays describe the algorithm communication of information from one step of the algorithm to another. Part A is somewhat involved so some simple examples are provided. The benefit in separating the array description from the method is that the former can be succinctly given. Part B describes the algorithm in a manner that can be easily transcribed into a computer program subroutine.

Part A Array Definitions This section describes the arrays used by NSBE. A simple example is given that traces the flow of the algorithm s methods given in Part B.

Section A 0 Array Indices The algorithm uses many arrays of data. One dimensional arrays are indexed by one variable. Two dimensional arrays are indexed by two variables. These variables include color k wavelength bin and spectrum identification mj.

The operator provides the maximum value for these three array indices k and mj. The operator also supplies mjwhose value is the number of priori estimates that the operator includes in the library set of spectra. These priori estimates are included in the set after the regular spectra.

Section A 1 Color Magnitudes The target star s and reference star s broad band color magnitudes are supplied by the user and each can be represented by a one dimensional array colormag k and color0 k respectively. For example let the Harvard Revised numbered star HR 1142 be the target star. For this star the Hipparcos Star Catalog estimates the blue visual and infrared magnitudes as 3.62 3.72 and 3.81 respectively. Furthermore Alpha Lyrae can be used as the reference star and its blue visual and infrared magnitudes are all the same value 0.03. The operator supplies the NBSE the color array s as 

Section A 2 Transmission Curves The user of the algorithm must supply the transmission color curves associated with the supplied color magnitudes. The transmission curves are represented by the two dimensional array color that has the wave bin number as the first index and the color k as the second index. shows the plot as an example of the blue b visual v and infrared i transmission that the operator may employ.

In this example the operator inputs a wavelength bin size of 10 nm to the algorithm. The operator can extrapolate or fill in the color array such that for 1 associates with transmission values denoted by 350 nm 2 with 360 nm . . . 76 with 1100 nm. In this example 76 and kis three. For the example given in section A 1 the operator could populate the array as 

Section A 3 Library of Narrow band Spectra The operator supplies the algorithm a set of narrow band spectra by means of a two dimensional array h has wave bin number as the first index and spectrum number mj as the second index. shows a plot an example of spectra for a library of six stars identified in a legend . The abscissa corresponds to wave bin number and the ordinate represents spectral irradiance.

These six stars are identified in the legend with Harvard Revised Numbers. Of these HR 1350 HR 6396 HR 7358 HR 7613 and HR 7358 which are similar and are designated as spectral type B6 III. The odd spectrum in the set is HR 5226 the second with thin dash line which has an M3 spectral type. This simple example lacks priori spectra estimates of the target star HR 1142.

For this example is seventy six and the wavelength bin corresponds to the wavelength bins associated with the color array defined in section A 1. In this example mjis six. The reference spectrum is a single dimensional array denoted as h . The reference spectrum is usually Apha Lyrae HR 7001. The spectral type associated with each spectrum h is stored in the one dimensional array spectral type. In example shown above spectral typeis B6 III where mj 1 3 6. For the second spectrum mj 2 spectral typeis M3 .

Section A 4 Broad Band Flux Estimations The algorithm produces broad band flux estimates for the reference target and the entire library of user supplied spectra. The reference and target broad band flux are separated into color regions and are represented as single dimensioned arrays I k and I k respectively. The broad band flux associated with the library of input narrow band spectra is represented as a two dimensional array I k where mj is the spectrum index.

Section A 5 Scales and Scaled Narrow Band Spectra The algorithm produces a scale for each color region k for each spectrum in the library set for mj 1 mj absent any scaling of priori estimates . These color scales are represented by a two dimensional array k . The k color scales are used to produce a single least squares scale denoted by the one dimensional scale array S. The algorithm uses this single scale array Sto scale the library of spectra h to produce a family of estimates for the target star s narrow band spectrum .

A least squares approach is used to calculate this scale array S. The scale Sis chosen to minimize the error in flux k for each color region such that 28 where I k is the broad band flux. The region errors are independent such that the total square of the flux error over the sum of all k can be expressed as 

The library set of spectra in the library set can be scaled to provide estimates for the target star s spectrum. shows a plot for an example of scaled spectra associated with the six star library set shown in the graph of for Scaled Spectrum Estimates for HR 1142. All the B6 III stars line up almost congruently where as the M3 spectrum from HR 5226 deviates greatly from the others.

Section A 6 Scaled Spectra Error Estimates The algorithm calculates a broad band color flux error k associated with the scaled spectra . The flux error is computed for mj 1 mj. The priori spectra estimates are not scaled and already have errors provided via operator input. Based on this flux error the algorithm also computes a wavelength independent error for each spectrum stored in the single dimensional array .

In the example shown in the graph of the broad band flux errors are summarized in as a tabular listing of Table 4 for Scaled Spectral Flux Error. These errors indicate that the M3 star scaled spectrum has an estimated error much greater than the other B6 III scaled spectra. The algorithm selects the HR 6396 scaled spectrum as that with least flux error. The algorithm also indicates that B6 III represents the spectral class that best fits the target star s color magnitudes of all the spectra given in the user s library set.

Section A 7 Computing the Weights for the Weight Estimation The two dimensional error array can provide weights to combine the family of scaled spectra into a single spectrum estimate . The operator can choose one of three methods to create these weights. The first method A 7.1 merely averages all the scaled spectra. In this example represents a simplified set to the value of unity for all scaled spectra in the set for all wavelengths. The second method A 7.2 weighs each scaled spectrum with its associated computed flux error . The third method A 7.3 linearly combines the color flux error k as weighted by the user provided color weight cw k . The third method computes weights as a function of wavelength.

For illustrative purposes the algorithm calculates the broad band flux errors according to the color curves given in the example of Section A 2. Furthermore the scaled spectra can be set as and respectively to have blue visual and infrared broad brand flux errors as 

An exemplary operator input to the algorithm is weight option. For weight option being set to one then sets to 1 for all spectra mj and wavelength bins . This option merely averages the spectra in each wavelength bin. For weight option being set to two then is which represents the flux error for all wavelength bins in the scaled spectrum. For weight option being set to three then is defined per wavelength bin.

This third option uses cw k to define how to weigh the broad band error k for each color. This feature can be especially useful for spectral regions where wavelength bins are associated with more then one color as observed from the overlap of the curves for blue and visual spectra in the plot of . provides a tabular list in Table 5 showing an example for the construction of given that weight option 3 and that the broad band flux error I k is defined by method A 7.1. The wavelength bins follow the example provided in Section A 2.

The tabular listing in Table 4 shows that the infrared region 37 76 with the two flux errors being equally weighted I 3 and I 3 to define the error weights in the infrared region for both and . By contrast in the mixed region of 14 22 the blue and visual errors overlap and thus they are equally weighted. Because 1 0.0 then half as much error is given to than .

Section A 8 Weighted Spectrum Estimation Upon completion of the calculation the algorithm computes a single or weighted estimate of the target s spectrum . The algorithm also calculates a weighted error in this estimate . Both and are one dimensional arrays indexed by the wavelength bin .

A broad band flux estimate of the weighted spectrum can be used to also calculate a broad band flux error k that represents a one dimensional array indexed by color k. This broad band flux error can be employed to create a scalar estimate of the total spectrum error .

As described earlier the operator can supply priori estimates of the target stars spectra. These priori estimates are accompanied by an error estimate per wavelength bin to be included in the set after the regular spectra as described in A 0 iii so that the algorithm assigns the associated operator supplied errors correctly. This feature of the algorithm enables filling in missing data in a spectrum.

By adding the partial spectrum to the library set and assigning error as a function of wavelength NBSE can supplement the missing data thereby enabling a greater number of stars to be made available for navigation. For example shows plot of HR 125 without red data in the catalog yet the weighted or Kalman estimate from NBSE shows the spectrum filled in for complete extrapolation. In this example the broad band flux error is set to zero for wavelength bins between 670 nm and 1100 nm the corresponding spectrum is also defined as zero by h h 670 nm 0 and the corresponding error 670 nm 10from eqn 26 .

The operator inserts partial spectra into the algorithm by merely adding it to the library of user supplied spectra h . The algorithm prompts the operator to input a variable mjand mj add. In the spectra array h the indices mj 1 to mjrefers to narrow band spectra not associated with the target star. The indices mj mjto mj add refers to the priori spectra of the target star. The associated priori flux error is supplied by the user by means of the two dimensional array add err .

Part B. Narrow Band Spectra Estimation Method The following method for NBSE relies on using a library set of pre defined narrow band spectra. Spectra from the library are characterized by a spectral type. The operator constructs a library of narrow band spectra that usually may but need not be consistent with the target star s spectral type. The algorithm coarse grains the spectra in this library and then scales them to match the target star s broad band photometry.

These scaled narrow band spectra provide a number of estimates of the target star s narrow band spectrum. The scaled spectrum that has the least flux error is identified along with its associated spectral type. Each scaled estimate is associated with an expected error. The algorithm uses these scaled spectra and errors and any priori estimates to calculate a single Kalman type or weighted estimate of the target star s spectrum. Based on the array descriptions given in the Part A the method for estimating narrow band spectra is described below.

Section B 0 NSBE Input Output lists the parameters of user input to be supplied by the operator as well as of output. User definitions and options are presented in a first block to identify parameters such as number of spectra wavelength bin width and weight options. Arrays of photometry data are presented in a second block to identify color magnitude and library information. Algorithm output is presented in a third block to identify scaled estimates and errors.

Section B 1 Compute the reference and target star s broad band flux identifies a first do loop for setting the broad band flux arrays Iand Ifor each color k. These arrays correspond to eqns 2 and 3 in discretized form expressed as eqns 32 and 33 

Section B 2 Compute the scaled narrow band estimates and flux errors for the target star illustrates a second do loop that nests additional steps for mj from unity to mjto perform several further operations. These include 

Section B 3 Identify the scaled spectrum that has the least broad band flux error The spectral type of the target star under observation can be compared to the catalog and identified. illustrates a series of operations . These include setting a default spectral type followed by a do loop that nests additional steps for mj from two to mjto compare the current minimum error to that of alternate spectral types.

Section B 4 Determine the Error Weights to be used in the Weighing Equation illustrates a series of operations with nested do loops as described in Section A 7. Color error can set all the scaled spectra as 1 for the first selection. Each scaled spectrum can be weighted with its associated computed flux error for the second selection. The weights can be computed as a function of wavelength as a root mean square product of color flux error k weighted by the user provided color weight cw k .

Section B 5 Weighting Estimation illustrates a series of operations with concatenated do loops as described for iterative update operations. These include 

Section B 6 Error in Weighted Estimate illustrates a series of color do loop to determine weighted flux and associated error in eqns 41 and 42 

While certain features of the embodiments of the invention have been illustrated as described herein many modifications substitutions changes and equivalents will now occur to those skilled in the art. It is therefore to be understood that the appended claims are intended to cover all such modifications and changes as fall within the true spirit of the embodiments.

